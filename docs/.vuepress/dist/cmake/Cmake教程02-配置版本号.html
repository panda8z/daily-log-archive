<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>（1）系列教程介绍 | Panda8z`Blog</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="Panda8z developer engineer designer">
    <link rel="preload" href="/assets/css/0.styles.d1974566.css" as="style"><link rel="preload" href="/assets/js/app.65df3687.js" as="script"><link rel="preload" href="/assets/js/2.4014e5fb.js" as="script"><link rel="preload" href="/assets/js/9.205b9973.js" as="script"><link rel="prefetch" href="/assets/js/10.ef1fe66a.js"><link rel="prefetch" href="/assets/js/11.70e684ab.js"><link rel="prefetch" href="/assets/js/12.236fe0fe.js"><link rel="prefetch" href="/assets/js/13.bb84747e.js"><link rel="prefetch" href="/assets/js/14.cf0485b7.js"><link rel="prefetch" href="/assets/js/15.dc011595.js"><link rel="prefetch" href="/assets/js/16.043cd073.js"><link rel="prefetch" href="/assets/js/17.16279a29.js"><link rel="prefetch" href="/assets/js/18.d9303b40.js"><link rel="prefetch" href="/assets/js/19.c8de6494.js"><link rel="prefetch" href="/assets/js/20.b9094388.js"><link rel="prefetch" href="/assets/js/21.4cae9a48.js"><link rel="prefetch" href="/assets/js/3.f9625483.js"><link rel="prefetch" href="/assets/js/4.7e8a4869.js"><link rel="prefetch" href="/assets/js/5.87c78865.js"><link rel="prefetch" href="/assets/js/6.b8361db5.js"><link rel="prefetch" href="/assets/js/7.80b067b4.js"><link rel="prefetch" href="/assets/js/8.a8439088.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d1974566.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://golang.google.cn/lib/godoc/images/go-logo-blue.svg" alt="Panda8z`Blog" class="logo"> <span class="site-name can-hide">Panda8z`Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Kinds" class="dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rust/" class="nav-link">
  Rust
</a></li><li class="dropdown-item"><!----> <a href="/cmake/" class="nav-link router-link-active">
  CMake
</a></li><li class="dropdown-item"><!----> <a href="/技术面试/" class="nav-link">
  技术面试
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Kinds" class="dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rust/" class="nav-link">
  Rust
</a></li><li class="dropdown-item"><!----> <a href="/cmake/" class="nav-link router-link-active">
  CMake
</a></li><li class="dropdown-item"><!----> <a href="/技术面试/" class="nav-link">
  技术面试
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/cmake/Cmake教程01-入门和第一个项目.html" class="sidebar-link">Cmake教程01-入门和第一个项目</a></li><li><a href="/cmake/Cmake教程02-配置版本号.html" class="active sidebar-link">Cmake教程02-配置版本号</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cmake/Cmake教程02-配置版本号.html#（1）系列教程介绍" class="sidebar-link">（1）系列教程介绍</a></li><li class="sidebar-sub-header"><a href="/cmake/Cmake教程02-配置版本号.html#（2）cmake-的使用环境和安装" class="sidebar-link">（2）CMake 的使用环境和安装</a></li><li class="sidebar-sub-header"><a href="/cmake/Cmake教程02-配置版本号.html#（3）cmake配置版本号" class="sidebar-link">（3）CMake配置版本号</a></li><li class="sidebar-sub-header"><a href="/cmake/Cmake教程02-配置版本号.html#（4）使用cmake进行编译" class="sidebar-link">（4）使用CMake进行编译</a></li><li class="sidebar-sub-header"><a href="/cmake/Cmake教程02-配置版本号.html#（5）tutorialconfig-h-in中代码" class="sidebar-link">（5）TutorialConfig.h.in中代码</a></li><li class="sidebar-sub-header"><a href="/cmake/Cmake教程02-配置版本号.html#（6）cpp-代码" class="sidebar-link">（6）cpp 代码</a></li></ul></li><li><a href="/cmake/Cmake教程03-指定C++11编译标准.html" class="sidebar-link">Cmake教程03-指定C++11编译标准</a></li><li><a href="/cmake/Cmake教程04-生成lib或so库.html" class="sidebar-link">Cmake教程04-生成lib或so库</a></li><li><a href="/cmake/Cmake教程05-install打包.html" class="sidebar-link">Cmake教程05-install打包</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="（1）系列教程介绍"><a href="#（1）系列教程介绍" class="header-anchor">#</a> （1）系列教程介绍</h2> <p>本文主要讲述如何使用CMakeLists.txt，配置程序的版本号。程序在发布的时候需要对用的版本号，同时为了保证程序的兼容性，往往需要在程序中判断当前程序的版本。所以如果在编译过程中将版本号自动的传入程序中，就可以使程序更智能。</p> <h2 id="（2）cmake-的使用环境和安装"><a href="#（2）cmake-的使用环境和安装" class="header-anchor">#</a> （2）CMake 的使用环境和安装</h2> <p>本教程的使用环境为：</p> <div class="language- extra-class"><pre class="language-text"><code>ubutu18.04 lts
gcc version 7.5.0
g++ version 7.5.0
cmake version 3.10.2
</code></pre></div><p>安装cmake：</p> <div class="language- extra-class"><pre class="language-text"><code>sudo apt install cmake
</code></pre></div><h2 id="（3）cmake配置版本号"><a href="#（3）cmake配置版本号" class="header-anchor">#</a> （3）CMake配置版本号</h2> <p>在project命令中添加 VERSION 1.0 指令 就可以指定程序的版本。通过使用configure_file命令，解析TutorialConfig.h.in文件，将该版本号自动转换成宏定义额方式，传递到程序中。</p> <div class="language- extra-class"><pre class="language-text"><code># 设置cmake的最低版本
cmake_minimum_required(VERSION 3.10)

# 设置工程名称 和版本
project(tutorial_second VERSION 1.0)

# 指定版本号的配置文件
configure_file(include/TutorialConfig.h.in TutorialConfig.h)

# 增加生成可执行文件，生成的程序名称为：tutorial_first
add_executable(tutorial_second src/tutorial_second.cpp)

# 为指定项目添加 include 路径
target_include_directories(tutorial_second PUBLIC
                            &quot;${PROJECT_BINARY_DIR}&quot;
)
</code></pre></div><p>命令使用：</p> <p>configure_file：</p> <div class="language- extra-class"><pre class="language-text"><code>configure_file(&lt;input&gt; &lt;output&gt;
   [COPYONLY] [ESCAPE_QUOTES] [@ONLY]
   [NEWLINE_STYLE [UNIX|DOS|WIN32|LF|CRLF] ])
</code></pre></div><h2 id="（4）使用cmake进行编译"><a href="#（4）使用cmake进行编译" class="header-anchor">#</a> （4）使用CMake进行编译</h2> <p>CMake在生成文件的过程中会生成很多中间缓存文件，为了是项目更简洁，文件路径更清楚，一般会在项目的root目录下建立一个文件夹，用于存储CMake生成的中间文件。而一般使用的文件家名称为build或者release。下面是使用命令：</p> <div class="language- extra-class"><pre class="language-text"><code># 进入项目的root目录，本文为：tutorial_first
cd tutorial_first

# 创建存储缓存文件的文件夹，build
mkdir build

# 使用CMake命令生成makefile文件
cmake ..

# 使用make命令进行编译
cmake --build .
</code></pre></div><h2 id="（5）tutorialconfig-h-in中代码"><a href="#（5）tutorialconfig-h-in中代码" class="header-anchor">#</a> （5）TutorialConfig.h.in中代码</h2> <div class="language- extra-class"><pre class="language-text"><code>// the configured options and settings for Tutorial
#define Tutorial_VERSION_MAJOR @Tutorial_VERSION_MAJOR@
#define Tutorial_VERSION_MINOR @Tutorial_VERSION_MINOR@
</code></pre></div><h2 id="（6）cpp-代码"><a href="#（6）cpp-代码" class="header-anchor">#</a> （6）cpp 代码</h2> <p>tutorial_second.cpp 程序代码：</p> <div class="language- extra-class"><pre class="language-text"><code>#include &lt;iostream&gt;
#include &quot;TutorialConfig.h&quot;

int main(int argc, char const *argv[])
{
    std::cout &lt;&lt;&quot;第一个cmake教程&quot; &lt;&lt; std::endl;
    if (argc &lt; 2) {
    // report version
    std::cout &lt;&lt; argv[0] &lt;&lt; &quot; Version &quot; &lt;&lt; Tutorial_VERSION_MAJOR &lt;&lt; &quot;.&quot;
              &lt;&lt; Tutorial_VERSION_MINOR &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;Usage: &quot; &lt;&lt; argv[0] &lt;&lt; &quot; number&quot; &lt;&lt; std::endl;

  }
    return 0;
}
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cmake/Cmake教程01-入门和第一个项目.html" class="prev">
        Cmake教程01-入门和第一个项目
      </a></span> <span class="next"><a href="/cmake/Cmake教程03-指定C++11编译标准.html">
        Cmake教程03-指定C++11编译标准
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.65df3687.js" defer></script><script src="/assets/js/2.4014e5fb.js" defer></script><script src="/assets/js/9.205b9973.js" defer></script>
  </body>
</html>
