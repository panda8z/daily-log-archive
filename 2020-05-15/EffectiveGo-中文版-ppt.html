<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><style>.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTBMMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMzIgOTBsNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDBsMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwbDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS13aWR0aDo1cHh9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImEiIGQ9Ik0yMCA2MGgtNWE1IDUgMCAwMS01LTVWMjBhNSA1IDAgMDE1LTVoNjBhNSA1IDAgMDE1IDV2NU0zMCA4NWg2MCIvPjxyZWN0IHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIi8+PHJlY3QgY2xhc3M9ImEiIHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNNDAgNTBoNDBNNDAgNjBoMzAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide.bespoke-marp-active{opacity:1;pointer-events:auto;z-index:0}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;z-index:1;will-change:transform}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{flex:0 0 0;background:#0288d1;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{height:100%;left:0;position:absolute;top:0;width:100%;display:grid;grid-template-columns:2fr 1fr;grid-template-rows:minmax(140px,1fr) 2fr 3em;grid-template-areas:"current next" "current note" "info    note"}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;position:relative;overflow:hidden}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{-webkit-filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;-webkit-filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;top:20px;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#ddd;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{margin:20px;width:calc(100% - 40px);height:calc(100% - 40px);box-sizing:border-box;overflow:auto;padding-right:3px;white-space:pre-wrap;word-wrap:break-word;scrollbar-width:thin;scrollbar-color:hsla(0,0%,86.7%,.5) transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,86.7%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#ddd;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{display:block;box-sizing:border-box;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section h1{font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;color-adjust:exact!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{display:block;height:auto;width:100%}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{position:static}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{content:""}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{position:relative}}div#p>svg>foreignObject>section [data-marp-fitting-svg-content]{display:table;white-space:nowrap}div#p>svg>foreignObject>section [data-marp-fitting-svg-content-wrap]{white-space:pre}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}
/*!
 * Marp default theme.
 *
 * @theme default
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}div#p>svg>foreignObject>section .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}div#p>svg>foreignObject>section .anchor:focus{outline:none}div#p>svg>foreignObject>section h1 .octicon-link,div#p>svg>foreignObject>section h2 .octicon-link,div#p>svg>foreignObject>section h3 .octicon-link,div#p>svg>foreignObject>section h4 .octicon-link,div#p>svg>foreignObject>section h5 .octicon-link,div#p>svg>foreignObject>section h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}div#p>svg>foreignObject>section h1:hover .anchor,div#p>svg>foreignObject>section h2:hover .anchor,div#p>svg>foreignObject>section h3:hover .anchor,div#p>svg>foreignObject>section h4:hover .anchor,div#p>svg>foreignObject>section h5:hover .anchor,div#p>svg>foreignObject>section h6:hover .anchor{text-decoration:none}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link{visibility:visible}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}div#p>svg>foreignObject>section{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}div#p>svg>foreignObject>section details{display:block}div#p>svg>foreignObject>section summary{display:list-item}div#p>svg>foreignObject>section a{background-color:initial}div#p>svg>foreignObject>section a:active,div#p>svg>foreignObject>section a:hover{outline-width:0}div#p>svg>foreignObject>section strong{font-weight:inherit;font-weight:bolder}div#p>svg>foreignObject>section h1{margin:.67em 0}div#p>svg>foreignObject>section img{border-style:none}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section kbd,div#p>svg>foreignObject>section pre{font-family:monospace,monospace;font-size:1em}div#p>svg>foreignObject>section hr{box-sizing:initial;overflow:visible}div#p>svg>foreignObject>section input{font:inherit;margin:0;overflow:visible}div#p>svg>foreignObject>section [type=checkbox]{padding:0}div#p>svg>foreignObject>section *,div#p>svg>foreignObject>section [type=checkbox]{box-sizing:border-box}div#p>svg>foreignObject>section input{font-family:inherit;font-size:inherit;line-height:inherit}div#p>svg>foreignObject>section a{color:#0366d6;text-decoration:none}div#p>svg>foreignObject>section a:hover{text-decoration:underline}div#p>svg>foreignObject>section strong{font-weight:600}div#p>svg>foreignObject>section hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}div#p>svg>foreignObject>section hr:after,div#p>svg>foreignObject>section hr:before{display:table;content:""}div#p>svg>foreignObject>section hr:after{clear:both}div#p>svg>foreignObject>section table{border-spacing:0;border-collapse:collapse}div#p>svg>foreignObject>section td,div#p>svg>foreignObject>section th{padding:0}div#p>svg>foreignObject>section details summary{cursor:pointer}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section h1{font-size:32px}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{font-weight:600}div#p>svg>foreignObject>section h2{font-size:24px}div#p>svg>foreignObject>section h3{font-size:20px}div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4{font-weight:600}div#p>svg>foreignObject>section h4{font-size:16px}div#p>svg>foreignObject>section h5{font-size:14px}div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{font-weight:600}div#p>svg>foreignObject>section h6{font-size:12px}div#p>svg>foreignObject>section p{margin-top:0;margin-bottom:10px}div#p>svg>foreignObject>section blockquote{margin:0}div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section ul{padding-left:0;margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ul ol{list-style-type:lower-roman}div#p>svg>foreignObject>section ol ol ol,div#p>svg>foreignObject>section ol ul ol,div#p>svg>foreignObject>section ul ol ol,div#p>svg>foreignObject>section ul ul ol{list-style-type:lower-alpha}div#p>svg>foreignObject>section dd{margin-left:0}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}div#p>svg>foreignObject>section pre{margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section input::-webkit-inner-spin-button,div#p>svg>foreignObject>section input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}div#p>svg>foreignObject>section :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}div#p>svg>foreignObject>section .border{border:1px solid #e1e4e8!important}div#p>svg>foreignObject>section .border-0{border:0!important}div#p>svg>foreignObject>section .border-bottom{border-bottom:1px solid #e1e4e8!important}div#p>svg>foreignObject>section .rounded-1{border-radius:3px!important}div#p>svg>foreignObject>section .bg-white{background-color:#fff!important}div#p>svg>foreignObject>section .bg-gray-light{background-color:#fafbfc!important}div#p>svg>foreignObject>section .text-gray-light{color:#6a737d!important}div#p>svg>foreignObject>section .pl-3,div#p>svg>foreignObject>section .px-3{padding-left:16px!important}div#p>svg>foreignObject>section .px-3{padding-right:16px!important}div#p>svg>foreignObject>section .f6{font-size:12px!important}div#p>svg>foreignObject>section .lh-condensed{line-height:1.25!important}div#p>svg>foreignObject>section .text-bold{font-weight:600!important}div#p>svg>foreignObject>section .pl-c{color:#6a737d}div#p>svg>foreignObject>section .pl-c1,div#p>svg>foreignObject>section .pl-s .pl-v{color:#005cc5}div#p>svg>foreignObject>section .pl-e,div#p>svg>foreignObject>section .pl-en{color:#6f42c1}div#p>svg>foreignObject>section .pl-s .pl-s1,div#p>svg>foreignObject>section .pl-smi{color:#24292e}div#p>svg>foreignObject>section .pl-ent{color:#22863a}div#p>svg>foreignObject>section .pl-k{color:#d73a49}div#p>svg>foreignObject>section .pl-pds,div#p>svg>foreignObject>section .pl-s,div#p>svg>foreignObject>section .pl-s .pl-pse .pl-s1,div#p>svg>foreignObject>section .pl-sr,div#p>svg>foreignObject>section .pl-sr .pl-cce,div#p>svg>foreignObject>section .pl-sr .pl-sra,div#p>svg>foreignObject>section .pl-sr .pl-sre{color:#032f62}div#p>svg>foreignObject>section .pl-smw,div#p>svg>foreignObject>section .pl-v{color:#e36209}div#p>svg>foreignObject>section .pl-bu{color:#b31d28}div#p>svg>foreignObject>section .pl-ii{color:#fafbfc;background-color:#b31d28}div#p>svg>foreignObject>section .pl-c2{color:#fafbfc;background-color:#d73a49}div#p>svg>foreignObject>section .pl-c2:before{content:"^M"}div#p>svg>foreignObject>section .pl-sr .pl-cce{font-weight:700;color:#22863a}div#p>svg>foreignObject>section .pl-ml{color:#735c0f}div#p>svg>foreignObject>section .pl-mh,div#p>svg>foreignObject>section .pl-mh .pl-en,div#p>svg>foreignObject>section .pl-ms{font-weight:700;color:#005cc5}div#p>svg>foreignObject>section .pl-mi{font-style:italic;color:#24292e}div#p>svg>foreignObject>section .pl-mb{font-weight:700;color:#24292e}div#p>svg>foreignObject>section .pl-md{color:#b31d28;background-color:#ffeef0}div#p>svg>foreignObject>section .pl-mi1{color:#22863a;background-color:#f0fff4}div#p>svg>foreignObject>section .pl-mc{color:#e36209;background-color:#ffebda}div#p>svg>foreignObject>section .pl-mi2{color:#f6f8fa;background-color:#005cc5}div#p>svg>foreignObject>section .pl-mdr{font-weight:700;color:#6f42c1}div#p>svg>foreignObject>section .pl-ba{color:#586069}div#p>svg>foreignObject>section .pl-sg{color:#959da5}div#p>svg>foreignObject>section .pl-corl{text-decoration:underline;color:#032f62}div#p>svg>foreignObject>section .mb-0{margin-bottom:0!important}div#p>svg>foreignObject>section .my-2{margin-bottom:8px!important;margin-top:8px!important}div#p>svg>foreignObject>section .pl-0{padding-left:0!important}div#p>svg>foreignObject>section .py-0{padding-top:0!important;padding-bottom:0!important}div#p>svg>foreignObject>section .pl-1{padding-left:4px!important}div#p>svg>foreignObject>section .pl-2{padding-left:8px!important}div#p>svg>foreignObject>section .py-2{padding-top:8px!important;padding-bottom:8px!important}div#p>svg>foreignObject>section .pl-3{padding-left:16px!important}div#p>svg>foreignObject>section .pl-4{padding-left:24px!important}div#p>svg>foreignObject>section .pl-5{padding-left:32px!important}div#p>svg>foreignObject>section .pl-6{padding-left:40px!important}div#p>svg>foreignObject>section .pl-7{padding-left:48px!important}div#p>svg>foreignObject>section .pl-8{padding-left:64px!important}div#p>svg>foreignObject>section .pl-9{padding-left:80px!important}div#p>svg>foreignObject>section .pl-10{padding-left:96px!important}div#p>svg>foreignObject>section .pl-11{padding-left:112px!important}div#p>svg>foreignObject>section .pl-12{padding-left:128px!important}div#p>svg>foreignObject>section hr{border-bottom-color:#eee}div#p>svg>foreignObject>section kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}div#p>svg>foreignObject>section:after,div#p>svg>foreignObject>section:before{display:table
  /* content:""; */}div#p>svg>foreignObject>section:after{clear:both}div#p>svg>foreignObject>section>:first-child{margin-top:0!important}div#p>svg>foreignObject>section>:last-child{margin-bottom:0!important}div#p>svg>foreignObject>section a:not([href]){color:inherit;text-decoration:none}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section details,div#p>svg>foreignObject>section dl,div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section p,div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section table,div#p>svg>foreignObject>section ul{margin-top:0;margin-bottom:16px}div#p>svg>foreignObject>section hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}div#p>svg>foreignObject>section blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section blockquote>:last-child{margin-bottom:0}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}div#p>svg>foreignObject>section h1{font-size:2em}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}div#p>svg>foreignObject>section h2{font-size:1.5em}div#p>svg>foreignObject>section h3{font-size:1.25em}div#p>svg>foreignObject>section h4{font-size:1em}div#p>svg>foreignObject>section h5{font-size:.875em}div#p>svg>foreignObject>section h6{font-size:.85em;color:#6a737d}div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section ul{padding-left:2em}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ol ul,div#p>svg>foreignObject>section ul ol,div#p>svg>foreignObject>section ul ul{margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section li{word-wrap:break-all}div#p>svg>foreignObject>section li>p{margin-top:16px}div#p>svg>foreignObject>section li+li{margin-top:.25em}div#p>svg>foreignObject>section dl{padding:0}div#p>svg>foreignObject>section dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}div#p>svg>foreignObject>section dl dd{padding:0 16px;margin-bottom:16px}div#p>svg>foreignObject>section table{display:block;width:100%;overflow:auto}div#p>svg>foreignObject>section table th{font-weight:600}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{padding:6px 13px;border:1px solid #dfe2e5}div#p>svg>foreignObject>section table tr{background-color:#fff;border-top:1px solid #c6cbd1}div#p>svg>foreignObject>section table tr:nth-child(2n){background-color:#f6f8fa}div#p>svg>foreignObject>section img{max-width:100%;box-sizing:initial;background-color:#fff}div#p>svg>foreignObject>section img[align=right]{padding-left:20px}div#p>svg>foreignObject>section img[align=left]{padding-right:20px}div#p>svg>foreignObject>section code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}div#p>svg>foreignObject>section pre{word-wrap:normal}div#p>svg>foreignObject>section pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}div#p>svg>foreignObject>section .highlight{margin-bottom:16px}div#p>svg>foreignObject>section .highlight pre{margin-bottom:0;word-break:normal}div#p>svg>foreignObject>section pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}div#p>svg>foreignObject>section pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}div#p>svg>foreignObject>section .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}div#p>svg>foreignObject>section .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}div#p>svg>foreignObject>section .blob-wrapper{overflow-x:auto;overflow-y:hidden}div#p>svg>foreignObject>section .blob-wrapper-embedded{max-height:240px;overflow-y:auto}div#p>svg>foreignObject>section .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}div#p>svg>foreignObject>section .blob-num:hover{color:rgba(27,31,35,.6)}div#p>svg>foreignObject>section .blob-num:before{content:attr(data-line-number)}div#p>svg>foreignObject>section .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}div#p>svg>foreignObject>section .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}div#p>svg>foreignObject>section .pl-token.active,div#p>svg>foreignObject>section .pl-token:hover{cursor:pointer;background:#ffea7f}div#p>svg>foreignObject>section .tab-size[data-tab-size="1"]{-moz-tab-size:1;-o-tab-size:1;tab-size:1}div#p>svg>foreignObject>section .tab-size[data-tab-size="2"]{-moz-tab-size:2;-o-tab-size:2;tab-size:2}div#p>svg>foreignObject>section .tab-size[data-tab-size="3"]{-moz-tab-size:3;-o-tab-size:3;tab-size:3}div#p>svg>foreignObject>section .tab-size[data-tab-size="4"]{-moz-tab-size:4;-o-tab-size:4;tab-size:4}div#p>svg>foreignObject>section .tab-size[data-tab-size="5"]{-moz-tab-size:5;-o-tab-size:5;tab-size:5}div#p>svg>foreignObject>section .tab-size[data-tab-size="6"]{-moz-tab-size:6;-o-tab-size:6;tab-size:6}div#p>svg>foreignObject>section .tab-size[data-tab-size="7"]{-moz-tab-size:7;-o-tab-size:7;tab-size:7}div#p>svg>foreignObject>section .tab-size[data-tab-size="8"]{-moz-tab-size:8;-o-tab-size:8;tab-size:8}div#p>svg>foreignObject>section .tab-size[data-tab-size="9"]{-moz-tab-size:9;-o-tab-size:9;tab-size:9}div#p>svg>foreignObject>section .tab-size[data-tab-size="10"]{-moz-tab-size:10;-o-tab-size:10;tab-size:10}div#p>svg>foreignObject>section .tab-size[data-tab-size="11"]{-moz-tab-size:11;-o-tab-size:11;tab-size:11}div#p>svg>foreignObject>section .tab-size[data-tab-size="12"]{-moz-tab-size:12;-o-tab-size:12;tab-size:12}div#p>svg>foreignObject>section .task-list-item{list-style-type:none}div#p>svg>foreignObject>section .task-list-item+.task-list-item{margin-top:3px}div#p>svg>foreignObject>section .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}div#p>svg>foreignObject>section .hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-meta{color:#969896}div#p>svg>foreignObject>section .hljs-emphasis,div#p>svg>foreignObject>section .hljs-quote,div#p>svg>foreignObject>section .hljs-strong,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#df5000}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#d73a49}div#p>svg>foreignObject>section .hljs-attribute,div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-literal,div#p>svg>foreignObject>section .hljs-symbol{color:#0086b3}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section{color:#63a35c}div#p>svg>foreignObject>section .hljs-tag{color:#333}div#p>svg>foreignObject>section .hljs-attr,div#p>svg>foreignObject>section .hljs-selector-attr,div#p>svg>foreignObject>section .hljs-selector-class,div#p>svg>foreignObject>section .hljs-selector-id,div#p>svg>foreignObject>section .hljs-selector-pseudo,div#p>svg>foreignObject>section .hljs-title{color:#6f42c1}div#p>svg>foreignObject>section .hljs-addition{color:#55a532;background-color:#eaffea}div#p>svg>foreignObject>section .hljs-deletion{color:#bd2c00;background-color:#ffecec}div#p>svg>foreignObject>section .hljs-link{text-decoration:underline}div#p>svg>foreignObject>section .hljs-number{color:#005cc5}div#p>svg>foreignObject>section .hljs-string{color:#032f62}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{max-height:563px}div#p>svg>foreignObject>section h1{color:#246;font-size:1.6em}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{border-bottom:none}div#p>svg>foreignObject>section h2{font-size:1.3em}div#p>svg>foreignObject>section h3{font-size:1.1em}div#p>svg>foreignObject>section h4{font-size:1.05em}div#p>svg>foreignObject>section h5{font-size:1em}div#p>svg>foreignObject>section h6{font-size:.9em}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{font-weight:inherit;color:#48c}div#p>svg>foreignObject>section hr{height:0;padding-top:.25em}div#p>svg>foreignObject>section pre{border:1px solid #999;line-height:1.15;overflow:visible}div#p>svg>foreignObject>section pre code svg[data-marp-fitting=svg]{max-height:529px}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{margin:0;position:absolute;left:30px;color:hsla(0,0%,40%,.75);font-size:18px}div#p>svg>foreignObject>section header{top:21px}div#p>svg>foreignObject>section footer{bottom:21px}div#p>svg>foreignObject>section{align-items:stretch;background:#fff;display:flex;flex-direction:column;flex-wrap:nowrap;font-size:29px;height:720px;justify-content:center;padding:78.5px;width:1280px}div#p>svg>foreignObject>section>:last-child,div#p>svg>foreignObject>section[data-footer]>:nth-last-child(2){margin-bottom:0}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section:after{position:absolute;padding:0;right:30px;bottom:21px;font-size:24px;color:#777}div#p>svg>foreignObject>section.invert{background-color:#222;color:#e6eaf0}div#p>svg>foreignObject>section.invert:after{color:#999}div#p>svg>foreignObject>section.invert img{background-color:transparent}div#p>svg>foreignObject>section.invert a{color:#50b3ff}div#p>svg>foreignObject>section.invert h1{color:#a3c5e7}div#p>svg>foreignObject>section.invert h2,div#p>svg>foreignObject>section.invert h3,div#p>svg>foreignObject>section.invert h4,div#p>svg>foreignObject>section.invert h5{color:#ebeff5}div#p>svg>foreignObject>section.invert blockquote,div#p>svg>foreignObject>section.invert h6{border-color:#3d3f43;color:#939699}div#p>svg>foreignObject>section.invert h1 strong,div#p>svg>foreignObject>section.invert h2 strong,div#p>svg>foreignObject>section.invert h3 strong,div#p>svg>foreignObject>section.invert h4 strong,div#p>svg>foreignObject>section.invert h5 strong,div#p>svg>foreignObject>section.invert h6 strong{color:#7bf}div#p>svg>foreignObject>section.invert hr{background-color:#3d3f43}div#p>svg>foreignObject>section.invert footer,div#p>svg>foreignObject>section.invert header{color:hsla(0,0%,60%,.75)}div#p>svg>foreignObject>section.invert code,div#p>svg>foreignObject>section.invert kbd{background-color:#111}div#p>svg>foreignObject>section.invert kbd{border-color:#666;box-shadow:inset 0 -1px 0 #555;color:#e6eaf0}div#p>svg>foreignObject>section.invert table tr{background-color:#12181d;border-color:#60657b}div#p>svg>foreignObject>section.invert table tr:nth-child(2n){background-color:#1b2024}div#p>svg>foreignObject>section.invert table td,div#p>svg>foreignObject>section.invert table th{border-color:#5b5e61}div#p>svg>foreignObject>section.invert pre{background-color:#0a0e12;border-color:#777}div#p>svg>foreignObject>section.invert pre code{background-color:transparent}div#p>svg>foreignObject>section[data-color] h1,div#p>svg>foreignObject>section[data-color] h2,div#p>svg>foreignObject>section[data-color] h3,div#p>svg>foreignObject>section[data-color] h4,div#p>svg>foreignObject>section[data-color] h5,div#p>svg>foreignObject>section[data-color] h6{color:currentColor}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-paginate="true" data-theme="default" data-marpit-pagination="1" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h1>é«˜æ•ˆçš„ Go ç¼–ç¨‹ Effective Go</h1>
<blockquote>
<p>æœ¬æ–‡æ‰€æœ‰å†…å®¹å‡æ¥è‡ªç¤¾åŒºï¼Œè¿™é‡Œä»…åšæ ¼å¼åŒ–æ•´ç†ã€‚</p>
<p>æ„Ÿè°¢<img class="emoji" draggable="false" alt="ğŸ™" src="https://twemoji.maxcdn.com/2/svg/1f64f.svg" data-marp-twemoji=""/>å„ä½ç½‘å‹çš„åŠ³åŠ¨æˆæœã€‚</p>
<p>æœ¬æ–‡ç« é¦–å‘åœ¨ <a href="https://learnku.com/">LearnKu.com</a> ç½‘ç«™ä¸Šã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="https://learnku.com/docs/effective-go/2020">ã€Šé«˜æ•ˆçš„ Go ç¼–ç¨‹ Effective Goã€‹ | Go æŠ€æœ¯è®ºå›</a></p>
<p>ä½œè€…ä»¬çš„è¯ï¼š</p>
<p>æœ¬è¯‘æ–‡ä»…ç”¨äºå­¦ä¹ å’Œäº¤æµç›®çš„ï¼Œè½¬è½½è¯·åŠ¡å¿…æ³¨æ˜æ–‡ç« è¯‘è€…ã€å‡ºå¤„ã€å’Œæœ¬æ–‡é“¾æ¥<br />
æˆ‘ä»¬çš„ç¿»è¯‘å·¥ä½œéµç…§ <a href="https://learnku.com/docs/guide/cc4.0/6589">CC åè®®</a>ï¼Œå¦‚æœæˆ‘ä»¬çš„å·¥ä½œæœ‰ä¾µçŠ¯åˆ°æ‚¨çš„æƒç›Šï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬ã€‚</p>
</blockquote>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="2" data-paginate="true" data-theme="default" data-marpit-pagination="2" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>å¼•è¨€</h2>
<h3>ä»‹ç»</h3>
<p>Go æ˜¯ä¸€é—¨å…¨æ–°çš„è¯­è¨€ã€‚å°½ç®¡å®ƒä»æ—¢æœ‰çš„è¯­è¨€ä¸­å€Ÿé‰´äº†è®¸å¤šç†å¿µï¼Œä½†å…¶ä¸ä¼—ä¸åŒçš„ç‰¹æ€§ï¼Œ ä½¿å¾—ä½¿ç”¨ Go ç¼–ç¨‹åœ¨æœ¬è´¨ä¸Šå°±ä¸åŒäºå…¶å®ƒè¯­è¨€ã€‚å°†ç°æœ‰çš„ C++ æˆ– Java ç¨‹åºç›´è¯‘ä¸º Go ç¨‹åºå¹¶ä¸èƒ½ä»¤äººæ»¡æ„ â€”â€” æ¯•ç«Ÿ Java ç¨‹åºæ˜¯ç”¨ Java ç¼–å†™çš„ï¼Œè€Œä¸æ˜¯ Goã€‚ å¦ä¸€æ–¹é¢ï¼Œè‹¥ä» Go çš„è§’åº¦å»åˆ†æé—®é¢˜ï¼Œä½ å°±èƒ½ç¼–å†™å‡ºåŒæ ·å¯è¡Œä½†å¤§ä¸ç›¸åŒçš„ç¨‹åºã€‚ æ¢å¥è¯è¯´ï¼Œè¦æƒ³å°† Go ç¨‹åºå†™å¾—å¥½ï¼Œå°±å¿…é¡»ç†è§£å…¶ç‰¹æ€§å’Œé£æ ¼ã€‚äº†è§£å‘½åã€æ ¼å¼åŒ–ã€ ç¨‹åºç»“æ„ç­‰æ—¢å®šè§„åˆ™ä¹ŸåŒæ ·é‡è¦ï¼Œè¿™æ ·ä½ ç¼–å†™çš„ç¨‹åºæ‰èƒ½æ›´å®¹æ˜“è¢«å…¶ä»–ç¨‹åºå‘˜æ‰€ç†è§£ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-paginate="true" data-theme="default" data-marpit-pagination="3" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æœ¬æ–‡æ¡£å°±å¦‚ä½•ç¼–å†™æ¸…æ™°ã€åœ°é“çš„ Go ä»£ç æä¾›äº†ä¸€äº›æŠ€å·§ã€‚å®ƒæ˜¯å¯¹<a href="https://go-zh.org/ref/spec">è¯­è¨€è§„èŒƒ</a>ã€ <a href="https://learnku.com/golang/wikis/38166">Go è¯­è¨€ä¹‹æ—…</a>ä»¥åŠ <a href="https://learnku.com/golang/wikis/38174">å¦‚ä½•ä½¿ç”¨ Go ç¼–ç¨‹</a> çš„è¡¥å……è¯´æ˜ï¼Œå› æ­¤æˆ‘ä»¬å»ºè®®æ‚¨å…ˆé˜…è¯»è¿™äº›æ–‡æ¡£ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="4" data-paginate="true" data-theme="default" data-marpit-pagination="4" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>ç¤ºä¾‹</h3>
<p><a href="https://golang.org/src/">Go åŒ…çš„æºç </a> ä¸ä»…æ˜¯æ ¸å¿ƒåº“ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Go è¯­è¨€çš„ç¤ºä¾‹æºç ã€‚ æ­¤å¤–ï¼Œå…¶ä¸­çš„ä¸€äº›åŒ…è¿˜åŒ…å«äº†å¯ç‹¬ç«‹çš„å¯æ‰§è¡Œç¤ºä¾‹ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ <a href="http://golang.org/">golang.org</a> ç½‘ç«™ä¸Šè¿è¡Œå®ƒä»¬ï¼Œæ¯”å¦‚ <a href="https://golang.org/pkg/strings/#example_Map">è¿™ä¸ªä¾‹å­</a> ã€‚å¦‚æœä½ æœ‰ä»»ä½•å…³äºæŸäº›é—®é¢˜å¦‚ä½•è§£å†³ï¼Œæˆ–æŸäº›ä¸œè¥¿å¦‚ä½•å®ç°çš„ç–‘é—®ï¼Œ ä¹Ÿå¯ä»¥ä»ä¸­è·å–ç›¸å…³çš„ç­”æ¡ˆã€æ€è·¯ä»¥åŠåå°å®ç°ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-paginate="true" data-theme="default" data-marpit-pagination="5" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>æ ¼å¼åŒ–</h2>
<p>æ ¼å¼åŒ–é—®é¢˜æ€»æ˜¯å……æ»¡äº†äº‰è®®ï¼Œä½†å´å§‹ç»ˆæ²¡æœ‰å½¢æˆç»Ÿä¸€çš„å®šè®ºã€‚è™½è¯´äººä»¬å¯ä»¥é€‚åº”ä¸åŒçš„ç¼–ç é£æ ¼ï¼Œ ä½†æŠ›å¼ƒè¿™ç§é€‚åº”è¿‡ç¨‹å²‚ä¸æ›´å¥½ï¼Ÿè‹¥æ‰€æœ‰äººéƒ½éµå¾ªç›¸åŒçš„ç¼–ç é£æ ¼ï¼Œåœ¨è¿™ç±»é—®é¢˜ä¸Šæµªè´¹çš„æ—¶é—´å°†ä¼šæ›´å°‘ã€‚ é—®é¢˜å°±åœ¨äºå¦‚ä½•å®ç°è¿™ç§è®¾æƒ³ï¼Œè€Œæ— éœ€å†—é•¿çš„è¯­è¨€é£æ ¼è§„èŒƒã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-paginate="true" data-theme="default" data-marpit-pagination="6" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åœ¨ Go ä¸­æˆ‘ä»¬å¦è¾Ÿè¹Šå¾„ï¼Œè®©æœºå™¨æ¥å¤„ç†å¤§éƒ¨åˆ†çš„æ ¼å¼åŒ–é—®é¢˜ã€‚<code>gofmt</code> ç¨‹åºï¼ˆä¹Ÿå¯ç”¨ <code>go fmt</code>ï¼Œå®ƒä»¥åŒ…ä¸ºå¤„ç†å¯¹è±¡è€Œéæºæ–‡ä»¶ï¼‰å°† Go ç¨‹åºæŒ‰ç…§æ ‡å‡†é£æ ¼ç¼©è¿›ã€ å¯¹é½ï¼Œä¿ç•™æ³¨é‡Šå¹¶åœ¨éœ€è¦æ—¶é‡æ–°æ ¼å¼åŒ–ã€‚è‹¥ä½ æƒ³çŸ¥é“å¦‚ä½•å¤„ç†ä¸€äº›æ–°çš„ä»£ç å¸ƒå±€ï¼Œè¯·å°è¯•è¿è¡Œ <code>gofmt</code>ï¼›è‹¥ç»“æœä»ä¸å°½äººæ„ï¼Œè¯·é‡æ–°ç»„ç»‡ä½ çš„ç¨‹åºï¼ˆæˆ–æäº¤æœ‰å…³ <code>gofmt</code> çš„ Bugï¼‰ï¼Œè€Œä¸å¿…ä¸ºæ­¤çº ç»“ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-paginate="true" data-theme="default" data-marpit-pagination="7" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œä½ æ— éœ€èŠ±æ—¶é—´å°†ç»“æ„ä½“ä¸­çš„å­—æ®µæ³¨é‡Šå¯¹é½ï¼Œ<code>gofmt</code> å°†ä¸ºä½ ä»£åŠ³ã€‚ å‡å¦‚æœ‰ä»¥ä¸‹å£°æ˜ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> T <span class="hljs-keyword">struct</span> {
    name <span class="hljs-keyword">string</span> <span class="hljs-comment">// å¯¹è±¡å</span>
    value <span class="hljs-keyword">int</span> <span class="hljs-comment">// å¯¹è±¡å€¼</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-paginate="true" data-theme="default" data-marpit-pagination="8" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><code>gofmt</code> ä¼šå°†å®ƒæŒ‰åˆ—å¯¹é½ä¸ºï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> T <span class="hljs-keyword">struct</span> {
    name    <span class="hljs-keyword">string</span> <span class="hljs-comment">// name of the object</span>
    value   <span class="hljs-keyword">int</span>    <span class="hljs-comment">// its value</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-paginate="true" data-theme="default" data-marpit-pagination="9" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ ‡å‡†åŒ…ä¸­æ‰€æœ‰çš„ Go ä»£ç éƒ½å·²ç»ç”¨ <code>gofmt</code> æ ¼å¼åŒ–è¿‡äº†ã€‚</p>
<p>è¿˜æœ‰ä¸€äº›å…³äºæ ¼å¼åŒ–çš„ç»†èŠ‚ï¼Œå®ƒä»¬éå¸¸ç®€çŸ­ï¼š</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-paginate="true" data-theme="default" data-marpit-pagination="10" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><strong>ç¼©è¿›</strong></p>
<p>æˆ‘ä»¬ä½¿ç”¨åˆ¶è¡¨ç¬¦ï¼ˆtabï¼‰ç¼©è¿›ï¼Œ<code>gofmt</code> é»˜è®¤ä¹Ÿä½¿ç”¨å®ƒã€‚åœ¨ä½ è®¤ä¸ºç¡®å®æœ‰å¿…è¦æ—¶å†ä½¿ç”¨ç©ºæ ¼ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-paginate="true" data-theme="default" data-marpit-pagination="11" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><strong>è¡Œçš„é•¿åº¦</strong></p>
<p>Go å¯¹è¡Œçš„é•¿åº¦æ²¡æœ‰é™åˆ¶ï¼Œåˆ«æ‹…å¿ƒæ‰“å­”çº¸ä¸å¤Ÿé•¿ã€‚å¦‚æœä¸€è¡Œå®åœ¨å¤ªé•¿ï¼Œä¹Ÿå¯è¿›è¡ŒæŠ˜è¡Œå¹¶æ’å…¥é€‚å½“çš„ tab ç¼©è¿›ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-paginate="true" data-theme="default" data-marpit-pagination="12" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><strong>æ‹¬å·</strong></p>
<p>æ¯”èµ· C å’Œ Javaï¼ŒGo æ‰€éœ€çš„æ‹¬å·æ›´å°‘ï¼šæ§åˆ¶ç»“æ„ï¼ˆ<code>if</code>ã€<code>for</code> å’Œ <code>switch</code>ï¼‰åœ¨è¯­æ³•ä¸Šå¹¶ä¸éœ€è¦åœ†æ‹¬å·ã€‚æ­¤å¤–ï¼Œæ“ä½œç¬¦ä¼˜å…ˆçº§å¤„ç†å˜å¾—æ›´åŠ ç®€æ´ï¼Œå› æ­¤</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>x&lt;&lt;<span class="hljs-number">8</span> + y&lt;&lt;<span class="hljs-number">16</span>
</span></span></foreignObject></svg></code></pre>
<p>æ­£è¡¨è¿°äº†ç©ºæ ¼ç¬¦æ‰€ä¼ è¾¾çš„å«ä¹‰ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-paginate="true" data-theme="default" data-marpit-pagination="13" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>ä»£ç æ³¨é‡Š</h2>
<p>Go è¯­è¨€æ”¯æŒ C é£æ ¼çš„å—æ³¨é‡Š <code>/* */</code> å’Œ C++ é£æ ¼çš„è¡Œæ³¨é‡Š <code>//</code>ã€‚ è¡Œæ³¨é‡Šæ›´ä¸ºå¸¸ç”¨ï¼Œè€Œå—æ³¨é‡Šåˆ™ä¸»è¦ç”¨ä½œåŒ…çš„æ³¨é‡Šï¼Œå½“ç„¶ä¹Ÿå¯åœ¨ç¦ç”¨ä¸€å¤§æ®µä»£ç æ—¶ä½¿ç”¨ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-paginate="true" data-theme="default" data-marpit-pagination="14" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><code>godoc</code> æ—¢æ˜¯ä¸€ä¸ªç¨‹åºï¼Œåˆæ˜¯ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå®ƒå¯¹ Go çš„æºç è¿›è¡Œå¤„ç†ï¼Œå¹¶æå–åŒ…ä¸­çš„æ–‡æ¡£å†…å®¹ã€‚ å‡ºç°åœ¨é¡¶çº§å£°æ˜ä¹‹å‰ï¼Œä¸”ä¸è¯¥å£°æ˜ä¹‹é—´æ²¡æœ‰ç©ºè¡Œçš„æ³¨é‡Šï¼Œå°†ä¸è¯¥å£°æ˜ä¸€èµ·è¢«æå–å‡ºæ¥ï¼Œä½œä¸ºè¯¥æ¡ç›®çš„è¯´æ˜æ–‡æ¡£ã€‚ è¿™äº›æ³¨é‡Šçš„ç±»å‹å’Œé£æ ¼å†³å®šäº† <code>godoc</code> ç”Ÿæˆçš„æ–‡æ¡£è´¨é‡ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-paginate="true" data-theme="default" data-marpit-pagination="15" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ¯ä¸ªåŒ…éƒ½åº”åŒ…å«ä¸€æ®µ<strong>åŒ…æ³¨é‡Š</strong>ï¼Œå³æ”¾ç½®åœ¨åŒ…å­å¥å‰çš„ä¸€ä¸ªå—æ³¨é‡Šã€‚å¯¹äºåŒ…å«å¤šä¸ªæ–‡ä»¶çš„åŒ…ï¼Œ åŒ…æ³¨é‡Šåªéœ€å‡ºç°åœ¨å…¶ä¸­çš„ä»»ä¸€æ–‡ä»¶ä¸­å³å¯ã€‚åŒ…æ³¨é‡Šåº”åœ¨æ•´ä½“ä¸Šå¯¹è¯¥åŒ…è¿›è¡Œä»‹ç»ï¼Œå¹¶æä¾›åŒ…çš„ç›¸å…³ä¿¡æ¯ã€‚ å®ƒå°†å‡ºç°åœ¨ <code>godoc</code> é¡µé¢ä¸­çš„æœ€ä¸Šé¢ï¼Œå¹¶ä¸ºç´§éšå…¶åçš„å†…å®¹å»ºç«‹è¯¦ç»†çš„æ–‡æ¡£ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-paginate="true" data-theme="default" data-marpit-pagination="16" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">/*
regexp åŒ…ä¸ºæ­£åˆ™è¡¨è¾¾å¼å®ç°äº†ä¸€ä¸ªç®€å•çš„åº“ã€‚

è¯¥åº“æ¥å—çš„æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ä¸ºï¼š

    regexp:
        concatenation { '|' concatenation }
    concatenation:
        { closure }
    closure:
        term [ '*' | '+' | '?' ]
    term:
        '^'
        '$'
        '.'
        character
        '[' [ '^' ] character-ranges ']'
        '(' regexp ')'
*/</span>
<span class="hljs-keyword">package</span> regexp
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-paginate="true" data-theme="default" data-marpit-pagination="17" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥æŸä¸ªåŒ…æ¯”è¾ƒç®€å•ï¼ŒåŒ…æ³¨é‡ŠåŒæ ·å¯ä»¥ç®€æ´äº›ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// path åŒ…å®ç°äº†ä¸€äº›å¸¸ç”¨çš„å·¥å…·ï¼Œ</span>
<span class="hljs-comment">// ä»¥ä¾¿äºæ“ä½œç”¨åæ–œæ åˆ†éš”çš„è·¯å¾„.</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-paginate="true" data-theme="default" data-marpit-pagination="18" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ³¨é‡Šæ— éœ€è¿›è¡Œé¢å¤–çš„æ ¼å¼åŒ–ï¼Œå¦‚ç”¨æ˜Ÿå·æ¥çªå‡ºç­‰ã€‚ç”Ÿæˆçš„è¾“å‡ºç”šè‡³å¯èƒ½æ— æ³•ä»¥ç­‰å®½å­—ä½“æ˜¾ç¤ºï¼Œ å› æ­¤ä¸è¦ä¾èµ–äºç©ºæ ¼å¯¹é½ï¼Œ<code>godoc</code> ä¼šåƒ <code>gofmt</code> é‚£æ ·å¤„ç†å¥½è¿™ä¸€åˆ‡ã€‚ æ³¨é‡Šæ˜¯ä¸ä¼šè¢«è§£æçš„çº¯æ–‡æœ¬ï¼Œå› æ­¤åƒ HTML æˆ–å…¶å®ƒç±»ä¼¼äº <code>_è¿™æ ·_</code> çš„ä¸œè¥¿å°†æŒ‰ç…§ <strong>åŸæ ·</strong> è¾“å‡ºï¼Œå› æ­¤ä¸åº”ä½¿ç”¨å®ƒä»¬ã€‚<code>godoc</code> æ‰€åšçš„è°ƒæ•´ï¼Œ å°±æ˜¯å°†å·²ç¼©è¿›çš„æ–‡æœ¬ä»¥ç­‰å®½å­—ä½“æ˜¾ç¤ºï¼Œæ¥é€‚åº”å¯¹åº”çš„ç¨‹åºç‰‡æ®µã€‚ <a href="http://golang.org/pkg/fmt/"><code>fmt</code> åŒ…</a>çš„æ³¨é‡Šå°±ç”¨äº†è¿™ç§ä¸é”™çš„æ•ˆæœã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-paginate="true" data-theme="default" data-marpit-pagination="19" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><code>godoc</code> æ˜¯å¦ä¼šé‡æ–°æ ¼å¼åŒ–æ³¨é‡Šå–å†³äºä¸Šä¸‹æ–‡ï¼Œå› æ­¤å¿…é¡»ç¡®ä¿å®ƒä»¬çœ‹èµ·æ¥æ¸…æ™°æ˜“è¾¨ï¼š ä½¿ç”¨æ­£ç¡®çš„æ‹¼å†™ã€æ ‡ç‚¹å’Œè¯­å¥ç»“æ„ä»¥åŠæŠ˜å é•¿è¡Œç­‰ã€‚</p>
<p>åœ¨åŒ…ä¸­ï¼Œä»»ä½•é¡¶çº§å£°æ˜å‰é¢çš„æ³¨é‡Šéƒ½å°†ä½œä¸ºè¯¥å£°æ˜çš„<strong>æ–‡æ¡£æ³¨é‡Š</strong>ã€‚ åœ¨ç¨‹åºä¸­ï¼Œæ¯ä¸ªå¯å¯¼å‡ºï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰çš„åç§°éƒ½åº”è¯¥æœ‰æ–‡æ¡£æ³¨é‡Šã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-paginate="true" data-theme="default" data-marpit-pagination="20" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ–‡æ¡£æ³¨é‡Šæœ€å¥½æ˜¯å®Œæ•´çš„å¥å­ï¼Œè¿™æ ·å®ƒæ‰èƒ½é€‚åº”å„ç§è‡ªåŠ¨åŒ–çš„å±•ç¤ºã€‚ ç¬¬ä¸€å¥åº”å½“ä»¥è¢«å£°æ˜çš„ä¸œè¥¿å¼€å¤´ï¼Œå¹¶ä¸”æ˜¯å•å¥çš„æ‘˜è¦ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// Compile ç”¨äºè§£ææ­£åˆ™è¡¨è¾¾å¼å¹¶è¿”å›ï¼Œå¦‚æœæˆ</span>
<span class="hljs-comment">// åŠŸï¼Œåˆ™ Regexp å¯¹è±¡å°±å¯ç”¨äºåŒ¹é…æ‰€é’ˆå¯¹çš„æ–‡æœ¬ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Compile</span><span class="hljs-params">(str <span class="hljs-keyword">string</span>)</span> <span class="hljs-params">(*Regexp, error)</span></span> {
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-paginate="true" data-theme="default" data-marpit-pagination="21" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥æ³¨é‡Šæ€»æ˜¯ä»¥åç§°å¼€å¤´ï¼Œ<code>go doc</code> å‘½ä»¤çš„è¾“å‡ºå°±èƒ½é€šè¿‡ <code>grep</code> å˜å¾—æ›´åŠ æœ‰ç”¨ã€‚å‡å¦‚ä½ è®°ä¸ä½ <code>Compile</code> è¿™ä¸ªåç§°ï¼Œè€Œåˆåœ¨æ‰¾æ­£åˆ™è¡¨è¾¾å¼çš„è§£æå‡½æ•°ï¼ˆã€è§£æã€æ„å‘³ç€å…³é”®è¯ä¸º <code>parse</code>ï¼‰ï¼Œ é‚£å°±å¯ä»¥è¿è¡Œ</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>$ <span class="hljs-keyword">go</span> doc -all regexp | grep -i parse
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-paginate="true" data-theme="default" data-marpit-pagination="22" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥åŒ…ä¸­çš„æ‰€æœ‰æ–‡æ¡£æ³¨é‡Šéƒ½ä»¥ <code>This function...</code> å¼€å¤´ï¼Œ<code>grep</code> å°±æ— æ³•å¸®ä½ è®°ä½æ­¤åç§°ã€‚ ä½†ç”±äºæ¯ä¸ªåŒ…çš„æ–‡æ¡£æ³¨é‡Šéƒ½ä»¥å…¶åç§°å¼€å¤´ï¼Œä½ å°±èƒ½çœ‹åˆ°è¿™æ ·çš„å†…å®¹ï¼Œå®ƒèƒ½æ˜¾ç¤ºä½ æ­£åœ¨å¯»æ‰¾çš„è¯è¯­ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>$ <span class="hljs-keyword">go</span> doc -all regexp | grep -i parse
    Compile parses a regular expression and returns, <span class="hljs-keyword">if</span> successful, a Regexp
    MustCompile is like Compile but panics <span class="hljs-keyword">if</span> the expression cannot be parsed.
    parsed. It simplifies safe initialization of global variables holding
$
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-paginate="true" data-theme="default" data-marpit-pagination="23" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>Go çš„å£°æ˜è¯­æ³•å…è®¸æˆç»„å£°æ˜ã€‚å•ä¸ªæ–‡æ¡£æ³¨é‡Šåº”ä»‹ç»ä¸€ç»„ç›¸å…³çš„å¸¸é‡æˆ–å˜é‡ã€‚ ç”±äºæ˜¯æ•´ä½“å£°æ˜ï¼Œè¿™ç§æ³¨é‡Šå¾€å¾€è¾ƒä¸ºç¬¼ç»Ÿã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// è¡¨è¾¾å¼è§£æå¤±è´¥åè¿”å›é”™è¯¯ä»£ç </span>
<span class="hljs-keyword">var</span> (
    ErrInternal      = errors.New(<span class="hljs-string">"regexp: internal error"</span>)
    ErrUnmatchedLpar = errors.New(<span class="hljs-string">"regexp: unmatched '('"</span>)
    ErrUnmatchedRpar = errors.New(<span class="hljs-string">"regexp: unmatched ')'"</span>)
    ...
)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-paginate="true" data-theme="default" data-marpit-pagination="24" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å³ä¾¿æ˜¯å¯¹äºç§æœ‰åç§°ï¼Œä¹Ÿå¯é€šè¿‡æˆç»„å£°æ˜æ¥è¡¨æ˜å„é¡¹é—´çš„å…³ç³»ï¼Œä¾‹å¦‚æŸä¸€ç»„ç”±äº’æ–¥ä½“ä¿æŠ¤çš„å˜é‡ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> (
    countLock   sync.Mutex
    inputCount  <span class="hljs-keyword">uint32</span>
    outputCount <span class="hljs-keyword">uint32</span>
    errorCount  <span class="hljs-keyword">uint32</span>
)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="25" data-paginate="true" data-theme="default" data-marpit-pagination="25" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>å‘½åè§„åˆ™</h2>
<p>æ­£å¦‚å‘½ååœ¨å…¶å®ƒè¯­è¨€ä¸­çš„åœ°ä½ï¼Œå®ƒåœ¨ Go ä¸­åŒæ ·é‡è¦ã€‚æœ‰æ—¶å®ƒä»¬ç”šè‡³ä¼šå½±å“è¯­ä¹‰ï¼š ä¾‹å¦‚ï¼ŒæŸä¸ªåç§°åœ¨åŒ…å¤–æ˜¯å¦å¯è§ï¼Œå°±å–å†³äºå…¶é¦–ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºå¤§å†™å­—æ¯ã€‚ å› æ­¤æœ‰å¿…è¦èŠ±ç‚¹æ—¶é—´æ¥è®¨è®º Go ç¨‹åºä¸­çš„å‘½åçº¦å®šã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="26" data-paginate="true" data-theme="default" data-marpit-pagination="26" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>åŒ…å</h3>
<p>å½“ä¸€ä¸ªåŒ…è¢«å¯¼å…¥åï¼ŒåŒ…åå°±ä¼šæˆäº†å†…å®¹çš„è®¿é—®å™¨ã€‚åœ¨ä»¥ä¸‹ä»£ç </p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> <span class="hljs-string">"bytes"</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-paginate="true" data-theme="default" data-marpit-pagination="27" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ä¹‹åï¼Œè¢«å¯¼å…¥çš„åŒ…å°±èƒ½é€šè¿‡ <code>bytes.Buffer</code> æ¥å¼•ç”¨äº†ã€‚ è‹¥æ‰€æœ‰äººéƒ½ä»¥ç›¸åŒçš„åç§°æ¥å¼•ç”¨å…¶å†…å®¹å°†å¤§æœ‰è£¨ç›Šï¼Œ è¿™ä¹Ÿå°±æ„å‘³ç€åŒ…åº”å½“æœ‰ä¸ªæ°å½“çš„åç§°ï¼šå…¶åç§°åº”è¯¥ç®€æ´æ˜äº†è€Œæ˜“äºç†è§£ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œ åŒ…åº”å½“ä»¥å°å†™çš„å•ä¸ªå•è¯æ¥å‘½åï¼Œä¸”ä¸åº”ä½¿ç”¨ä¸‹åˆ’çº¿æˆ–é©¼å³°è®°æ³•ã€‚<code>err</code> çš„å‘½åå°±æ˜¯å‡ºäºç®€çŸ­è€ƒè™‘çš„ï¼Œå› ä¸ºä»»ä½•ä½¿ç”¨è¯¥åŒ…çš„äººéƒ½ä¼šé”®å…¥è¯¥åç§°ã€‚ ä¸å¿…æ‹…å¿ƒ<strong>å¼•ç”¨æ¬¡åº</strong>çš„å†²çªã€‚åŒ…åå°±æ˜¯å¯¼å…¥æ—¶æ‰€éœ€çš„å”¯ä¸€é»˜è®¤åç§°ï¼Œ å®ƒå¹¶ä¸éœ€è¦åœ¨æ‰€æœ‰æºç ä¸­ä¿æŒå”¯ä¸€ï¼Œå³ä¾¿åœ¨å°‘æ•°å‘ç”Ÿå†²çªçš„æƒ…å†µä¸‹ï¼Œ ä¹Ÿå¯ä¸ºå¯¼å…¥çš„åŒ…é€‰æ‹©ä¸€ä¸ªåˆ«åæ¥å±€éƒ¨ä½¿ç”¨ã€‚ æ— è®ºå¦‚ä½•ï¼Œé€šè¿‡æ–‡ä»¶åæ¥åˆ¤å®šä½¿ç”¨çš„åŒ…ï¼Œéƒ½æ˜¯ä¸ä¼šäº§ç”Ÿæ··æ·†çš„ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-paginate="true" data-theme="default" data-marpit-pagination="28" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å¦ä¸€ä¸ªçº¦å®šå°±æ˜¯åŒ…ååº”ä¸ºå…¶æºç ç›®å½•çš„åŸºæœ¬åç§°ã€‚åœ¨ <code>src/pkg/encoding/base64</code> ä¸­çš„åŒ…åº”ä½œä¸º <code>&quot;encoding/base64&quot;</code> å¯¼å…¥ï¼Œå…¶åŒ…ååº”ä¸º <code>base64</code>ï¼Œ è€Œé <code>encoding_base64</code> æˆ– <code>encodingBase64</code>ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-paginate="true" data-theme="default" data-marpit-pagination="29" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åŒ…çš„å¯¼å…¥è€…å¯é€šè¿‡åŒ…åæ¥å¼•ç”¨å…¶å†…å®¹ï¼Œå› æ­¤åŒ…ä¸­çš„å¯å¯¼å‡ºåç§°å¯ä»¥æ­¤æ¥é¿å…å†²çªã€‚ ï¼ˆè¯·å‹¿ä½¿ç”¨ <code>import .</code> è®°æ³•ï¼Œå®ƒå¯ä»¥ç®€åŒ–å¿…é¡»åœ¨è¢«æµ‹è¯•åŒ…å¤–è¿è¡Œçš„æµ‹è¯•ï¼Œ é™¤æ­¤ä¹‹å¤–åº”å°½é‡é¿å…ä½¿ç”¨ã€‚ï¼‰ä¾‹å¦‚ï¼Œ<code>bufio</code> åŒ…ä¸­çš„ç¼“å­˜è¯»å–å™¨ç±»å‹å«åš <code>Reader</code> è€Œé <code>BufReader</code>ï¼Œå› ä¸ºç”¨æˆ·å°†å®ƒçœ‹åš <code>bufio.Reader</code>ï¼Œè¿™æ˜¯ä¸ªæ¸…æ¥šè€Œç®€æ´çš„åç§°ã€‚ æ­¤å¤–ï¼Œç”±äºè¢«å¯¼å…¥çš„é¡¹æ€»æ˜¯é€šè¿‡å®ƒä»¬çš„åŒ…åæ¥ç¡®å®šï¼Œå› æ­¤ <code>bufio.Reader</code> ä¸ä¼šä¸ <code>io.Reader</code> å‘ç”Ÿå†²çªã€‚åŒæ ·ï¼Œç”¨äºåˆ›å»º <code>ring.Ring</code> çš„æ–°å®ä¾‹çš„å‡½æ•°ï¼ˆè¿™å°±æ˜¯ Go ä¸­çš„<strong>æ„é€ å‡½æ•°</strong>ï¼‰ä¸€èˆ¬ä¼šç§°ä¹‹ä¸º <code>NewRing</code>ï¼Œä½†ç”±äº <code>Ring</code> æ˜¯è¯¥åŒ…æ‰€å¯¼å‡ºçš„å”¯ä¸€ç±»å‹ï¼Œä¸”è¯¥åŒ…ä¹Ÿå« <code>ring</code>ï¼Œå› æ­¤å®ƒå¯ä»¥åªå«åš <code>New</code>ï¼Œå®ƒè·Ÿåœ¨åŒ…çš„åé¢ï¼Œå°±åƒ <code>ring.New</code>ã€‚ä½¿ç”¨åŒ…ç»“æ„å¯ä»¥å¸®åŠ©ä½ é€‰æ‹©å¥½çš„åç§°ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-paginate="true" data-theme="default" data-marpit-pagination="30" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å¦ä¸€ä¸ªç®€çŸ­çš„ä¾‹å­æ˜¯ <code>once.Do</code>ï¼Œ<code>once.Do(setup)</code> è¡¨è¿°è¶³å¤Ÿæ¸…æ™°ï¼Œ ä½¿ç”¨ <code>once.DoOrWaitUntilDone(setup)</code> å®Œå…¨å°±æ˜¯ç”»è›‡æ·»è¶³ã€‚ é•¿å‘½åå¹¶ä¸ä¼šä½¿å…¶æ›´å…·å¯è¯»æ€§ã€‚ä¸€ä»½æœ‰ç”¨çš„è¯´æ˜æ–‡æ¡£é€šå¸¸æ¯”é¢å¤–çš„é•¿åæ›´æœ‰ä»·å€¼ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="31" data-paginate="true" data-theme="default" data-marpit-pagination="31" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>è·å–å™¨</h3>
<p>Go å¹¶ä¸å¯¹è·å–å™¨ï¼ˆgetterï¼‰å’Œè®¾ç½®å™¨ï¼ˆsetterï¼‰æä¾›è‡ªåŠ¨æ”¯æŒã€‚ ä½ åº”å½“è‡ªå·±æä¾›è·å–å™¨å’Œè®¾ç½®å™¨ï¼Œé€šå¸¸å¾ˆå€¼å¾—è¿™æ ·åšï¼Œä½†è‹¥è¦å°† <code>Get</code> æ”¾åˆ°è·å–å™¨çš„åå­—ä¸­ï¼Œæ—¢ä¸ç¬¦åˆä¹ æƒ¯ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦ã€‚è‹¥ä½ æœ‰ä¸ªåä¸º <code>owner</code> ï¼ˆå°å†™ï¼Œæœªå¯¼å‡ºï¼‰çš„å­—æ®µï¼Œå…¶è·å–å™¨åº”å½“åä¸º <code>Owner</code>ï¼ˆå¤§å†™ï¼Œå¯å¯¼å‡ºï¼‰è€Œé <code>GetOwner</code>ã€‚å¤§å†™å­—æ¯å³ä¸ºå¯å¯¼å‡ºçš„è¿™ç§è§„å®šä¸ºåŒºåˆ†æ–¹æ³•å’Œå­—æ®µæä¾›äº†ä¾¿åˆ©ã€‚ è‹¥è¦æä¾›è®¾ç½®å™¨æ–¹æ³•ï¼Œ<code>SetOwner</code> æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ä¸¤ä¸ªå‘½åçœ‹èµ·æ¥éƒ½å¾ˆåˆç†ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>owner := obj.Owner()
<span class="hljs-keyword">if</span> owner != user {
    obj.SetOwner(user)
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="32" data-paginate="true" data-theme="default" data-marpit-pagination="32" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>æ¥å£å‘½å</h3>
<p>æŒ‰ç…§çº¦å®šï¼ŒåªåŒ…å«ä¸€ä¸ªæ–¹æ³•çš„æ¥å£åº”å½“ä»¥è¯¥æ–¹æ³•çš„åç§°åŠ ä¸Š - er åç¼€æ¥å‘½åï¼Œå¦‚ <code>Reader</code>ã€<code>Writer</code>ã€ <code>Formatter</code>ã€<code>CloseNotifier</code> ç­‰ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="33" data-paginate="true" data-theme="default" data-marpit-pagination="33" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¯¸å¦‚æ­¤ç±»çš„å‘½åæœ‰å¾ˆå¤šï¼Œéµå¾ªå®ƒä»¬åŠå…¶ä»£è¡¨çš„å‡½æ•°åä¼šè®©äº‹æƒ…å˜å¾—ç®€å•ã€‚ <code>Read</code>ã€<code>Write</code>ã€<code>Close</code>ã€<code>Flush</code>ã€ <code>String</code> ç­‰éƒ½å…·æœ‰å…¸å‹çš„ç­¾åå’Œæ„ä¹‰ã€‚ä¸ºé¿å…å†²çªï¼Œè¯·ä¸è¦ç”¨è¿™äº›åç§°ä¸ºä½ çš„æ–¹æ³•å‘½åï¼Œ é™¤éä½ æ˜ç¡®çŸ¥é“å®ƒä»¬çš„ç­¾åå’Œæ„ä¹‰ç›¸åŒã€‚åä¹‹ï¼Œè‹¥ä½ çš„ç±»å‹å®ç°äº†çš„æ–¹æ³•ï¼Œ ä¸ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ç±»å‹çš„æ–¹æ³•æ‹¥æœ‰ç›¸åŒçš„å«ä¹‰ï¼Œé‚£å°±ä½¿ç”¨ç›¸åŒçš„å‘½åã€‚ è¯·å°†å­—ç¬¦ä¸²è½¬æ¢æ–¹æ³•å‘½åä¸º <code>String</code> è€Œé <code>ToString</code>ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="34" data-paginate="true" data-theme="default" data-marpit-pagination="34" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>é©¼å³° å‘½å</h3>
<p>æœ€åï¼ŒGo ä¸­çš„çº¦å®šæ˜¯ä½¿ç”¨ <code>MixedCaps</code> æˆ– <code>mixedCaps</code> è€Œä¸æ˜¯ä¸‹åˆ’çº¿æ¥ç¼–å†™å¤šä¸ªå•è¯ç»„æˆçš„å‘½åã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="35" data-paginate="true" data-theme="default" data-marpit-pagination="35" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>åˆ†å·</h2>
<p>å’Œ C ä¸€æ ·ï¼ŒGo çš„æ­£å¼è¯­æ³•ä½¿ç”¨åˆ†å·æ¥ç»“æŸè¯­å¥ï¼›å’Œ C ä¸åŒçš„æ˜¯ï¼Œè¿™äº›åˆ†å·å¹¶ä¸åœ¨æºç ä¸­å‡ºç°ã€‚ å–è€Œä»£ä¹‹ï¼Œè¯æ³•åˆ†æå™¨ä¼šä½¿ç”¨ä¸€æ¡ç®€å•çš„è§„åˆ™æ¥è‡ªåŠ¨æ’å…¥åˆ†å·ï¼Œå› æ­¤æºç ä¸­åŸºæœ¬å°±ä¸ç”¨åˆ†å·äº†ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="36" data-paginate="true" data-theme="default" data-marpit-pagination="36" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è§„åˆ™æ˜¯è¿™æ ·çš„ï¼šè‹¥åœ¨æ–°è¡Œå‰çš„æœ€åä¸€ä¸ªæ ‡è®°ä¸ºæ ‡è¯†ç¬¦ï¼ˆåŒ…æ‹¬ <code>int</code> å’Œ <code>float64</code> è¿™ç±»çš„å•è¯ï¼‰ã€æ•°å€¼æˆ–å­—ç¬¦ä¸²å¸¸é‡ä¹‹ç±»çš„åŸºæœ¬å­—é¢æˆ–ä»¥ä¸‹æ ‡è®°ä¹‹ä¸€</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">break</span> <span class="hljs-keyword">continue</span> <span class="hljs-keyword">fallthrough</span> <span class="hljs-keyword">return</span> ++ -- ) }
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="37" data-paginate="true" data-theme="default" data-marpit-pagination="37" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åˆ™è¯æ³•åˆ†æå°†å§‹ç»ˆåœ¨è¯¥æ ‡è®°åé¢æ’å…¥åˆ†å·ã€‚è¿™ç‚¹å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š â€œå¦‚æœæ–°è¡Œå‰çš„æ ‡è®°ä¸ºè¯­å¥çš„æœ«å°¾ï¼Œåˆ™æ’å…¥åˆ†å·â€ã€‚</p>
<p>åˆ†å·ä¹Ÿå¯åœ¨é—­æ‹¬å·ä¹‹å‰ç›´æ¥çœç•¥ï¼Œå› æ­¤åƒ</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> { <span class="hljs-keyword">for</span> { dst &lt;- &lt;-src } }()
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="38" data-paginate="true" data-theme="default" data-marpit-pagination="38" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¿™æ ·çš„è¯­å¥æ— éœ€åˆ†å·ã€‚é€šå¸¸ Go ç¨‹åºåªåœ¨è¯¸å¦‚ <code>for</code> å¾ªç¯å­å¥è¿™æ ·çš„åœ°æ–¹ä½¿ç”¨åˆ†å·ï¼Œ ä»¥æ­¤æ¥å°†åˆå§‹åŒ–å™¨ã€æ¡ä»¶åŠå¢é‡å…ƒç´ åˆ†å¼€ã€‚å¦‚æœä½ åœ¨ä¸€è¡Œä¸­å†™å¤šä¸ªè¯­å¥ï¼Œä¹Ÿéœ€è¦ç”¨åˆ†å·éš”å¼€ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="39" data-paginate="true" data-theme="default" data-marpit-pagination="39" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è­¦å‘Šï¼šæ— è®ºå¦‚ä½•ï¼Œä½ éƒ½ä¸åº”å°†ä¸€ä¸ªæ§åˆ¶ç»“æ„ï¼ˆ<code>if</code>ã€<code>for</code>ã€<code>switch</code> æˆ– <code>select</code>ï¼‰çš„å·¦å¤§æ‹¬å·æ”¾åœ¨ä¸‹ä¸€è¡Œã€‚å¦‚æœè¿™æ ·åšï¼Œå°±ä¼šåœ¨å¤§æ‹¬å·å‰é¢æ’å…¥ä¸€ä¸ªåˆ†å·ï¼Œè¿™å¯èƒ½å¼•èµ·ä¸éœ€è¦çš„æ•ˆæœã€‚ ä½ åº”è¯¥è¿™æ ·å†™</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> i &lt; f() {
    g()
}
</span></span></foreignObject></svg></code></pre>
<p>è€Œä¸æ˜¯è¿™æ ·å†™</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> i &lt; f()  <span class="hljs-comment">// é”™è¯¯ï¼</span>
{           <span class="hljs-comment">//  é”™è¯¯ï¼</span>
    g()
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="40" data-paginate="true" data-theme="default" data-marpit-pagination="40" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>æ§åˆ¶ç»“æ„</h2>
<p>Go ä¸­çš„ç»“æ„æ§åˆ¶ä¸ C æœ‰è®¸å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†å…¶ä¸åŒä¹‹å¤„æ‰æ˜¯ç‹¬åˆ°ä¹‹å¤„ã€‚ Go ä¸å†ä½¿ç”¨ <code>do</code> æˆ– <code>while</code> å¾ªç¯ï¼Œåªæœ‰ä¸€ä¸ªæ›´é€šç”¨çš„ <code>for</code>ï¼›<code>switch</code> è¦æ›´çµæ´»ä¸€ç‚¹ï¼›<code>if</code> å’Œ <code>switch</code> åƒ <code>for</code> ä¸€æ ·å¯æ¥å—å¯é€‰çš„åˆå§‹åŒ–è¯­å¥ï¼› æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåŒ…å«ç±»å‹é€‰æ‹©å’Œå¤šè·¯é€šä¿¡å¤ç”¨å™¨çš„æ–°æ§åˆ¶ç»“æ„ï¼š<code>select</code>ã€‚ å…¶è¯­æ³•ä¹Ÿæœ‰äº›è®¸ä¸åŒï¼šæ²¡æœ‰åœ†æ‹¬å·ï¼Œè€Œå…¶ä¸»ä½“å¿…é¡»å§‹ç»ˆä½¿ç”¨å¤§æ‹¬å·æ‹¬ä½ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="41" data-paginate="true" data-theme="default" data-marpit-pagination="41" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>If</h3>
<p>åœ¨ Go ä¸­ï¼Œä¸€ä¸ªç®€å•çš„ <code>if</code> è¯­å¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> {
    <span class="hljs-keyword">return</span> y
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="42" data-paginate="true" data-theme="default" data-marpit-pagination="42" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å¼ºåˆ¶çš„å¤§æ‹¬å·ä¿ƒä½¿ä½ å°†ç®€å•çš„ <code>if</code> è¯­å¥åˆ†æˆå¤šè¡Œã€‚ç‰¹åˆ«æ˜¯åœ¨ä¸»ä½“ä¸­åŒ…å« <code>return</code> æˆ– <code>break</code> ç­‰æ§åˆ¶è¯­å¥æ—¶ï¼Œè¿™ç§ç¼–ç é£æ ¼çš„å¥½å¤„ä¸€æ¯”ä¾¿çŸ¥ã€‚</p>
<p>ç”±äº <code>if</code> å’Œ <code>switch</code> å¯æ¥å—åˆå§‹åŒ–è¯­å¥ï¼Œ å› æ­¤ç”¨å®ƒä»¬æ¥è®¾ç½®å±€éƒ¨å˜é‡ååˆ†å¸¸è§ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> err := file.Chmod(<span class="hljs-number">0664</span>); err != <span class="hljs-literal">nil</span> {
    log.Print(err)
    <span class="hljs-keyword">return</span> err
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="43" data-paginate="true" data-theme="default" data-marpit-pagination="43" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åœ¨ Go çš„åº“ä¸­ï¼Œä½ ä¼šå‘ç°è‹¥ <code>if</code> è¯­å¥ä¸ä¼šæ‰§è¡Œåˆ°ä¸‹ä¸€æ¡è¯­å¥æ—¶ï¼Œäº¦å³å…¶æ‰§è¡Œä½“ ä»¥ <code>break</code>ã€<code>continue</code>ã€<code>goto</code> æˆ– <code>return</code> ç»“æŸæ—¶ï¼Œä¸å¿…è¦çš„ <code>else</code> ä¼šè¢«çœç•¥ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>f, err := os.Open(name)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    <span class="hljs-keyword">return</span> err
}
codeUsing(f)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="44" data-paginate="true" data-theme="default" data-marpit-pagination="44" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ä¸‹ä¾‹æ˜¯ä¸€ç§å¸¸è§çš„æƒ…å†µï¼Œä»£ç å¿…é¡»é˜²èŒƒä¸€ç³»åˆ—çš„é”™è¯¯æ¡ä»¶ã€‚è‹¥æ§åˆ¶æµæˆåŠŸç»§ç»­ï¼Œ åˆ™è¯´æ˜ç¨‹åºå·²æ’é™¤é”™è¯¯ã€‚ç”±äºå‡ºé”™æ—¶å°†ä»¥ <code>return</code> ç»“æŸï¼Œ ä¹‹åçš„ä»£ç ä¹Ÿå°±æ— éœ€ <code>else</code> äº†ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>f, err := os.Open(name)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    <span class="hljs-keyword">return</span> err
}
d, err := f.Stat()
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    f.Close()
    <span class="hljs-keyword">return</span> err
}
codeUsing(f, d)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="45" data-paginate="true" data-theme="default" data-marpit-pagination="45" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>å£°æ˜å’Œåˆ†é…</h3>
<p>é¢˜å¤–è¯ï¼šä¸Šä¸€èŠ‚ä¸­æœ€åä¸€ä¸ªç¤ºä¾‹å±•ç¤ºäº†çŸ­å£°æ˜ := å¦‚ä½•ä½¿ç”¨ã€‚ è°ƒç”¨äº† os.Open çš„å£°æ˜ä¸º</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>f, err := os.Open(name)
</span></span></foreignObject></svg></code></pre>
<p>è¯¥è¯­å¥å£°æ˜äº†ä¸¤ä¸ªå˜é‡ f å’Œ errã€‚åœ¨å‡ è¡Œä¹‹åï¼Œåˆé€šè¿‡ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>d, err := f.Stat()
</span></span></foreignObject></svg></code></pre>
<p>è°ƒç”¨äº† <code>f.Stat</code>ã€‚å®ƒçœ‹èµ·æ¥ä¼¼ä¹æ˜¯å£°æ˜äº† <code>d</code> å’Œ <code>err</code>ã€‚ æ³¨æ„ï¼Œå°½ç®¡ä¸¤ä¸ªè¯­å¥ä¸­éƒ½å‡ºç°äº† <code>err</code>ï¼Œä½†è¿™ç§é‡å¤ä»ç„¶æ˜¯åˆæ³•çš„ï¼š<code>err</code> åœ¨ç¬¬ä¸€æ¡è¯­å¥ä¸­è¢«å£°æ˜ï¼Œä½†åœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­åªæ˜¯è¢«<strong>å†æ¬¡èµ‹å€¼</strong>ç½¢äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒç”¨ <code>f.Stat</code> ä½¿ç”¨çš„æ˜¯å‰é¢å·²ç»å£°æ˜çš„ <code>err</code>ï¼Œå®ƒåªæ˜¯è¢«é‡æ–°èµ‹å€¼äº†è€Œå·²ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="46" data-paginate="true" data-theme="default" data-marpit-pagination="46" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åœ¨æ»¡è¶³ä¸‹åˆ—æ¡ä»¶æ—¶ï¼Œå·²è¢«å£°æ˜çš„å˜é‡ <code>v</code> å¯å‡ºç°åœ¨<code>:=</code> å£°æ˜ä¸­ï¼š</p>
<ul>
<li>æœ¬æ¬¡å£°æ˜ä¸å·²å£°æ˜çš„ <code>v</code> å¤„äºåŒä¸€ä½œç”¨åŸŸä¸­ï¼ˆè‹¥ <code>v</code> å·²åœ¨å¤–å±‚ä½œç”¨åŸŸä¸­å£°æ˜è¿‡ï¼Œåˆ™æ­¤æ¬¡å£°æ˜ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡ Â§ï¼‰ï¼Œ</li>
<li>åœ¨åˆå§‹åŒ–ä¸­ä¸å…¶ç±»å‹ç›¸åº”çš„å€¼æ‰èƒ½èµ‹äºˆ <code>v</code>ï¼Œä¸”</li>
<li>åœ¨æ­¤æ¬¡å£°æ˜ä¸­è‡³å°‘å¦æœ‰ä¸€ä¸ªå˜é‡æ˜¯æ–°å£°æ˜çš„ã€‚</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="47" data-paginate="true" data-theme="default" data-marpit-pagination="47" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¿™ä¸ªç‰¹æ€§ç®€ç›´å°±æ˜¯çº¯ç²¹çš„å®ç”¨ä¸»ä¹‰ä½“ç°ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åªä½¿ç”¨ä¸€ä¸ª <code>err</code> å€¼ï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç›¸å½“é•¿çš„ <code>if-else</code> è¯­å¥é“¾ä¸­ï¼Œ ä½ ä¼šå‘ç°å®ƒç”¨å¾—å¾ˆé¢‘ç¹ã€‚</p>
<p>Â§ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå³ä¾¿ Go ä¸­çš„å‡½æ•°å½¢å‚å’Œè¿”å›å€¼åœ¨è¯æ³•ä¸Šå¤„äºå¤§æ‹¬å·ä¹‹å¤–ï¼Œ ä½†å®ƒä»¬çš„ä½œç”¨åŸŸå’Œè¯¥å‡½æ•°ä½“ä»ç„¶ç›¸åŒã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="48" data-paginate="true" data-theme="default" data-marpit-pagination="48" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>For</h3>
<p>Go çš„ <code>for</code> å¾ªç¯ç±»ä¼¼äº Cï¼Œä½†å´ä¸å°½ç›¸åŒã€‚å®ƒç»Ÿä¸€äº† <code>for</code> å’Œ <code>while</code>ï¼Œä¸å†æœ‰ <code>do-while</code> äº†ã€‚å®ƒæœ‰ä¸‰ç§å½¢å¼ï¼Œä½†åªæœ‰ä¸€ç§éœ€è¦åˆ†å·ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// ç±»ä¼¼ C è¯­è¨€ä¸­çš„ for ç”¨æ³•</span>
<span class="hljs-keyword">for</span> init; condition; post { }

<span class="hljs-comment">// ç±»ä¼¼ C è¯­è¨€ä¸­çš„ while ç”¨æ³•</span>
<span class="hljs-keyword">for</span> condition { }

<span class="hljs-comment">// ç±»ä¼¼ C è¯­è¨€ä¸­çš„ for(;;) ç”¨æ³•</span>
<span class="hljs-keyword">for</span> { }
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="49" data-paginate="true" data-theme="default" data-marpit-pagination="49" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ç®€çŸ­å£°æ˜èƒ½è®©æˆ‘ä»¬æ›´å®¹æ˜“åœ¨å¾ªç¯ä¸­å£°æ˜ä¸‹æ ‡å˜é‡ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>sum := <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ {
    sum += i
}
</span></span></foreignObject></svg></code></pre>
<p>è‹¥ä½ æƒ³éå†æ•°ç»„ã€åˆ‡ç‰‡ã€å­—ç¬¦ä¸²æˆ–è€…æ˜ å°„ï¼Œæˆ–ä»ä¿¡é“ä¸­è¯»å–æ¶ˆæ¯ï¼Œ <code>range</code> å­å¥èƒ½å¤Ÿå¸®ä½ è½»æ¾å®ç°å¾ªç¯ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">for</span> key, value := <span class="hljs-keyword">range</span> oldMap {
    newMap[key] = value
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="50" data-paginate="true" data-theme="default" data-marpit-pagination="50" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥ä½ åªéœ€è¦è¯¥éå†ä¸­çš„ç¬¬ä¸€ä¸ªé¡¹ï¼ˆé”®æˆ–ä¸‹æ ‡ï¼‰ï¼Œå»æ‰ç¬¬äºŒä¸ªå°±è¡Œäº†ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">for</span> key := <span class="hljs-keyword">range</span> m {
    <span class="hljs-keyword">if</span> key.expired() {
        <span class="hljs-built_in">delete</span>(m, key)
    }
}
</span></span></foreignObject></svg></code></pre>
<p>è‹¥ä½ åªéœ€è¦è¯¥éå†ä¸­çš„ç¬¬äºŒä¸ªé¡¹ï¼ˆå€¼ï¼‰ï¼Œè¯·ä½¿ç”¨<strong>ç©ºç™½æ ‡è¯†ç¬¦</strong>ï¼Œå³ä¸‹åˆ’çº¿æ¥ä¸¢å¼ƒç¬¬ä¸€ä¸ªå€¼ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>sum := <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> _, value := <span class="hljs-keyword">range</span> array {
    sum += value
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="51" data-paginate="true" data-theme="default" data-marpit-pagination="51" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ç©ºç™½æ ‡è¯†ç¬¦è¿˜æœ‰å¤šç§ç”¨æ³•ï¼Œå®ƒä¼šåœ¨åé¢çš„å°èŠ‚ä¸­æè¿°ã€‚</p>
<p>å¯¹äºå­—ç¬¦ä¸²ï¼Œ<code>range</code> èƒ½å¤Ÿæä¾›æ›´å¤šä¾¿åˆ©ã€‚å®ƒèƒ½é€šè¿‡è§£æ UTF-8ï¼Œ å°†æ¯ä¸ªç‹¬ç«‹çš„ Unicode ç ç‚¹åˆ†ç¦»å‡ºæ¥ã€‚é”™è¯¯çš„ç¼–ç å°†å ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶ä»¥ç¬¦æ–‡ <code>U+FFFD</code> æ¥ä»£æ›¿ã€‚ ï¼ˆåç§° â€œç¬¦æ–‡â€ å’Œå†…å»ºç±»å‹ <code>rune</code> æ˜¯ Go å¯¹å•ä¸ª Unicode ç ç‚¹çš„æˆç§°è°“ã€‚ è¯¦æƒ…è§<a href="https://golang.org/ref/spec#Rune_literals">è¯­è¨€è§„èŒƒ</a>ï¼‰ã€‚å¾ªç¯</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">for</span> pos, char := <span class="hljs-keyword">range</span> <span class="hljs-string">"æ—¥æœ¬\x80èª"</span> { <span class="hljs-comment">// \x80 åœ¨ UTF-8 ç¼–ç ä¸­æ˜¯ä¸€ä¸ªéæ³•å­—ç¬¦</span>
    fmt.Printf(<span class="hljs-string">"character %#U starts at byte position %d\n"</span>, char, pos)
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="52" data-paginate="true" data-theme="default" data-marpit-pagination="52" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ‰“å°ç»“æœï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>character U+<span class="hljs-number">65E5</span> <span class="hljs-string">'æ—¥'</span> starts at <span class="hljs-keyword">byte</span> position <span class="hljs-number">0</span>
character U+<span class="hljs-number">672</span>C <span class="hljs-string">'æœ¬'</span> starts at <span class="hljs-keyword">byte</span> position <span class="hljs-number">3</span>
character U+FFFD <span class="hljs-string">'ï¿½'</span> starts at <span class="hljs-keyword">byte</span> position <span class="hljs-number">6</span>
character U+<span class="hljs-number">8</span>A9E <span class="hljs-string">'èª'</span> starts at <span class="hljs-keyword">byte</span> position <span class="hljs-number">7</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="53" data-paginate="true" data-theme="default" data-marpit-pagination="53" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æœ€åï¼ŒGo æ²¡æœ‰é€—å·æ“ä½œç¬¦ï¼Œè€Œ <code>++</code> å’Œ <code>--</code> ä¸ºè¯­å¥è€Œéè¡¨è¾¾å¼ã€‚ å› æ­¤ï¼Œè‹¥ä½ æƒ³è¦åœ¨ <code>for</code> ä¸­ä½¿ç”¨å¤šä¸ªå˜é‡ï¼Œåº”é‡‡ç”¨å¹³è¡Œèµ‹å€¼çš„æ–¹å¼ ï¼ˆå› ä¸ºå®ƒä¼šæ‹’ç» <code>++</code> å’Œ <code>--</code>ï¼‰.</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// Reverse a</span>
<span class="hljs-keyword">for</span> i, j := <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(a)<span class="hljs-number">-1</span>; i &lt; j; i, j = i+<span class="hljs-number">1</span>, j<span class="hljs-number">-1</span> {
    a[i], a[j] = a[j], a[i]
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="54" data-paginate="true" data-theme="default" data-marpit-pagination="54" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>Switch</h3>
<p>Go çš„ <code>switch</code> æ¯” C çš„æ›´é€šç”¨ã€‚å…¶è¡¨è¾¾å¼æ— éœ€ä¸ºå¸¸é‡æˆ–æ•´æ•°ï¼Œ<code>case</code> è¯­å¥ä¼šè‡ªä¸Šè€Œä¸‹é€ä¸€è¿›è¡Œæ±‚å€¼ç›´åˆ°åŒ¹é…ä¸ºæ­¢ã€‚è‹¥ <code>switch</code> åé¢æ²¡æœ‰è¡¨è¾¾å¼ï¼Œå®ƒå°†åŒ¹é… <code>true</code>ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°† <code>if-else-if-else</code> é“¾å†™æˆä¸€ä¸ª <code>switch</code>ï¼Œè¿™ä¹Ÿæ›´ç¬¦åˆ Go çš„é£æ ¼ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">unhex</span><span class="hljs-params">(c <span class="hljs-keyword">byte</span>)</span> <span class="hljs-title">byte</span></span> {
    <span class="hljs-keyword">switch</span> {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'0'</span> &lt;= c &amp;&amp; c &lt;= <span class="hljs-string">'9'</span>:
        <span class="hljs-keyword">return</span> c - <span class="hljs-string">'0'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'a'</span> &lt;= c &amp;&amp; c &lt;= <span class="hljs-string">'f'</span>:
        <span class="hljs-keyword">return</span> c - <span class="hljs-string">'a'</span> + <span class="hljs-number">10</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'A'</span> &lt;= c &amp;&amp; c &lt;= <span class="hljs-string">'F'</span>:
        <span class="hljs-keyword">return</span> c - <span class="hljs-string">'A'</span> + <span class="hljs-number">10</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="55" data-paginate="true" data-theme="default" data-marpit-pagination="55" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><code>switch</code> å¹¶ä¸ä¼šè‡ªåŠ¨ä¸‹æº¯ï¼Œä½† <code>case</code> å¯é€šè¿‡é€—å·åˆ†éš”æ¥åˆ—ä¸¾ç›¸åŒçš„å¤„ç†æ¡ä»¶ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">shouldEscape</span><span class="hljs-params">(c <span class="hljs-keyword">byte</span>)</span> <span class="hljs-title">bool</span></span> {
    <span class="hljs-keyword">switch</span> c {
    <span class="hljs-keyword">case</span> <span class="hljs-string">' '</span>, <span class="hljs-string">'?'</span>, <span class="hljs-string">'&amp;'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'#'</span>, <span class="hljs-string">'+'</span>, <span class="hljs-string">'%'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="56" data-paginate="true" data-theme="default" data-marpit-pagination="56" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å°½ç®¡å®ƒä»¬åœ¨ Go ä¸­çš„ç”¨æ³•å’Œå…¶å®ƒç±» C è¯­è¨€å·®ä¸å¤šï¼Œä½† <code>break</code> è¯­å¥å¯ä»¥ä½¿ <code>switch</code> æå‰ç»ˆæ­¢ã€‚ä¸ä»…æ˜¯ <code>switch</code>ï¼Œ æœ‰æ—¶å€™ä¹Ÿå¿…é¡»æ‰“ç ´å±‚å±‚çš„å¾ªç¯ã€‚åœ¨ Go ä¸­ï¼Œæˆ‘ä»¬åªéœ€å°†æ ‡ç­¾æ”¾ç½®åˆ°å¾ªç¯å¤–ï¼Œç„¶å â€œè¹¦â€ åˆ°é‚£é‡Œå³å¯ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†äºŒè€…çš„ç”¨æ³•ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>Loop:
    <span class="hljs-keyword">for</span> n := <span class="hljs-number">0</span>; n &lt; <span class="hljs-built_in">len</span>(src); n += size {
        <span class="hljs-keyword">switch</span> {
        <span class="hljs-keyword">case</span> src[n] &lt; sizeOne:
            <span class="hljs-keyword">if</span> validateOnly {
                <span class="hljs-keyword">break</span>
            }
            size = <span class="hljs-number">1</span>
            update(src[n])

        <span class="hljs-keyword">case</span> src[n] &lt; sizeTwo:
            <span class="hljs-keyword">if</span> n+<span class="hljs-number">1</span> &gt;= <span class="hljs-built_in">len</span>(src) {
                err = errShortInput
                <span class="hljs-keyword">break</span> Loop
            }
            <span class="hljs-keyword">if</span> validateOnly {
                <span class="hljs-keyword">break</span>
            }
            size = <span class="hljs-number">2</span>
            update(src[n] + src[n+<span class="hljs-number">1</span>]&lt;&lt;shift)
        }
    }
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="57" data-paginate="true" data-theme="default" data-marpit-pagination="57" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å½“ç„¶ï¼Œ<code>continue</code> è¯­å¥ä¹Ÿèƒ½æ¥å—ä¸€ä¸ªå¯é€‰çš„æ ‡ç­¾ï¼Œä¸è¿‡å®ƒåªèƒ½åœ¨å¾ªç¯ä¸­ä½¿ç”¨ã€‚</p>
<p>ä½œä¸ºè¿™ä¸€èŠ‚çš„ç»“æŸï¼Œæ­¤ç¨‹åºé€šè¿‡ä½¿ç”¨ä¸¤ä¸ª <code>switch</code> è¯­å¥å¯¹å­—èŠ‚æ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// æ¯”è¾ƒä¸¤ä¸ªå­—èŠ‚å‹åˆ‡ç‰‡ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°</span>
<span class="hljs-comment">// æŒ‰å­—å…¸é¡ºåº.</span>
<span class="hljs-comment">// å¦‚æœa == bï¼Œç»“æœä¸º0ï¼›å¦‚æœa &lt; bï¼Œç»“æœä¸º-1ï¼›å¦‚æœa &gt; bï¼Œç»“æœä¸º+1</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Compare</span><span class="hljs-params">(a, b []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-title">int</span></span> {
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(a) &amp;&amp; i &lt; <span class="hljs-built_in">len</span>(b); i++ {
        <span class="hljs-keyword">switch</span> {
        <span class="hljs-keyword">case</span> a[i] &gt; b[i]:
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">case</span> a[i] &lt; b[i]:
            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
        }
    }
    <span class="hljs-keyword">switch</span> {
    <span class="hljs-keyword">case</span> <span class="hljs-built_in">len</span>(a) &gt; <span class="hljs-built_in">len</span>(b):
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">case</span> <span class="hljs-built_in">len</span>(a) &lt; <span class="hljs-built_in">len</span>(b):
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="58" data-paginate="true" data-theme="default" data-marpit-pagination="58" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>ç±»å‹é€‰æ‹©</h3>
<p><code>switch</code> ä¹Ÿå¯ç”¨äºåˆ¤æ–­æ¥å£å˜é‡çš„åŠ¨æ€ç±»å‹ã€‚å¦‚ <strong>ç±»å‹é€‰æ‹©</strong> é€šè¿‡åœ†æ‹¬å·ä¸­çš„å…³é”®å­— <code>type</code> ä½¿ç”¨ç±»å‹æ–­è¨€è¯­æ³•ã€‚è‹¥ <code>switch</code> åœ¨è¡¨è¾¾å¼ä¸­å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¯¥å˜é‡çš„æ¯ä¸ªå­å¥ä¸­éƒ½å°†æœ‰è¯¥å˜é‡å¯¹åº”çš„ç±»å‹ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> t <span class="hljs-keyword">interface</span>{}
t = functionOfSomeType()
<span class="hljs-keyword">switch</span> t := t.(<span class="hljs-keyword">type</span>) {
<span class="hljs-keyword">default</span>:
    fmt.Printf(<span class="hljs-string">"unexpected type %T\n"</span>, t)     <span class="hljs-comment">// %T æ‰“å°ä»»ä½•ç±»å‹çš„ t</span>
<span class="hljs-keyword">case</span> <span class="hljs-keyword">bool</span>:
    fmt.Printf(<span class="hljs-string">"boolean %t\n"</span>, t)             <span class="hljs-comment">// t æ˜¯ bool ç±»å‹</span>
<span class="hljs-keyword">case</span> <span class="hljs-keyword">int</span>:
    fmt.Printf(<span class="hljs-string">"integer %d\n"</span>, t)             <span class="hljs-comment">// t æ˜¯ int ç±»å‹</span>
<span class="hljs-keyword">case</span> *<span class="hljs-keyword">bool</span>:
    fmt.Printf(<span class="hljs-string">"pointer to boolean %t\n"</span>, *t) <span class="hljs-comment">// t æ˜¯ *bool ç±»å‹</span>
<span class="hljs-keyword">case</span> *<span class="hljs-keyword">int</span>:
    fmt.Printf(<span class="hljs-string">"pointer to integer %d\n"</span>, *t) <span class="hljs-comment">// t æ˜¯ *int ç±»å‹</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="59" data-paginate="true" data-theme="default" data-marpit-pagination="59" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>å‡½æ•°</h2>
<h3>å¤šè¿”å›å€¼</h3>
<p>Go ä¸ä¼—ä¸åŒçš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯å‡½æ•°å’Œæ–¹æ³•å¯è¿”å›å¤šä¸ªå€¼ã€‚è¿™ç§å½¢å¼å¯ä»¥æ”¹å–„ C ä¸­ä¸€äº›ç¬¨æ‹™çš„ä¹ æƒ¯ï¼š å°†é”™è¯¯å€¼è¿”å›ï¼ˆä¾‹å¦‚ç”¨ <code>-1</code> è¡¨ç¤º <code>EOF</code>ï¼‰å’Œä¿®æ”¹é€šè¿‡åœ°å€ä¼ å…¥çš„å®å‚ã€‚</p>
<p>åœ¨ C ä¸­ï¼Œå†™å…¥æ“ä½œå‘ç”Ÿçš„é”™è¯¯ä¼šç”¨ä¸€ä¸ªè´Ÿæ•°æ ‡è®°ï¼Œè€Œé”™è¯¯ç ä¼šéšè—åœ¨æŸä¸ªä¸ç¡®å®šçš„ä½ç½®ã€‚ è€Œåœ¨ Go ä¸­ï¼Œ<code>Write</code> ä¼šè¿”å›å†™å…¥çš„å­—èŠ‚æ•°<strong>ä»¥åŠ</strong>ä¸€ä¸ªé”™è¯¯ï¼š â€œæ˜¯çš„ï¼Œæ‚¨å†™å…¥äº†ä¸€äº›å­—èŠ‚ï¼Œä½†å¹¶æœªå…¨éƒ¨å†™å…¥ï¼Œå› ä¸ºè®¾å¤‡å·²æ»¡â€ã€‚ åœ¨ <code>os</code> åŒ…ä¸­ï¼Œ<code>File.Write</code> çš„ç­¾åä¸ºï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(file *File)</span> <span class="hljs-title">Write</span><span class="hljs-params">(b []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-params">(n <span class="hljs-keyword">int</span>, err error)</span></span>
</span></span></foreignObject></svg></code></pre>
<p>æ­£å¦‚æ–‡æ¡£æ‰€è¿°ï¼Œå®ƒè¿”å›å†™å…¥çš„å­—èŠ‚æ•°ï¼Œå¹¶åœ¨ <code>n != len(b)</code> æ—¶è¿”å›ä¸€ä¸ªé <code>nil</code> çš„ <code>error</code> é”™è¯¯å€¼ã€‚ è¿™æ˜¯ä¸€ç§å¸¸è§çš„ç¼–ç é£æ ¼ï¼Œæ›´å¤šç¤ºä¾‹è§é”™è¯¯å¤„ç†ä¸€èŠ‚ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="60" data-paginate="true" data-theme="default" data-marpit-pagination="60" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚æ¥é¿å…ä¸ºæ¨¡æ‹Ÿå¼•ç”¨å‚æ•°è€Œä¼ å…¥æŒ‡é’ˆã€‚ ä»¥ä¸‹ç®€å•çš„å‡½æ•°å¯ä»å­—èŠ‚æ•°ç»„ä¸­çš„ç‰¹å®šä½ç½®è·å–å…¶å€¼ï¼Œå¹¶è¿”å›è¯¥æ•°å€¼å’Œä¸‹ä¸€ä¸ªä½ç½®ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">nextInt</span><span class="hljs-params">(b []<span class="hljs-keyword">byte</span>, i <span class="hljs-keyword">int</span>)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span></span> {
    <span class="hljs-keyword">for</span> ; i &lt; <span class="hljs-built_in">len</span>(b) &amp;&amp; !isDigit(b[i]); i++ {
    }
    x := <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> ; i &lt; <span class="hljs-built_in">len</span>(b) &amp;&amp; isDigit(b[i]); i++ {
        x = x*<span class="hljs-number">10</span> + <span class="hljs-keyword">int</span>(b[i]) - <span class="hljs-string">'0'</span>
    }
    <span class="hljs-keyword">return</span> x, i
}
</span></span></foreignObject></svg></code></pre>
<p>ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼Œé€šè¿‡å®ƒæ‰«æè¾“å…¥çš„åˆ‡ç‰‡ <code>b</code> æ¥è·å–æ•°å­—ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(b); {
        x, i = nextInt(b, i)
        fmt.Println(x)
    }
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="61" data-paginate="true" data-theme="default" data-marpit-pagination="61" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>å‘½åç»“æœå‚æ•°</h3>
<p>Go å‡½æ•°çš„è¿”å›å€¼æˆ–ç»“æœ â€œå½¢å‚â€ å¯è¢«å‘½åï¼Œå¹¶ä½œä¸ºå¸¸è§„å˜é‡ä½¿ç”¨ï¼Œå°±åƒä¼ å…¥çš„å½¢å‚ä¸€æ ·ã€‚ å‘½ååï¼Œä¸€æ—¦è¯¥å‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œå®ƒä»¬å°±ä¼šè¢«åˆå§‹åŒ–ä¸ºä¸å…¶ç±»å‹ç›¸åº”çš„é›¶å€¼ï¼› è‹¥è¯¥å‡½æ•°æ‰§è¡Œäº†ä¸€æ¡ä¸å¸¦å®å‚çš„ <code>return</code> è¯­å¥ï¼Œåˆ™ç»“æœå½¢å‚çš„å½“å‰å€¼å°†è¢«è¿”å›ã€‚</p>
<p>æ­¤åç§°ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œä½†å®ƒä»¬èƒ½ä½¿ä»£ç æ›´åŠ ç®€çŸ­æ¸…æ™°ï¼šå®ƒä»¬å°±æ˜¯æ–‡æ¡£ã€‚è‹¥æˆ‘ä»¬å‘½åäº† <code>nextInt</code> çš„ç»“æœï¼Œé‚£ä¹ˆå®ƒè¿”å›çš„ <code>int</code> å°±å€¼å¦‚å…¶æ„äº†ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">nextInt</span><span class="hljs-params">(b []<span class="hljs-keyword">byte</span>, pos <span class="hljs-keyword">int</span>)</span> <span class="hljs-params">(value, nextPos <span class="hljs-keyword">int</span>)</span></span> {
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="62" data-paginate="true" data-theme="default" data-marpit-pagination="62" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ç”±äºè¢«å‘½åçš„ç»“æœå·²ç»åˆå§‹åŒ–ï¼Œä¸”å·²ç»å…³è”è‡³æ— å‚æ•°çš„è¿”å›ï¼Œå®ƒä»¬å°±èƒ½è®©ä»£ç ç®€å•è€Œæ¸…æ™°ã€‚ ä¸‹é¢çš„ <code>io.ReadFull</code> å°±æ˜¯ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ReadFull</span><span class="hljs-params">(r Reader, buf []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-params">(n <span class="hljs-keyword">int</span>, err error)</span></span> {
    <span class="hljs-keyword">for</span> <span class="hljs-built_in">len</span>(buf) &gt; <span class="hljs-number">0</span> &amp;&amp; err == <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">var</span> nr <span class="hljs-keyword">int</span>
        nr, err = r.Read(buf)
        n += nr
        buf = buf[nr:]
    }
    <span class="hljs-keyword">return</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="63" data-paginate="true" data-theme="default" data-marpit-pagination="63" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>å»¶è¿Ÿ <code>defer</code></h3>
<p>Go çš„ <code>defer</code> è¯­å¥ç”¨äºé¢„è®¾ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼ˆå³<strong>æ¨è¿Ÿæ‰§è¡Œ</strong>å‡½æ•°ï¼‰ï¼Œ è¯¥å‡½æ•°ä¼šåœ¨æ‰§è¡Œ <code>defer</code> çš„å‡½æ•°è¿”å›ä¹‹å‰ç«‹å³æ‰§è¡Œã€‚å®ƒæ˜¾å¾—éæ¯”å¯»å¸¸ï¼Œ ä½†å´æ˜¯å¤„ç†ä¸€äº›äº‹æƒ…çš„æœ‰æ•ˆæ–¹å¼ï¼Œä¾‹å¦‚æ— è®ºä»¥ä½•ç§è·¯å¾„è¿”å›ï¼Œéƒ½å¿…é¡»é‡Šæ”¾èµ„æºçš„å‡½æ•°ã€‚ å…¸å‹çš„ä¾‹å­å°±æ˜¯è§£é”äº’æ–¥å’Œå…³é—­æ–‡ä»¶ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// å†…å®¹è¿”å›æ–‡ä»¶çš„å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Contents</span><span class="hljs-params">(filename <span class="hljs-keyword">string</span>)</span> <span class="hljs-params">(<span class="hljs-keyword">string</span>, error)</span></span> {
    f, err := os.Open(filename)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
    }
    <span class="hljs-keyword">defer</span> f.Close()  <span class="hljs-comment">// æˆ‘ä»¬ç»“æŸåå°±å…³é—­äº†f</span>

    <span class="hljs-keyword">var</span> result []<span class="hljs-keyword">byte</span>
    buf := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">byte</span>, <span class="hljs-number">100</span>)
    <span class="hljs-keyword">for</span> {
        n, err := f.Read(buf[<span class="hljs-number">0</span>:])
        result = <span class="hljs-built_in">append</span>(result, buf[<span class="hljs-number">0</span>:n]...) <span class="hljs-comment">// appendç¨åè®¨è®ºã€‚</span>
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            <span class="hljs-keyword">if</span> err == io.EOF {
                <span class="hljs-keyword">break</span>
            }
            <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err  <span class="hljs-comment">// å¦‚æœæˆ‘ä»¬å›åˆ°è¿™é‡Œï¼Œfå°±å…³é—­äº†ã€‚</span>
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>(result), <span class="hljs-literal">nil</span> <span class="hljs-comment">// å¦‚æœæˆ‘ä»¬å›åˆ°è¿™é‡Œï¼Œfå°±å…³é—­äº†ã€‚</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="64" data-paginate="true" data-theme="default" data-marpit-pagination="64" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ¨è¿Ÿè¯¸å¦‚ <code>Close</code> ä¹‹ç±»çš„å‡½æ•°è°ƒç”¨æœ‰ä¸¤ç‚¹å¥½å¤„ï¼šç¬¬ä¸€ï¼Œ å®ƒèƒ½ç¡®ä¿ä½ ä¸ä¼šå¿˜è®°å…³é—­æ–‡ä»¶ã€‚å¦‚æœä½ ä»¥ååˆä¸ºè¯¥å‡½æ•°æ·»åŠ äº†æ–°çš„è¿”å›è·¯å¾„æ—¶ï¼Œ è¿™ç§æƒ…å†µå¾€å¾€å°±ä¼šå‘ç”Ÿã€‚ç¬¬äºŒï¼Œå®ƒæ„å‘³ç€ â€œå…³é—­â€ ç¦» â€œæ‰“å¼€â€ å¾ˆè¿‘ï¼Œ è¿™æ€»æ¯”å°†å®ƒæ”¾åœ¨å‡½æ•°ç»“å°¾å¤„è¦æ¸…æ™°æ˜äº†ã€‚</p>
<p>è¢«æ¨è¿Ÿå‡½æ•°çš„å®å‚ï¼ˆå¦‚æœè¯¥å‡½æ•°ä¸ºæ–¹æ³•åˆ™è¿˜åŒ…æ‹¬æ¥æ”¶è€…ï¼‰åœ¨<strong>æ¨è¿Ÿ</strong>æ‰§è¡Œæ—¶å°±ä¼šæ±‚å€¼ï¼Œ è€Œä¸æ˜¯åœ¨<strong>è°ƒç”¨</strong>æ‰§è¡Œæ—¶æ‰æ±‚å€¼ã€‚è¿™æ ·ä¸ä»…æ— éœ€æ‹…å¿ƒå˜é‡å€¼åœ¨å‡½æ•°æ‰§è¡Œæ—¶è¢«æ”¹å˜ï¼Œ åŒæ—¶è¿˜æ„å‘³ç€å•ä¸ªå·²æ¨è¿Ÿçš„è°ƒç”¨å¯æ¨è¿Ÿå¤šä¸ªå‡½æ•°çš„æ‰§è¡Œã€‚ä¸‹é¢æ˜¯ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ {
    <span class="hljs-keyword">defer</span> fmt.Printf(<span class="hljs-string">"%d "</span>, i)
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="65" data-paginate="true" data-theme="default" data-marpit-pagination="65" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¢«æ¨è¿Ÿçš„å‡½æ•°æŒ‰ç…§åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„é¡ºåºæ‰§è¡Œï¼Œå› æ­¤ä»¥ä¸Šä»£ç åœ¨å‡½æ•°è¿”å›æ—¶ä¼šæ‰“å° <code>4 3 2 1 0</code>ã€‚ä¸€ä¸ªæ›´å…·å®é™…æ„ä¹‰çš„ä¾‹å­æ˜¯é€šè¿‡ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œ ç”¨ç¨‹åºæ¥è·Ÿè¸ªå‡½æ•°çš„æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€å¯¹ç®€å•çš„è·Ÿè¸ªä¾‹ç¨‹ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">trace</span><span class="hljs-params">(s <span class="hljs-keyword">string</span>)</span></span>   { fmt.Println(<span class="hljs-string">"entering:"</span>, s) }
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">untrace</span><span class="hljs-params">(s <span class="hljs-keyword">string</span>)</span></span> { fmt.Println(<span class="hljs-string">"leaving:"</span>, s) }

<span class="hljs-comment">// Use them like this:</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">a</span><span class="hljs-params">()</span></span> {
    trace(<span class="hljs-string">"a"</span>)
    <span class="hljs-keyword">defer</span> untrace(<span class="hljs-string">"a"</span>)
    <span class="hljs-comment">// do something....</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="66" data-paginate="true" data-theme="default" data-marpit-pagination="66" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œå³è¢«æ¨è¿Ÿå‡½æ•°çš„å®å‚åœ¨ <code>defer</code> æ‰§è¡Œæ—¶æ‰ä¼šè¢«æ±‚å€¼ã€‚ è·Ÿè¸ªä¾‹ç¨‹å¯é’ˆå¯¹åè·Ÿè¸ªä¾‹ç¨‹è®¾ç½®å®å‚ã€‚ä»¥ä¸‹ä¾‹å­ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">trace</span><span class="hljs-params">(s <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">string</span></span> {
    fmt.Println(<span class="hljs-string">"entering:"</span>, s)
    <span class="hljs-keyword">return</span> s
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">un</span><span class="hljs-params">(s <span class="hljs-keyword">string</span>)</span></span> {
    fmt.Println(<span class="hljs-string">"leaving:"</span>, s)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">a</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">defer</span> un(trace(<span class="hljs-string">"a"</span>))
    fmt.Println(<span class="hljs-string">"in a"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">b</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">defer</span> un(trace(<span class="hljs-string">"b"</span>))
    fmt.Println(<span class="hljs-string">"in b"</span>)
    a()
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    b()
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="67" data-paginate="true" data-theme="default" data-marpit-pagination="67" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ä¼šæ‰“å°</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>entering: b
in b
entering: a
in a
leaving: a
leaving: b
</span></span></foreignObject></svg></code></pre>
<p>å¯¹äºä¹ æƒ¯å…¶å®ƒè¯­è¨€ä¸­å—çº§èµ„æºç®¡ç†çš„ç¨‹åºå‘˜ï¼Œ<code>defer</code> ä¼¼ä¹æœ‰ç‚¹æ€ªå¼‚ï¼Œ ä½†å®ƒæœ€æœ‰è¶£è€Œå¼ºå¤§çš„åº”ç”¨æ°æ°æ¥è‡ªäºå…¶åŸºäºå‡½æ•°è€Œéå—çš„ç‰¹ç‚¹ã€‚åœ¨ <code>panic</code> å’Œ <code>recover</code> è¿™ä¸¤èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å…³äºå®ƒå¯èƒ½æ€§çš„å…¶å®ƒä¾‹å­ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="68" data-paginate="true" data-theme="default" data-marpit-pagination="68" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>æ•°æ®</h2>
<h3>ä½¿ç”¨ new å…³é”®å­—åˆ†é…å†…å­˜</h3>
<p>Go æä¾›äº†ä¸¤ç§åˆ†é…åŸè¯­ï¼Œå³å†…å»ºå‡½æ•° <code>new</code> å’Œ <code>make</code>ã€‚ å®ƒä»¬æ‰€åšçš„äº‹æƒ…ä¸åŒï¼Œæ‰€åº”ç”¨çš„ç±»å‹ä¹Ÿä¸åŒã€‚å®ƒä»¬å¯èƒ½ä¼šå¼•èµ·æ··æ·†ï¼Œä½†è§„åˆ™å´å¾ˆç®€å•ã€‚ è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ <code>new</code>ã€‚è¿™æ˜¯ä¸ªç”¨æ¥åˆ†é…å†…å­˜çš„å†…å»ºå‡½æ•°ï¼Œ ä½†ä¸å…¶å®ƒè¯­è¨€ä¸­çš„åŒåå‡½æ•°ä¸åŒï¼Œå®ƒä¸ä¼š<strong>åˆå§‹åŒ–</strong>å†…å­˜ï¼Œåªä¼šå°†å†…å­˜<strong>ç½®é›¶</strong>ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>new(T)</code> ä¼šä¸ºç±»å‹ä¸º <code>T</code> çš„æ–°é¡¹åˆ†é…å·²ç½®é›¶çš„å†…å­˜ç©ºé—´ï¼Œ å¹¶è¿”å›å®ƒçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç±»å‹ä¸º <code>*T</code> çš„å€¼ã€‚ç”¨ Go çš„æœ¯è¯­æ¥è¯´ï¼Œå®ƒè¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼Œ è¯¥æŒ‡é’ˆæŒ‡å‘æ–°åˆ†é…çš„ï¼Œç±»å‹ä¸º <code>T</code> çš„é›¶å€¼ã€‚</p>
<p>æ—¢ç„¶ <code>new</code> è¿”å›çš„å†…å­˜å·²ç½®é›¶ï¼Œé‚£ä¹ˆå½“ä½ è®¾è®¡æ•°æ®ç»“æ„æ—¶ï¼Œ æ¯ç§ç±»å‹çš„é›¶å€¼å°±ä¸å¿…è¿›ä¸€æ­¥åˆå§‹åŒ–äº†ï¼Œè¿™æ„å‘³ç€è¯¥æ•°æ®ç»“æ„çš„ä½¿ç”¨è€…åªéœ€ç”¨ <code>new</code> åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å°±èƒ½æ­£å¸¸å·¥ä½œã€‚ä¾‹å¦‚ï¼Œ<code>bytes.Buffer</code> çš„æ–‡æ¡£ä¸­æåˆ° â€œé›¶å€¼çš„ <code>Buffer</code> å°±æ˜¯å·²å‡†å¤‡å°±ç»ªçš„ç¼“å†²åŒºã€‚â€ åŒæ ·ï¼Œ<code>sync.Mutex</code> å¹¶æ²¡æœ‰æ˜¾å¼çš„æ„é€ å‡½æ•°æˆ– <code>Init</code> æ–¹æ³•ï¼Œ è€Œæ˜¯é›¶å€¼çš„ <code>sync.Mutex</code> å°±å·²ç»è¢«å®šä¹‰ä¸ºå·²è§£é”çš„äº’æ–¥é”äº†ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="69" data-paginate="true" data-theme="default" data-marpit-pagination="69" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>â€œé›¶å€¼å±æ€§â€ å¯ä»¥å¸¦æ¥å„ç§å¥½å¤„ã€‚è€ƒè™‘ä»¥ä¸‹ç±»å‹å£°æ˜ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> SyncedBuffer <span class="hljs-keyword">struct</span> {
    lock    sync.Mutex
    buffer  bytes.Buffer
}
</span></span></foreignObject></svg></code></pre>
<p><code>SyncedBuffer</code> ç±»å‹çš„å€¼ä¹Ÿæ˜¯åœ¨å£°æ˜æ—¶å°±åˆ†é…å¥½å†…å­˜å°±ç»ªäº†ã€‚åç»­ä»£ç ä¸­ï¼Œ <code>p</code> å’Œ <code>v</code> æ— éœ€è¿›ä¸€æ­¥å¤„ç†å³å¯æ­£ç¡®å·¥ä½œã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>p := <span class="hljs-built_in">new</span>(SyncedBuffer)  <span class="hljs-comment">// type *SyncedBuffer</span>
<span class="hljs-keyword">var</span> v SyncedBuffer      <span class="hljs-comment">// type  SyncedBuffer</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="70" data-paginate="true" data-theme="default" data-marpit-pagination="70" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>æ„é€ å‡½æ•°å’Œå¤åˆå­—é¢é‡</h3>
<p>æœ‰æ—¶é›¶å€¼è¿˜ä¸å¤Ÿå¥½ï¼Œè¿™æ—¶å°±éœ€è¦ä¸€ä¸ªåˆå§‹åŒ–æ„é€ å‡½æ•°ï¼Œå¦‚æ¥è‡ª <code>os</code> åŒ…ä¸­çš„è¿™æ®µä»£ç æ‰€ç¤ºã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewFile</span><span class="hljs-params">(fd <span class="hljs-keyword">int</span>, name <span class="hljs-keyword">string</span>)</span> *<span class="hljs-title">File</span></span> {
    <span class="hljs-keyword">if</span> fd &lt; <span class="hljs-number">0</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
    }
    f := <span class="hljs-built_in">new</span>(File)
    f.fd = fd
    f.name = name
    f.dirinfo = <span class="hljs-literal">nil</span>
    f.nepipe = <span class="hljs-number">0</span>
    <span class="hljs-keyword">return</span> f
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="71" data-paginate="true" data-theme="default" data-marpit-pagination="71" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¿™é‡Œæ˜¾å¾—ä»£ç è¿‡äºå†—é•¿ã€‚æˆ‘ä»¬å¯é€šè¿‡<strong>å¤åˆå­—é¢</strong>æ¥ç®€åŒ–å®ƒï¼Œ è¯¥è¡¨è¾¾å¼åœ¨æ¯æ¬¡æ±‚å€¼æ—¶éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewFile</span><span class="hljs-params">(fd <span class="hljs-keyword">int</span>, name <span class="hljs-keyword">string</span>)</span> *<span class="hljs-title">File</span></span> {
    <span class="hljs-keyword">if</span> fd &lt; <span class="hljs-number">0</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
    }
    f := File{fd, name, <span class="hljs-literal">nil</span>, <span class="hljs-number">0</span>}
    <span class="hljs-keyword">return</span> &amp;f
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="72" data-paginate="true" data-theme="default" data-marpit-pagination="72" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¯·æ³¨æ„ï¼Œè¿”å›ä¸€ä¸ªå±€éƒ¨å˜é‡çš„åœ°å€å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œè¿™ç‚¹ä¸ C ä¸åŒã€‚è¯¥å±€éƒ¨å˜é‡å¯¹åº”çš„æ•°æ® åœ¨å‡½æ•°è¿”å›åä¾ç„¶æœ‰æ•ˆã€‚å®é™…ä¸Šï¼Œæ¯å½“è·å–ä¸€ä¸ªå¤åˆå­—é¢çš„åœ°å€æ—¶ï¼Œéƒ½å°†ä¸ºä¸€ä¸ªæ–°çš„å®ä¾‹åˆ†é…å†…å­˜ï¼Œ å› æ­¤æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„æœ€åä¸¤è¡Œä»£ç åˆå¹¶ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>    <span class="hljs-keyword">return</span> &amp;File{fd, name, <span class="hljs-literal">nil</span>, <span class="hljs-number">0</span>}
</span></span></foreignObject></svg></code></pre>
<p>å¤åˆå­—é¢çš„å­—æ®µå¿…é¡»æŒ‰é¡ºåºå…¨éƒ¨åˆ—å‡ºã€‚ä½†å¦‚æœä»¥ <strong>å­—æ®µ</strong><code>:</code><strong>å€¼</strong> å¯¹çš„å½¢å¼æ˜ç¡®åœ°æ ‡å‡ºå…ƒç´ ï¼Œåˆå§‹åŒ–å­—æ®µæ—¶å°±å¯ä»¥æŒ‰ä»»ä½•é¡ºåºå‡ºç°ï¼Œæœªç»™å‡ºçš„å­—æ®µå€¼å°†èµ‹äºˆé›¶å€¼ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹å½¢å¼ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>    <span class="hljs-keyword">return</span> &amp;File{fd: fd, name: name}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="73" data-paginate="true" data-theme="default" data-marpit-pagination="73" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å°‘æ•°æƒ…å†µä¸‹ï¼Œè‹¥å¤åˆå­—é¢ä¸åŒ…æ‹¬ä»»ä½•å­—æ®µï¼Œå®ƒå°†åˆ›å»ºè¯¥ç±»å‹çš„é›¶å€¼ã€‚è¡¨è¾¾å¼ <code>new(File)</code> å’Œ <code>&amp;File{}</code> æ˜¯ç­‰ä»·çš„ã€‚</p>
<p>å¤åˆå­—é¢åŒæ ·å¯ç”¨äºåˆ›å»ºæ•°ç»„ã€åˆ‡ç‰‡ä»¥åŠæ˜ å°„ï¼Œå­—æ®µæ ‡ç­¾æ˜¯ç´¢å¼•è¿˜æ˜¯æ˜ å°„é”®åˆ™è§†æƒ…å†µè€Œå®šã€‚ åœ¨ä¸‹ä¾‹åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œæ— è®º <code>Enone</code>ã€<code>Eio</code> å’Œ <code>Einval</code> çš„å€¼æ˜¯ä»€ä¹ˆï¼Œåªè¦å®ƒä»¬çš„æ ‡ç­¾ä¸åŒå°±è¡Œã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>a := [...]<span class="hljs-keyword">string</span>   {Enone: <span class="hljs-string">"no error"</span>, Eio: <span class="hljs-string">"Eio"</span>, Einval: <span class="hljs-string">"invalid argument"</span>}
s := []<span class="hljs-keyword">string</span>      {Enone: <span class="hljs-string">"no error"</span>, Eio: <span class="hljs-string">"Eio"</span>, Einval: <span class="hljs-string">"invalid argument"</span>}
m := <span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]<span class="hljs-keyword">string</span>{Enone: <span class="hljs-string">"no error"</span>, Eio: <span class="hljs-string">"Eio"</span>, Einval: <span class="hljs-string">"invalid argument"</span>}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="74" data-paginate="true" data-theme="default" data-marpit-pagination="74" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>ä½¿ç”¨ <code>make</code> åˆ†é…</h3>
<p>å†å›åˆ°å†…å­˜åˆ†é…ä¸Šæ¥ã€‚å†…å»ºå‡½æ•° <code>make(T,</code><em>args</em><code>)</code> çš„ç›®çš„ä¸åŒäº <code>new(T)</code>ã€‚å®ƒåªç”¨äºåˆ›å»ºåˆ‡ç‰‡ã€æ˜ å°„å’Œä¿¡é“ï¼Œå¹¶è¿”å›ç±»å‹ä¸º <code>T</code>ï¼ˆè€Œé <code>*T</code>ï¼‰çš„ä¸€ä¸ª<strong>å·²åˆå§‹åŒ–</strong> ï¼ˆè€Œé<strong>ç½®é›¶</strong>ï¼‰çš„å€¼ã€‚ å‡ºç°è¿™ç§ç”¨å·®å¼‚çš„åŸå› åœ¨äºï¼Œè¿™ä¸‰ç§ç±»å‹æœ¬è´¨ä¸Šä¸ºå¼•ç”¨æ•°æ®ç±»å‹ï¼Œå®ƒä»¬åœ¨ä½¿ç”¨å‰å¿…é¡»åˆå§‹åŒ–ã€‚ ä¾‹å¦‚ï¼Œåˆ‡ç‰‡æ˜¯ä¸€ä¸ªå…·æœ‰ä¸‰é¡¹å†…å®¹çš„æè¿°ç¬¦ï¼ŒåŒ…å«ä¸€ä¸ªæŒ‡å‘ï¼ˆæ•°ç»„å†…éƒ¨ï¼‰æ•°æ®çš„æŒ‡é’ˆã€é•¿åº¦ä»¥åŠå®¹é‡ï¼Œ åœ¨è¿™ä¸‰é¡¹è¢«åˆå§‹åŒ–ä¹‹å‰ï¼Œè¯¥åˆ‡ç‰‡ä¸º <code>nil</code>ã€‚å¯¹äºåˆ‡ç‰‡ã€æ˜ å°„å’Œä¿¡é“ï¼Œ<code>make</code> ç”¨äºåˆå§‹åŒ–å…¶å†…éƒ¨çš„æ•°æ®ç»“æ„å¹¶å‡†å¤‡å¥½å°†è¦ä½¿ç”¨çš„å€¼ã€‚ä¾‹å¦‚ï¼Œ</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="75" data-paginate="true" data-theme="default" data-marpit-pagination="75" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ä¼šåˆ†é…ä¸€ä¸ªå…·æœ‰ 100 ä¸ª <code>int</code> çš„æ•°ç»„ç©ºé—´ï¼Œæ¥ç€åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 10ï¼Œ å®¹é‡ä¸º 100 å¹¶æŒ‡å‘è¯¥æ•°ç»„ä¸­å‰ 10 ä¸ªå…ƒç´ çš„åˆ‡ç‰‡ç»“æ„ã€‚ï¼ˆç”Ÿæˆåˆ‡ç‰‡æ—¶ï¼Œå…¶å®¹é‡å¯ä»¥çœç•¥ï¼Œæ›´å¤šä¿¡æ¯è§åˆ‡ç‰‡ä¸€èŠ‚ã€‚ï¼‰ ä¸æ­¤ç›¸åï¼Œ<code>new([]int)</code> ä¼šè¿”å›ä¸€ä¸ªæŒ‡å‘æ–°åˆ†é…çš„ï¼Œå·²ç½®é›¶çš„åˆ‡ç‰‡ç»“æ„ï¼Œ å³ä¸€ä¸ªæŒ‡å‘ <code>nil</code> åˆ‡ç‰‡å€¼çš„æŒ‡é’ˆã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­é˜æ˜äº† <code>new</code> å’Œ <code>make</code> ä¹‹é—´çš„åŒºåˆ«ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> p *[]<span class="hljs-keyword">int</span> = <span class="hljs-built_in">new</span>([]<span class="hljs-keyword">int</span>)       <span class="hljs-comment">// åˆ†é…åˆ‡ç‰‡ç»“æ„ï¼›*p == nilï¼›å¾ˆå°‘ç”¨åˆ°</span>
<span class="hljs-keyword">var</span> v  []<span class="hljs-keyword">int</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">100</span>) <span class="hljs-comment">// åˆ‡ç‰‡ v ç°åœ¨å¼•ç”¨äº†ä¸€ä¸ªå…·æœ‰ 100 ä¸ª int å…ƒç´ çš„æ–°æ•°ç»„</span>

<span class="hljs-comment">// æ²¡å¿…è¦çš„å¤æ‚ç”¨æ³•:</span>
<span class="hljs-keyword">var</span> p *[]<span class="hljs-keyword">int</span> = <span class="hljs-built_in">new</span>([]<span class="hljs-keyword">int</span>)
*p = <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>)

<span class="hljs-comment">// å¸¸è§„ç”¨æ³•:</span>
v := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">100</span>)
</span></span></foreignObject></svg></code></pre>
<p>è¯·è®°ä½ï¼Œ<code>make</code> åªé€‚ç”¨äºæ˜ å°„ã€åˆ‡ç‰‡å’Œä¿¡é“ä¸”ä¸è¿”å›æŒ‡é’ˆã€‚è‹¥è¦è·å¾—æ˜ç¡®çš„æŒ‡é’ˆï¼Œ è¯·ä½¿ç”¨ <code>new</code> åˆ†é…å†…å­˜ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="76" data-paginate="true" data-theme="default" data-marpit-pagination="76" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>æ•°ç»„</h3>
<p>åœ¨è¯¦ç»†è§„åˆ’å†…å­˜å¸ƒå±€æ—¶ï¼Œæ•°ç»„æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæœ‰æ—¶è¿˜èƒ½é¿å…è¿‡å¤šçš„å†…å­˜åˆ†é…ï¼Œ ä½†å®ƒä»¬ä¸»è¦ç”¨ä½œåˆ‡ç‰‡çš„æ„ä»¶ã€‚è¿™æ˜¯ä¸‹ä¸€èŠ‚çš„ä¸»é¢˜äº†ï¼Œä¸è¿‡è¦å…ˆè¯´ä¸Šå‡ å¥æ¥ä¸ºå®ƒåšé“ºå«ã€‚</p>
<p>ä»¥ä¸‹ä¸ºæ•°ç»„åœ¨ Go å’Œ C ä¸­çš„ä¸»è¦åŒºåˆ«ã€‚åœ¨ Go ä¸­ï¼Œ</p>
<ul>
<li>æ•°ç»„æ˜¯å€¼ã€‚å°†ä¸€ä¸ªæ•°ç»„èµ‹äºˆå¦ä¸€ä¸ªæ•°ç»„ä¼šå¤åˆ¶å…¶æ‰€æœ‰å…ƒç´ ã€‚</li>
<li>ç‰¹åˆ«åœ°ï¼Œè‹¥å°†æŸä¸ªæ•°ç»„ä¼ å…¥æŸä¸ªå‡½æ•°ï¼Œå®ƒå°†æ¥æ”¶åˆ°è¯¥æ•°ç»„çš„ä¸€ä»½<strong>å‰¯æœ¬</strong>è€ŒéæŒ‡é’ˆã€‚</li>
<li>æ•°ç»„çš„å¤§å°æ˜¯å…¶ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚ç±»å‹ <code>[10]int</code> å’Œ <code>[20]int</code> æ˜¯ä¸åŒçš„ã€‚</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="77" data-paginate="true" data-theme="default" data-marpit-pagination="77" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ•°ç»„ä¸ºå€¼çš„å±æ€§å¾ˆæœ‰ç”¨ï¼Œä½†ä»£ä»·é«˜æ˜‚ï¼›è‹¥ä½ æƒ³è¦ C é‚£æ ·çš„è¡Œä¸ºå’Œæ•ˆç‡ï¼Œä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªæŒ‡å‘è¯¥æ•°ç»„çš„æŒ‡é’ˆã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Sum</span><span class="hljs-params">(a *[3]<span class="hljs-keyword">float64</span>)</span> <span class="hljs-params">(sum <span class="hljs-keyword">float64</span>)</span></span> {
    <span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> *a {
        sum += v
    }
    <span class="hljs-keyword">return</span>
}

array := [...]<span class="hljs-keyword">float64</span>{<span class="hljs-number">7.0</span>, <span class="hljs-number">8.5</span>, <span class="hljs-number">9.1</span>}
x := Sum(&amp;array)  <span class="hljs-comment">// Note the explicit address-of operator</span>
</span></span></foreignObject></svg></code></pre>
<p>ä½†è¿™å¹¶ä¸æ˜¯ Go çš„ä¹ æƒ¯ç”¨æ³•ï¼Œåˆ‡ç‰‡æ‰æ˜¯ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="78" data-paginate="true" data-theme="default" data-marpit-pagination="78" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>åˆ‡ç‰‡</h3>
<p>åˆ‡ç‰‡é€šè¿‡å¯¹æ•°ç»„è¿›è¡Œå°è£…ï¼Œä¸ºæ•°æ®åºåˆ—æä¾›äº†æ›´é€šç”¨ã€å¼ºå¤§è€Œæ–¹ä¾¿çš„æ¥å£ã€‚ é™¤äº†çŸ©é˜µå˜æ¢è¿™ç±»éœ€è¦æ˜ç¡®ç»´åº¦çš„æƒ…å†µå¤–ï¼ŒGo ä¸­çš„å¤§éƒ¨åˆ†æ•°ç»„ç¼–ç¨‹éƒ½æ˜¯é€šè¿‡åˆ‡ç‰‡æ¥å®Œæˆçš„ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="79" data-paginate="true" data-theme="default" data-marpit-pagination="79" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åˆ‡ç‰‡ä¿å­˜äº†å¯¹åº•å±‚æ•°ç»„çš„å¼•ç”¨ï¼Œè‹¥ä½ å°†æŸä¸ªåˆ‡ç‰‡èµ‹äºˆå¦ä¸€ä¸ªåˆ‡ç‰‡ï¼Œå®ƒä»¬ä¼šå¼•ç”¨åŒä¸€ä¸ªæ•°ç»„ã€‚ è‹¥æŸä¸ªå‡½æ•°å°†ä¸€ä¸ªåˆ‡ç‰‡ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œåˆ™å®ƒå¯¹è¯¥åˆ‡ç‰‡å…ƒç´ çš„ä¿®æ”¹å¯¹è°ƒç”¨è€…è€Œè¨€åŒæ ·å¯è§ï¼Œ è¿™å¯ä»¥ç†è§£ä¸ºä¼ é€’äº†åº•å±‚æ•°ç»„çš„æŒ‡é’ˆã€‚å› æ­¤ï¼Œ<code>Read</code> å‡½æ•°å¯æ¥å—ä¸€ä¸ªåˆ‡ç‰‡å®å‚ è€Œéä¸€ä¸ªæŒ‡é’ˆå’Œä¸€ä¸ªè®¡æ•°ï¼›åˆ‡ç‰‡çš„é•¿åº¦å†³å®šäº†å¯è¯»å–æ•°æ®çš„ä¸Šé™ã€‚ä»¥ä¸‹ä¸º <code>os</code> åŒ…ä¸­ <code>File</code> ç±»å‹çš„ <code>Read</code> æ–¹æ³•ç­¾å:</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(f *File)</span> <span class="hljs-title">Read</span><span class="hljs-params">(buf []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-params">(n <span class="hljs-keyword">int</span>, err error)</span></span>
</span></span></foreignObject></svg></code></pre>
<p>è¯¥æ–¹æ³•è¿”å›è¯»å–çš„å­—èŠ‚æ•°å’Œä¸€ä¸ªé”™è¯¯å€¼ï¼ˆè‹¥æœ‰çš„è¯ï¼‰ã€‚è‹¥è¦ä»æ›´å¤§çš„ç¼“å†²åŒº <code>b</code> ä¸­è¯»å–å‰ 32 ä¸ªå­—èŠ‚ï¼Œåªéœ€å¯¹å…¶è¿›è¡Œ<strong>åˆ‡ç‰‡</strong>å³å¯ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>    n, err := f.Read(buf[<span class="hljs-number">0</span>:<span class="hljs-number">32</span>])
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="80" data-paginate="true" data-theme="default" data-marpit-pagination="80" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¿™ç§åˆ‡ç‰‡çš„æ–¹æ³•å¸¸ç”¨ä¸”é«˜æ•ˆã€‚è‹¥ä¸è°ˆæ•ˆç‡ï¼Œä»¥ä¸‹ç‰‡æ®µåŒæ ·èƒ½è¯»å–è¯¥ç¼“å†²åŒºçš„å‰ 32 ä¸ªå­—èŠ‚ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>    <span class="hljs-keyword">var</span> n <span class="hljs-keyword">int</span>
    <span class="hljs-keyword">var</span> err error
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++ {
        nbytes, e := f.Read(buf[i:i+<span class="hljs-number">1</span>])  <span class="hljs-comment">// Read one byte.</span>
        n += nbytes
        <span class="hljs-keyword">if</span> nbytes == <span class="hljs-number">0</span> || e != <span class="hljs-literal">nil</span> {
            err = e
            <span class="hljs-keyword">break</span>
        }
    }
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="81" data-paginate="true" data-theme="default" data-marpit-pagination="81" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åªè¦åˆ‡ç‰‡ä¸è¶…å‡ºåº•å±‚æ•°ç»„çš„é™åˆ¶ï¼Œå®ƒçš„é•¿åº¦å°±æ˜¯å¯å˜çš„ï¼Œåªéœ€å°†å®ƒèµ‹äºˆå…¶è‡ªèº«çš„åˆ‡ç‰‡å³å¯ã€‚ åˆ‡ç‰‡çš„<strong>å®¹é‡</strong>å¯é€šè¿‡å†…å»ºå‡½æ•° <code>cap</code> è·å¾—ï¼Œå®ƒå°†ç»™å‡ºè¯¥åˆ‡ç‰‡å¯å–å¾—çš„æœ€å¤§é•¿åº¦ã€‚ ä»¥ä¸‹æ˜¯å°†æ•°æ®è¿½åŠ åˆ°åˆ‡ç‰‡çš„å‡½æ•°ã€‚è‹¥æ•°æ®è¶…å‡ºå…¶å®¹é‡ï¼Œåˆ™ä¼šé‡æ–°åˆ†é…è¯¥åˆ‡ç‰‡ã€‚è¿”å›å€¼å³ä¸ºæ‰€å¾—çš„åˆ‡ç‰‡ã€‚ è¯¥å‡½æ•°ä¸­æ‰€ä½¿ç”¨çš„ <code>len</code> å’Œ <code>cap</code> åœ¨åº”ç”¨äº <code>nil</code> åˆ‡ç‰‡æ—¶æ˜¯åˆæ³•çš„ï¼Œå®ƒä¼šè¿”å› 0ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Append</span><span class="hljs-params">(slice, data []<span class="hljs-keyword">byte</span>)</span> []<span class="hljs-title">byte</span></span> {
    l := <span class="hljs-built_in">len</span>(slice)
    <span class="hljs-keyword">if</span> l + <span class="hljs-built_in">len</span>(data) &gt; <span class="hljs-built_in">cap</span>(slice) {  <span class="hljs-comment">// é‡æ–°åˆ†é…</span>
        <span class="hljs-comment">// ä¸ºæœªæ¥çš„å¢é•¿,åŒé‡åˆ†é…æ‰€éœ€çš„å†…å®¹.</span>
        newSlice := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">byte</span>, (l+<span class="hljs-built_in">len</span>(data))*<span class="hljs-number">2</span>)
        <span class="hljs-comment">// copyå‡½æ•°æ˜¯é¢„å…ˆå£°æ˜çš„ï¼Œé€‚ç”¨äºä»»ä½•åˆ‡ç‰‡ç±»å‹ã€‚</span>
        <span class="hljs-built_in">copy</span>(newSlice, slice)
        slice = newSlice
    }
    slice = slice[<span class="hljs-number">0</span>:l+<span class="hljs-built_in">len</span>(data)]
    <span class="hljs-built_in">copy</span>(slice[l:], data)
    <span class="hljs-keyword">return</span> slice
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="82" data-paginate="true" data-theme="default" data-marpit-pagination="82" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æœ€ç»ˆæˆ‘ä»¬å¿…é¡»è¿”å›åˆ‡ç‰‡ï¼Œå› ä¸ºå°½ç®¡ <code>Append</code> å¯ä¿®æ”¹ <code>slice</code> çš„å…ƒç´ ï¼Œä½†åˆ‡ç‰‡è‡ªèº«ï¼ˆå…¶è¿è¡Œæ—¶æ•°æ®ç»“æ„åŒ…å«æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡ï¼‰æ˜¯é€šè¿‡å€¼ä¼ é€’çš„ã€‚</p>
<p>å‘åˆ‡ç‰‡è¿½åŠ ä¸œè¥¿çš„æƒ³æ³•éå¸¸æœ‰ç”¨ï¼Œå› æ­¤æœ‰ä¸“é—¨çš„å†…å»ºå‡½æ•° <code>append</code>ã€‚ è¦ç†è§£è¯¥å‡½æ•°çš„è®¾è®¡ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†ç¨åå†ä»‹ç»å®ƒã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="83" data-paginate="true" data-theme="default" data-marpit-pagination="83" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>äºŒç»´åˆ‡ç‰‡</h3>
<p>Go çš„æ•°ç»„å’Œåˆ‡ç‰‡éƒ½æ˜¯ä¸€ç»´çš„ã€‚è¦åˆ›å»ºç­‰ä»·çš„äºŒç»´æ•°ç»„æˆ–åˆ‡ç‰‡ï¼Œå°±å¿…é¡»å®šä¹‰ä¸€ä¸ªæ•°ç»„çš„æ•°ç»„ï¼Œ æˆ–åˆ‡ç‰‡çš„åˆ‡ç‰‡ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Transform [<span class="hljs-number">3</span>][<span class="hljs-number">3</span>]<span class="hljs-keyword">float64</span>  <span class="hljs-comment">// ä¸€ä¸ª 3x3 çš„æ•°ç»„ï¼Œå…¶å®æ˜¯åŒ…å«å¤šä¸ªæ•°ç»„çš„ä¸€ä¸ªæ•°ç»„ã€‚</span>
<span class="hljs-keyword">type</span> LinesOfText [][]<span class="hljs-keyword">byte</span>     <span class="hljs-comment">// åŒ…å«å¤šä¸ªå­—èŠ‚åˆ‡ç‰‡çš„ä¸€ä¸ªåˆ‡ç‰‡ã€‚</span>
</span></span></foreignObject></svg></code></pre>
<p>ç”±äºåˆ‡ç‰‡é•¿åº¦æ˜¯å¯å˜çš„ï¼Œå› æ­¤å…¶å†…éƒ¨å¯èƒ½æ‹¥æœ‰å¤šä¸ªä¸åŒé•¿åº¦çš„åˆ‡ç‰‡ã€‚åœ¨æˆ‘ä»¬çš„ <code>LinesOfText</code> ä¾‹å­ä¸­ï¼Œè¿™æ˜¯ç§å¸¸è§çš„æƒ…å†µï¼šæ¯è¡Œéƒ½æœ‰å…¶è‡ªå·±çš„é•¿åº¦ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>text := LinesOfText{
    []<span class="hljs-keyword">byte</span>(<span class="hljs-string">"Now is the time"</span>),
    []<span class="hljs-keyword">byte</span>(<span class="hljs-string">"for all good gophers"</span>),
    []<span class="hljs-keyword">byte</span>(<span class="hljs-string">"to bring some fun to the party."</span>),
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="84" data-paginate="true" data-theme="default" data-marpit-pagination="84" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æœ‰æ—¶å¿…é¡»åˆ†é…ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œä¾‹å¦‚åœ¨å¤„ç†åƒç´ çš„æ‰«æè¡Œæ—¶ï¼Œè¿™ç§æƒ…å†µå°±ä¼šå‘ç”Ÿã€‚ æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚ä¸€ç§å°±æ˜¯ç‹¬ç«‹åœ°åˆ†é…æ¯ä¸€ä¸ªåˆ‡ç‰‡ï¼›è€Œå¦ä¸€ç§å°±æ˜¯åªåˆ†é…ä¸€ä¸ªæ•°ç»„ï¼Œ å°†å„ä¸ªåˆ‡ç‰‡éƒ½æŒ‡å‘å®ƒã€‚é‡‡ç”¨å“ªç§æ–¹å¼å–å†³äºä½ çš„åº”ç”¨ã€‚è‹¥åˆ‡ç‰‡ä¼šå¢é•¿æˆ–æ”¶ç¼©ï¼Œ å°±åº”è¯¥é€šè¿‡ç‹¬ç«‹åˆ†é…æ¥é¿å…è¦†ç›–ä¸‹ä¸€è¡Œï¼›è‹¥ä¸ä¼šï¼Œç”¨å•æ¬¡åˆ†é…æ¥æ„é€ å¯¹è±¡ä¼šæ›´åŠ é«˜æ•ˆã€‚ ä»¥ä¸‹æ˜¯è¿™ä¸¤ç§æ–¹æ³•çš„å¤§æ¦‚ä»£ç ï¼Œä»…ä¾›å‚è€ƒã€‚é¦–å…ˆæ˜¯ä¸€æ¬¡ä¸€è¡Œçš„ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// åˆ†é…åº•å±‚åˆ‡ç‰‡.</span>
picture := <span class="hljs-built_in">make</span>([][]<span class="hljs-keyword">uint8</span>, YSize) <span class="hljs-comment">// yæ¯ä¸€è¡Œçš„å¤§å°</span>
<span class="hljs-comment">//å¾ªç¯éå†æ¯ä¸€è¡Œ</span>
<span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> picture {
    picture[i] = <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">uint8</span>, XSize)
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="85" data-paginate="true" data-theme="default" data-marpit-pagination="85" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ç°åœ¨æ˜¯ä¸€æ¬¡åˆ†é…ï¼Œå¯¹è¡Œè¿›è¡Œåˆ‡ç‰‡ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// åˆ†é…åº•å±‚åˆ‡ç‰‡</span>
picture := <span class="hljs-built_in">make</span>([][]<span class="hljs-keyword">uint8</span>, YSize) <span class="hljs-comment">//  æ¯ y ä¸ªå•å…ƒä¸€è¡Œã€‚</span>
<span class="hljs-comment">// åˆ†é…ä¸€ä¸ªå¤§ä¸€äº›çš„åˆ‡ç‰‡ä»¥å®¹çº³æ‰€æœ‰çš„å…ƒç´ </span>
pixels := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">uint8</span>, XSize*YSize) <span class="hljs-comment">// æŒ‡å®šç±»å‹[]uint8, å³ä¾¿å›¾ç‰‡æ˜¯ [][]uint8.</span>
<span class="hljs-comment">//å¾ªç¯éå†å›¾ç‰‡æ‰€æœ‰è¡Œï¼Œä»å‰©ä½™åƒç´ åˆ‡ç‰‡çš„å‰é¢å¯¹æ¯ä¸€è¡Œè¿›è¡Œåˆ‡ç‰‡ã€‚</span>
<span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> picture {
    picture[i], pixels = pixels[:XSize], pixels[XSize:]
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="86" data-paginate="true" data-theme="default" data-marpit-pagination="86" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>æ˜ å°„</h3>
<p>æ˜ å°„æ˜¯æ–¹ä¾¿è€Œå¼ºå¤§çš„å†…å»ºæ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å…³è”ä¸åŒç±»å‹çš„å€¼ã€‚å…¶é”®å¯ä»¥æ˜¯ä»»ä½•ç›¸ç­‰æ€§æ“ä½œç¬¦æ”¯æŒçš„ç±»å‹ï¼Œ å¦‚æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•°ã€å­—ç¬¦ä¸²ã€æŒ‡é’ˆã€æ¥å£ï¼ˆåªè¦å…¶åŠ¨æ€ç±»å‹æ”¯æŒç›¸ç­‰æ€§åˆ¤æ–­ï¼‰ã€ç»“æ„ä»¥åŠæ•°ç»„ã€‚ åˆ‡ç‰‡ä¸èƒ½ç”¨ä½œæ˜ å°„é”®ï¼Œå› ä¸ºå®ƒä»¬çš„ç›¸ç­‰æ€§è¿˜æœªå®šä¹‰ã€‚ä¸åˆ‡ç‰‡ä¸€æ ·ï¼Œæ˜ å°„ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹ã€‚ è‹¥å°†æ˜ å°„ä¼ å…¥å‡½æ•°ä¸­ï¼Œå¹¶æ›´æ”¹äº†è¯¥æ˜ å°„çš„å†…å®¹ï¼Œåˆ™æ­¤ä¿®æ”¹å¯¹è°ƒç”¨è€…åŒæ ·å¯è§ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="87" data-paginate="true" data-theme="default" data-marpit-pagination="87" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ˜ å°„å¯ä½¿ç”¨ä¸€èˆ¬çš„å¤åˆå­—é¢è¯­æ³•è¿›è¡Œæ„å»ºï¼Œå…¶é”® - å€¼å¯¹ä½¿ç”¨å†’å·åˆ†éš”ï¼Œå› æ­¤å¯åœ¨åˆå§‹åŒ–æ—¶å¾ˆå®¹æ˜“åœ°æ„å»ºå®ƒä»¬ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> timeZone = <span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">int</span>{
    <span class="hljs-string">"UTC"</span>:  <span class="hljs-number">0</span>*<span class="hljs-number">60</span>*<span class="hljs-number">60</span>,
    <span class="hljs-string">"EST"</span>: <span class="hljs-number">-5</span>*<span class="hljs-number">60</span>*<span class="hljs-number">60</span>,
    <span class="hljs-string">"CST"</span>: <span class="hljs-number">-6</span>*<span class="hljs-number">60</span>*<span class="hljs-number">60</span>,
    <span class="hljs-string">"MST"</span>: <span class="hljs-number">-7</span>*<span class="hljs-number">60</span>*<span class="hljs-number">60</span>,
    <span class="hljs-string">"PST"</span>: <span class="hljs-number">-8</span>*<span class="hljs-number">60</span>*<span class="hljs-number">60</span>,
}
</span></span></foreignObject></svg></code></pre>
<p>èµ‹å€¼å’Œè·å–æ˜ å°„å€¼çš„è¯­æ³•ç±»ä¼¼äºæ•°ç»„ï¼Œä¸åŒçš„æ˜¯æ˜ å°„çš„ç´¢å¼•ä¸å¿…ä¸ºæ•´æ•°ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>offset := timeZone[<span class="hljs-string">"EST"</span>]
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="88" data-paginate="true" data-theme="default" data-marpit-pagination="88" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥è¯•å›¾é€šè¿‡æ˜ å°„ä¸­ä¸å­˜åœ¨çš„é”®æ¥å–å€¼ï¼Œå°±ä¼šè¿”å›ä¸è¯¥æ˜ å°„ä¸­é¡¹çš„ç±»å‹å¯¹åº”çš„é›¶å€¼ã€‚ ä¾‹å¦‚ï¼Œè‹¥æŸä¸ªæ˜ å°„åŒ…å«æ•´æ•°ï¼Œå½“æŸ¥æ‰¾ä¸€ä¸ªä¸å­˜åœ¨çš„é”®æ—¶ä¼šè¿”å› <code>0</code>ã€‚ é›†åˆå¯å®ç°æˆä¸€ä¸ªå€¼ç±»å‹ä¸º <code>bool</code> çš„æ˜ å°„ã€‚å°†è¯¥æ˜ å°„ä¸­çš„é¡¹ç½®ä¸º <code>true</code> å¯å°†è¯¥å€¼æ”¾å…¥é›†åˆä¸­ï¼Œæ­¤åé€šè¿‡ç®€å•çš„ç´¢å¼•æ“ä½œå³å¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>attended := <span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">bool</span>{
    <span class="hljs-string">"Ann"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"Joe"</span>: <span class="hljs-literal">true</span>,
    ...
}

<span class="hljs-keyword">if</span> attended[person] { <span class="hljs-comment">// personä¸åœ¨é›†åˆä¸­ï¼Œè¿”å› false</span>
    fmt.Println(person, <span class="hljs-string">"was at the meeting"</span>)
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="89" data-paginate="true" data-theme="default" data-marpit-pagination="89" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æœ‰æ—¶ä½ éœ€è¦åŒºåˆ†æŸé¡¹æ˜¯ä¸å­˜åœ¨è¿˜æ˜¯å…¶å€¼ä¸ºé›¶å€¼ã€‚å¦‚å¯¹äºä¸€ä¸ªå€¼æœ¬åº”ä¸ºé›¶çš„ <code>&quot;UTC&quot;</code> æ¡ç›®ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºä¸å­˜åœ¨è¯¥é¡¹è€Œå¾—åˆ°é›¶å€¼ã€‚ä½ å¯ä»¥ä½¿ç”¨å¤šé‡èµ‹å€¼çš„å½¢å¼æ¥åˆ†è¾¨è¿™ç§æƒ…å†µã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> seconds <span class="hljs-keyword">int</span>
<span class="hljs-keyword">var</span> ok <span class="hljs-keyword">bool</span>
seconds, ok = timeZone[tz]
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="90" data-paginate="true" data-theme="default" data-marpit-pagination="90" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ç§°ä¹‹ä¸º â€œé€—å· okâ€ æƒ¯ç”¨æ³•ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œè‹¥ <code>tz</code> å­˜åœ¨ï¼Œ <code>seconds</code> å°±ä¼šè¢«èµ‹äºˆé€‚å½“çš„å€¼ï¼Œä¸” <code>ok</code> ä¼šè¢«ç½®ä¸º <code>true</code>ï¼› è‹¥ä¸å­˜åœ¨ï¼Œ<code>seconds</code> åˆ™ä¼šè¢«ç½®ä¸ºé›¶ï¼Œè€Œ <code>ok</code> ä¼šè¢«ç½®ä¸º <code>false</code>ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">offset</span><span class="hljs-params">(tz <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">int</span></span> {
    <span class="hljs-keyword">if</span> seconds, ok := timeZone[tz]; ok {
        <span class="hljs-keyword">return</span> seconds
    }
    log.Println(<span class="hljs-string">"unknown time zone:"</span>, tz)
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="91" data-paginate="true" data-theme="default" data-marpit-pagination="91" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥ä»…éœ€åˆ¤æ–­æ˜ å°„ä¸­æ˜¯å¦å­˜åœ¨æŸé¡¹è€Œä¸å…³å¿ƒå®é™…çš„å€¼ï¼Œå¯ä½¿ç”¨<a href="https://learnku.com/docs/effective-go/blank-identifier/6247">ç©ºç™½æ ‡è¯†ç¬¦</a> ï¼ˆ<code>_</code>ï¼‰æ¥ä»£æ›¿è¯¥å€¼çš„ä¸€èˆ¬å˜é‡ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>_, present := timeZone[tz]
</span></span></foreignObject></svg></code></pre>
<p>è¦åˆ é™¤æ˜ å°„ä¸­çš„æŸé¡¹ï¼Œå¯ä½¿ç”¨å†…å»ºå‡½æ•° <code>delete</code>ï¼Œå®ƒä»¥æ˜ å°„åŠè¦è¢«åˆ é™¤çš„é”®ä¸ºå®å‚ã€‚ å³ä¾¿å¯¹åº”çš„é”®ä¸åœ¨è¯¥æ˜ å°„ä¸­ï¼Œæ­¤æ“ä½œä¹Ÿæ˜¯å®‰å…¨çš„ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-built_in">delete</span>(timeZone, <span class="hljs-string">"PDT"</span>)  <span class="hljs-comment">// ç°åœ¨æ˜¯æ ‡å‡†æ—¶é—´</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="92" data-paginate="true" data-theme="default" data-marpit-pagination="92" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>æ‰“å°</h3>
<p>Go é‡‡ç”¨çš„æ ¼å¼åŒ–æ‰“å°é£æ ¼å’Œ C çš„ <code>printf</code> æ—ç±»ä¼¼ï¼Œä½†å´æ›´åŠ ä¸°å¯Œè€Œé€šç”¨ã€‚ è¿™äº›å‡½æ•°ä½äº <code>fmt</code> åŒ…ä¸­ï¼Œä¸”å‡½æ•°åé¦–å­—æ¯å‡ä¸ºå¤§å†™ï¼šå¦‚ <code>fmt.Printf</code>ã€<code>fmt.Fprintf</code>ï¼Œ<code>fmt.Sprintf</code> ç­‰ã€‚ å­—ç¬¦ä¸²å‡½æ•°ï¼ˆ<code>Sprintf</code> ç­‰ï¼‰ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œéå¡«å……ç»™å®šçš„ç¼“å†²åŒºã€‚</p>
<p>ä½ æ— éœ€æä¾›ä¸€ä¸ªæ ¼å¼å­—ç¬¦ä¸²ã€‚æ¯ä¸ª <code>Printf</code>ã€<code>Fprintf</code> å’Œ <code>Sprintf</code> éƒ½åˆ†åˆ«å¯¹åº”å¦å¤–çš„å‡½æ•°ï¼Œå¦‚ <code>Print</code> ä¸ <code>Println</code>ã€‚ è¿™äº›å‡½æ•°å¹¶ä¸æ¥å—æ ¼å¼å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ä¸ºæ¯ä¸ªå®å‚ç”Ÿæˆä¸€ç§é»˜è®¤æ ¼å¼ã€‚<code>Println</code> ç³»åˆ—çš„å‡½æ•°è¿˜ä¼šåœ¨å®å‚ä¸­æ’å…¥ç©ºæ ¼ï¼Œå¹¶åœ¨è¾“å‡ºæ—¶è¿½åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œè€Œ <code>Print</code> ç‰ˆæœ¬ä»…åœ¨æ“ä½œæ•°ä¸¤ä¾§éƒ½æ²¡æœ‰å­—ç¬¦ä¸²æ—¶æ‰æ·»åŠ ç©ºç™½ã€‚ä»¥ä¸‹ç¤ºä¾‹ä¸­å„è¡Œäº§ç”Ÿçš„è¾“å‡ºéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="93" data-paginate="true" data-theme="default" data-marpit-pagination="93" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>fmt.Printf(<span class="hljs-string">"Hello %d\n"</span>, <span class="hljs-number">23</span>)
fmt.Fprint(os.Stdout, <span class="hljs-string">"Hello "</span>, <span class="hljs-number">23</span>, <span class="hljs-string">"\n"</span>)
fmt.Println(<span class="hljs-string">"Hello"</span>, <span class="hljs-number">23</span>)
fmt.Println(fmt.Sprint(<span class="hljs-string">"Hello "</span>, <span class="hljs-number">23</span>))
</span></span></foreignObject></svg></code></pre>
<p><code>fmt.Fprint</code> ä¸€ç±»çš„æ ¼å¼åŒ–æ‰“å°å‡½æ•°å¯æ¥å—ä»»ä½•å®ç°äº† <code>io.Writer</code> æ¥å£çš„å¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå®å‚ï¼›å˜é‡ <code>os.Stdout</code> ä¸ <code>os.Stderr</code> éƒ½æ˜¯äººä»¬ç†ŸçŸ¥çš„ä¾‹å­ã€‚</p>
<p>ä»è¿™é‡Œå¼€å§‹ï¼Œå°±ä¸ C æœ‰äº›ä¸åŒäº†ã€‚é¦–å…ˆï¼Œåƒ <code>%d</code> è¿™æ ·çš„æ•°å€¼æ ¼å¼å¹¶ä¸æ¥å—è¡¨ç¤ºç¬¦å·æˆ–å¤§å°çš„æ ‡è®°ï¼Œ æ‰“å°ä¾‹ç¨‹ä¼šæ ¹æ®å®å‚çš„ç±»å‹æ¥å†³å®šè¿™äº›å±æ€§ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> x <span class="hljs-keyword">uint64</span> = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">64</span> - <span class="hljs-number">1</span>
fmt.Printf(<span class="hljs-string">"%d %x; %d %x\n"</span>, x, x, <span class="hljs-keyword">int64</span>(x), <span class="hljs-keyword">int64</span>(x))
</span></span></foreignObject></svg></code></pre>
<p>æ‰“å°ç»“æœ</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-number">18446744073709551615</span> ffffffffffffffff; <span class="hljs-number">-1</span> <span class="hljs-number">-1</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="94" data-paginate="true" data-theme="default" data-marpit-pagination="94" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥ä½ åªæƒ³è¦é»˜è®¤çš„è½¬æ¢ï¼Œå¦‚ä½¿ç”¨åè¿›åˆ¶çš„æ•´æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨é€šç”¨çš„æ ¼å¼ <code>%v</code>ï¼ˆå¯¹åº” â€œå€¼â€ï¼‰ï¼›å…¶ç»“æœä¸ <code>Print</code> å’Œ <code>Println</code> çš„è¾“å‡ºå®Œå…¨ç›¸åŒã€‚æ­¤å¤–ï¼Œè¿™ç§æ ¼å¼è¿˜èƒ½æ‰“å°<strong>ä»»æ„</strong>å€¼ï¼Œç”šè‡³åŒ…æ‹¬æ•°ç»„ã€ç»“æ„ä½“å’Œæ˜ å°„ã€‚ ä»¥ä¸‹æ˜¯æ‰“å°ä¸Šä¸€èŠ‚ä¸­å®šä¹‰çš„æ—¶åŒºæ˜ å°„çš„è¯­å¥ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>fmt.Printf(<span class="hljs-string">"%v\n"</span>, timeZone)  <span class="hljs-comment">// or just fmt.Println(timeZone)</span>
</span></span></foreignObject></svg></code></pre>
<p>æ‰“å°ç»“æœ:</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">map</span>[CST:<span class="hljs-number">-21600</span> EST:<span class="hljs-number">-18000</span> MST:<span class="hljs-number">-25200</span> PST:<span class="hljs-number">-28800</span> UTC:<span class="hljs-number">0</span>]
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="95" data-paginate="true" data-theme="default" data-marpit-pagination="95" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å¯¹äºæ˜ å°„ï¼Œ<code>Printf</code> ä¼šè‡ªåŠ¨å¯¹æ˜ å°„å€¼æŒ‰ç…§é”®çš„å­—å…¸é¡ºåºæ’åºã€‚</p>
<p>å½“ç„¶ï¼Œæ˜ å°„ä¸­çš„é”®å¯èƒ½æŒ‰ä»»æ„é¡ºåºè¾“å‡ºã€‚å½“æ‰“å°ç»“æ„ä½“æ—¶ï¼Œæ”¹è¿›çš„æ ¼å¼ <code>%+v</code> ä¼šä¸ºç»“æ„ä½“çš„æ¯ä¸ªå­—æ®µæ·»ä¸Šå­—æ®µåï¼Œè€Œå¦ä¸€ç§æ ¼å¼ <code>%#v</code> å°†å®Œå…¨æŒ‰ç…§ Go çš„è¯­æ³•æ‰“å°å€¼ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> T <span class="hljs-keyword">struct</span> {
    a <span class="hljs-keyword">int</span>
    b <span class="hljs-keyword">float64</span>
    c <span class="hljs-keyword">string</span>
}
t := &amp;T{ <span class="hljs-number">7</span>, <span class="hljs-number">-2.35</span>, <span class="hljs-string">"abc\tdef"</span> }
fmt.Printf(<span class="hljs-string">"%v\n"</span>, t)
fmt.Printf(<span class="hljs-string">"%+v\n"</span>, t)
fmt.Printf(<span class="hljs-string">"%#v\n"</span>, t)
fmt.Printf(<span class="hljs-string">"%#v\n"</span>, timeZone)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="96" data-paginate="true" data-theme="default" data-marpit-pagination="96" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å°†æ‰“å°</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>&amp;{<span class="hljs-number">7</span> <span class="hljs-number">-2.35</span> abc   def}
&amp;{a:<span class="hljs-number">7</span> b:<span class="hljs-number">-2.35</span> c:abc     def}
&amp;main.T{a:<span class="hljs-number">7</span>, b:<span class="hljs-number">-2.35</span>, c:<span class="hljs-string">"abc\tdef"</span>}
<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">int</span>{<span class="hljs-string">"CST"</span>:<span class="hljs-number">-21600</span>, <span class="hljs-string">"EST"</span>:<span class="hljs-number">-18000</span>, <span class="hljs-string">"MST"</span>:<span class="hljs-number">-25200</span>, <span class="hljs-string">"PST"</span>:<span class="hljs-number">-28800</span>, <span class="hljs-string">"UTC"</span>:<span class="hljs-number">0</span>}
</span></span></foreignObject></svg></code></pre>
<p>ï¼ˆè¯·æ³¨æ„å…¶ä¸­çš„ &amp; ç¬¦å·ï¼‰å½“é‡åˆ° <code>string</code> æˆ– <code>[]byte</code> å€¼æ—¶ï¼Œ å¯ä½¿ç”¨ <code>%q</code> äº§ç”Ÿå¸¦å¼•å·çš„å­—ç¬¦ä¸²ï¼›è€Œæ ¼å¼ <code>%#q</code> ä¼šå°½å¯èƒ½ä½¿ç”¨åå¼•å·ã€‚ ï¼ˆ<code>%q</code> æ ¼å¼ä¹Ÿå¯ç”¨äºæ•´æ•°å’Œç¬¦æ–‡ï¼Œå®ƒä¼šäº§ç”Ÿä¸€ä¸ªå¸¦å•å¼•å·çš„ç¬¦æ–‡å¸¸é‡ã€‚ï¼‰ æ­¤å¤–ï¼Œ<code>%x</code> è¿˜å¯ç”¨äºå­—ç¬¦ä¸²ã€å­—èŠ‚æ•°ç»„ä»¥åŠæ•´æ•°ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªå¾ˆé•¿çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œ è€Œå¸¦ç©ºæ ¼çš„æ ¼å¼ï¼ˆ<code>% x</code>ï¼‰è¿˜ä¼šåœ¨å­—èŠ‚ä¹‹é—´æ’å…¥ç©ºæ ¼ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="97" data-paginate="true" data-theme="default" data-marpit-pagination="97" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å¦ä¸€ç§å®ç”¨çš„æ ¼å¼æ˜¯ <code>%T</code>ï¼Œå®ƒä¼šæ‰“å°æŸä¸ªå€¼çš„<strong>ç±»å‹</strong>ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>fmt.Printf(<span class="hljs-string">"%T\n"</span>, timeZone)
</span></span></foreignObject></svg></code></pre>
<p>ä¼šæ‰“å°</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">int</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="98" data-paginate="true" data-theme="default" data-marpit-pagination="98" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥ä½ æƒ³æ§åˆ¶è‡ªå®šä¹‰ç±»å‹çš„é»˜è®¤æ ¼å¼ï¼Œåªéœ€ä¸ºè¯¥ç±»å‹å®šä¹‰ä¸€ä¸ªå…·æœ‰ <code>String() string</code> ç­¾åçš„æ–¹æ³•ã€‚å¯¹äºæˆ‘ä»¬ç®€å•çš„ç±»å‹ <code>T</code>ï¼Œå¯è¿›è¡Œå¦‚ä¸‹æ“ä½œã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(t *T)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%d/%g/%q"</span>, t.a, t.b, t.c)
}
fmt.Printf(<span class="hljs-string">"%v\n"</span>, t)
</span></span></foreignObject></svg></code></pre>
<p>ä¼šæ‰“å°å‡ºå¦‚ä¸‹æ ¼å¼ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-number">7</span>/<span class="hljs-number">-2.35</span>/<span class="hljs-string">"abc\tdef"</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="99" data-paginate="true" data-theme="default" data-marpit-pagination="99" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ï¼ˆå¦‚æœä½ éœ€è¦åƒæŒ‡å‘ <code>T</code> çš„æŒ‡é’ˆé‚£æ ·æ‰“å°ç±»å‹ <code>T</code> çš„<strong>å€¼</strong>ï¼Œ <code>String</code> çš„æ¥æ”¶è€…å°±å¿…é¡»æ˜¯å€¼ç±»å‹çš„ï¼›ä¸Šé¢çš„ä¾‹å­ä¸­æ¥æ”¶è€…æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œ å› ä¸ºè¿™å¯¹ç»“æ„æ¥è¯´æ›´é«˜æ•ˆè€Œé€šç”¨ã€‚æ›´å¤šè¯¦æƒ…è§<a href="https://learnku.com/docs/effective-go/method/6245#20ffd5">æŒ‡é’ˆ vs. å€¼æ¥æ”¶è€…</a>ä¸€èŠ‚ï¼‰</p>
<p>æˆ‘ä»¬çš„ <code>String</code> æ–¹æ³•ä¹Ÿå¯è°ƒç”¨ <code>Sprintf</code>ï¼Œ å› ä¸ºæ‰“å°ä¾‹ç¨‹å¯ä»¥å®Œå…¨é‡å…¥å¹¶æŒ‰è¿™ç§æ–¹å¼å°è£…ã€‚ä¸è¿‡æœ‰ä¸€ä¸ªé‡è¦çš„ç»†èŠ‚ä½ éœ€è¦çŸ¥é“ï¼š è¯·å‹¿é€šè¿‡è°ƒç”¨ <code>Sprintf</code> æ¥æ„é€  <code>String</code> æ–¹æ³•ï¼Œå› ä¸ºå®ƒä¼šæ— é™é€’å½’ä½ çš„çš„ <code>String</code> æ–¹æ³•ã€‚å¦‚æœ <code>Sprintf</code> è°ƒç”¨è¯•å›¾å°†æ¥æ”¶å™¨ç›´æ¥æ‰“å°ä¸ºå­—ç¬¦ä¸²ï¼Œè€Œè¯¥å­—ç¬¦ä¸²åˆå°†å†æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ï¼Œå¦‚æœ¬ä¾‹æ‰€ç¤ºã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> MyString <span class="hljs-keyword">string</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m MyString)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"MyString=%s"</span>, m) <span class="hljs-comment">// é”™è¯¯ï¼šä¼šæ— é™é€’å½’</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="100" data-paginate="true" data-theme="default" data-marpit-pagination="100" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆç®€å•ï¼šå°†è¯¥å®å‚è½¬æ¢ä¸ºåŸºæœ¬çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå®ƒæ²¡æœ‰è¿™ä¸ªæ–¹æ³•ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> MyString <span class="hljs-keyword">string</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m MyString)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"MyString=%s"</span>, <span class="hljs-keyword">string</span>(m)) <span class="hljs-comment">// å¯ä»¥ï¼šæ³¨æ„è½¬æ¢</span>
}
</span></span></foreignObject></svg></code></pre>
<p>åœ¨ <a href="https://learnku.com/docs/effective-go/initialization/6244">åˆå§‹åŒ–</a> ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°é¿å…è¿™ç§é€’å½’çš„å¦ä¸€ç§æŠ€æœ¯ã€‚</p>
<p>å¦ä¸€ç§æ‰“å°æŠ€æœ¯å°±æ˜¯å°†æ‰“å°ä¾‹ç¨‹çš„å®å‚ç›´æ¥ä¼ å…¥å¦ä¸€ä¸ªè¿™æ ·çš„ä¾‹ç¨‹ã€‚<code>Printf</code> çš„ç­¾åä¸ºå…¶æœ€åçš„å®å‚ä½¿ç”¨äº† <code>...interface{}</code> ç±»å‹ï¼Œè¿™æ ·æ ¼å¼çš„åé¢å°±èƒ½å‡ºç°ä»»æ„æ•°é‡ï¼Œä»»æ„ç±»å‹çš„å½¢å‚äº†ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Printf</span><span class="hljs-params">(format <span class="hljs-keyword">string</span>, v ...<span class="hljs-keyword">interface</span>{})</span> <span class="hljs-params">(n <span class="hljs-keyword">int</span>, err error)</span></span> {
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="101" data-paginate="true" data-theme="default" data-marpit-pagination="101" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åœ¨ <code>Printf</code> å‡½æ•°ä¸­ï¼Œ<code>v</code> çœ‹èµ·æ¥æ›´åƒæ˜¯ <code>[]interface{}</code> ç±»å‹çš„å˜é‡ï¼Œä½†å¦‚æœå°†å®ƒä¼ é€’åˆ°å¦ä¸€ä¸ªå˜å‚å‡½æ•°ä¸­ï¼Œå®ƒå°±åƒæ˜¯å¸¸è§„å®å‚åˆ—è¡¨äº†ã€‚ ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä¹‹å‰ç”¨è¿‡çš„ <code>log.Println</code> çš„å®ç°ã€‚å®ƒç›´æ¥å°†å…¶å®å‚ä¼ é€’ç»™ <code>fmt.Sprintln</code> è¿›è¡Œå®é™…çš„æ ¼å¼åŒ–ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// Println é€šè¿‡ fmt.Println çš„æ–¹å¼å°†æ—¥å¿—æ‰“å°åˆ°æ ‡å‡†è®°å½•å™¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Println</span><span class="hljs-params">(v ...<span class="hljs-keyword">interface</span>{})</span></span> {
    std.Output(<span class="hljs-number">2</span>, fmt.Sprintln(v...))  <span class="hljs-comment">// Output takes parameters (int, string)</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="102" data-paginate="true" data-theme="default" data-marpit-pagination="102" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åœ¨è¯¥ <code>Sprintln</code> åµŒå¥—è°ƒç”¨ä¸­ï¼Œæˆ‘ä»¬å°† <code>...</code> å†™åœ¨ <code>v</code> ä¹‹åæ¥å‘Šè¯‰ç¼–è¯‘å™¨å°† <code>v</code> è§†ä½œä¸€ä¸ªå®å‚åˆ—è¡¨ï¼Œå¦åˆ™å®ƒä¼šå°† <code>v</code> å½“åšå•ä¸€çš„åˆ‡ç‰‡å®å‚æ¥ä¼ é€’ã€‚</p>
<p>è¿˜æœ‰å¾ˆå¤šå…³äºæ‰“å°çŸ¥è¯†ç‚¹æ²¡æœ‰æåŠã€‚è¯¦æƒ…è¯·å‚é˜… <code>godoc</code> å¯¹ <code>fmt</code> åŒ…çš„è¯´æ˜æ–‡æ¡£ã€‚</p>
<p>é¡ºä¾¿ä¸€æï¼Œ<code>...</code> å½¢å‚å¯æŒ‡å®šå…·ä½“çš„ç±»å‹ï¼Œä¾‹å¦‚ä»æ•´æ•°åˆ—è¡¨ä¸­é€‰å‡ºæœ€å°å€¼çš„å‡½æ•° <code>min</code>ï¼Œå…¶å½¢å‚å¯ä¸º <code>...int</code> ç±»å‹ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Min</span><span class="hljs-params">(a ...<span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> {
    min := <span class="hljs-keyword">int</span>(^<span class="hljs-keyword">uint</span>(<span class="hljs-number">0</span>) &gt;&gt; <span class="hljs-number">1</span>)  <span class="hljs-comment">// æœ€å¤§çš„ int</span>
    <span class="hljs-keyword">for</span> _, i := <span class="hljs-keyword">range</span> a {
        <span class="hljs-keyword">if</span> i &lt; min {
            min = i
        }
    }
    <span class="hljs-keyword">return</span> min
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="103" data-paginate="true" data-theme="default" data-marpit-pagination="103" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>è¿½åŠ </h3>
<p>ç°åœ¨æˆ‘ä»¬è¦å¯¹å†…å»ºå‡½æ•° <code>append</code> çš„è®¾è®¡è¿›è¡Œè¡¥å……è¯´æ˜ã€‚<code>append</code> å‡½æ•°çš„ç­¾åä¸åŒäºå‰é¢æˆ‘ä»¬è‡ªå®šä¹‰çš„ <code>Append</code> å‡½æ•°ã€‚å¤§è‡´æ¥è¯´ï¼Œå®ƒå°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">append</span><span class="hljs-params">(slice []T, elements ...T)</span> []<span class="hljs-title">T</span></span>
</span></span></foreignObject></svg></code></pre>
<p>å…¶ä¸­çš„ <em>T</em> ä¸ºä»»æ„ç»™å®šç±»å‹çš„å ä½ç¬¦ã€‚å®é™…ä¸Šï¼Œä½ æ— æ³•åœ¨ Go ä¸­ç¼–å†™ä¸€ä¸ªç±»å‹ <code>T</code> ç”±è°ƒç”¨è€…å†³å®šçš„å‡½æ•°ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä½• <code>append</code> ä¸ºå†…å»ºå‡½æ•°çš„åŸå› ï¼šå®ƒéœ€è¦ç¼–è¯‘å™¨çš„æ”¯æŒã€‚</p>
<p><code>append</code> ä¼šåœ¨åˆ‡ç‰‡æœ«å°¾è¿½åŠ å…ƒç´ å¹¶è¿”å›ç»“æœã€‚æˆ‘ä»¬å¿…é¡»è¿”å›ç»“æœï¼Œ åŸå› ä¸æˆ‘ä»¬æ‰‹å†™çš„ <code>Append</code> ä¸€æ ·ï¼Œå³åº•å±‚æ•°ç»„å¯èƒ½ä¼šè¢«æ”¹å˜ã€‚ä»¥ä¸‹ç®€å•çš„ä¾‹å­</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>x := []<span class="hljs-keyword">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>}
x = <span class="hljs-built_in">append</span>(x, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>)
fmt.Println(x)
</span></span></foreignObject></svg></code></pre>
<p>å°†æ‰“å° <code>[1 2 3 4 5 6]</code>ã€‚å› æ­¤ <code>append</code> æœ‰ç‚¹åƒ <code>Printf</code> é‚£æ ·ï¼Œå¯æ¥å—ä»»æ„æ•°é‡çš„å®å‚ã€‚</p>
<p>ä½†å¦‚æœæˆ‘ä»¬è¦åƒ <code>Append</code> é‚£æ ·å°†ä¸€ä¸ªåˆ‡ç‰‡è¿½åŠ åˆ°å¦ä¸€ä¸ªåˆ‡ç‰‡ä¸­å‘¢ï¼Ÿ å¾ˆç®€å•ï¼šåœ¨è°ƒç”¨çš„åœ°æ–¹ä½¿ç”¨ <code>...</code>ï¼Œå°±åƒæˆ‘ä»¬åœ¨ä¸Šé¢è°ƒç”¨ <code>Output</code> é‚£æ ·ã€‚ä»¥ä¸‹ä»£ç ç‰‡æ®µçš„è¾“å‡ºä¸ä¸Šä¸€ä¸ªç›¸åŒã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>x := []<span class="hljs-keyword">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>}
y := []<span class="hljs-keyword">int</span>{<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>}
x = <span class="hljs-built_in">append</span>(x, y...)
fmt.Println(x)
</span></span></foreignObject></svg></code></pre>
<p>å¦‚æœæ²¡æœ‰ <code>...</code>ï¼Œå®ƒå°±ä¼šç”±äºç±»å‹é”™è¯¯è€Œæ— æ³•ç¼–è¯‘ï¼Œå› ä¸º <code>y</code> ä¸æ˜¯ <code>int</code> ç±»å‹çš„ã€‚</p>
<h2>åˆå§‹åŒ–</h2>
<p>å°½ç®¡ä»è¡¨é¢ä¸Šçœ‹ï¼ŒGo çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸ C æˆ– C++ å·®åˆ«å¹¶ä¸ç®—å¤ªå¤§ï¼Œä½†å®ƒç¡®å®æ›´ä¸ºå¼ºå¤§ã€‚ åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œä¸ä»…å¯ä»¥æ„å»ºå¤æ‚çš„ç»“æ„ï¼Œè¿˜èƒ½æ­£ç¡®å¤„ç†ä¸åŒåŒ…å¯¹è±¡é—´çš„åˆå§‹åŒ–é¡ºåºã€‚</p>
<h3>å¸¸é‡</h3>
<p>Go ä¸­çš„å¸¸é‡å°±æ˜¯ä¸å˜é‡ã€‚å®ƒä»¬åœ¨ç¼–è¯‘æ—¶åˆ›å»ºï¼Œå³ä¾¿å®ƒä»¬å¯èƒ½æ˜¯å‡½æ•°ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡ã€‚ å¸¸é‡åªèƒ½æ˜¯æ•°å­—ã€å­—ç¬¦ï¼ˆç¬¦æ–‡ï¼‰ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼ã€‚ç”±äºç¼–è¯‘æ—¶çš„é™åˆ¶ï¼Œ å®šä¹‰å®ƒä»¬çš„è¡¨è¾¾å¼å¿…é¡»ä¹Ÿæ˜¯å¯è¢«ç¼–è¯‘å™¨æ±‚å€¼çš„å¸¸é‡è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ <code>1&lt;&lt;3</code> å°±æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼Œè€Œ <code>math.Sin(math.Pi/4)</code> åˆ™ä¸æ˜¯ï¼Œå› ä¸ºå¯¹ <code>math.Sin</code> çš„å‡½æ•°è°ƒç”¨åœ¨è¿è¡Œæ—¶æ‰ä¼šå‘ç”Ÿã€‚</p>
<p>åœ¨ Go ä¸­ï¼Œæšä¸¾å¸¸é‡ä½¿ç”¨æšä¸¾å™¨ <code>iota</code> åˆ›å»ºã€‚ç”±äº <code>iota</code> å¯ä¸ºè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œè€Œè¡¨è¾¾å¼å¯ä»¥è¢«éšå¼åœ°é‡å¤ï¼Œè¿™æ ·ä¹Ÿå°±æ›´å®¹æ˜“æ„å»ºå¤æ‚çš„å€¼çš„é›†åˆäº†ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> ByteSize <span class="hljs-keyword">float64</span>

<span class="hljs-keyword">const</span> (
    _           = <span class="hljs-literal">iota</span> <span class="hljs-comment">// é€šè¿‡èµ‹äºˆç©ºç™½æ ‡è¯†ç¬¦æ¥å¿½ç•¥ç¬¬ä¸€ä¸ªå€¼</span>
    KB ByteSize = <span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">10</span> * <span class="hljs-literal">iota</span>)
    MB
    GB
    TB
    PB
    EB
    ZB
    YB
)
</span></span></foreignObject></svg></code></pre>
<p>ç”±äºå¯å°† <code>String</code> ä¹‹ç±»çš„æ–¹æ³•é™„åŠ åœ¨ç”¨æˆ·å®šä¹‰çš„ç±»å‹ä¸Šï¼Œ å› æ­¤å®ƒå°±ä¸ºæ‰“å°æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ä»»æ„å€¼æä¾›äº†å¯èƒ½æ€§ï¼Œå³ä¾¿æ˜¯ä½œä¸ºä¸€ä¸ªé€šç”¨ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚ å°½ç®¡ä½ å¸¸å¸¸ä¼šçœ‹åˆ°è¿™ç§æŠ€æœ¯åº”ç”¨äºç»“æ„ä½“ï¼Œä½†å®ƒå¯¹äºåƒ <code>ByteSize</code> ä¹‹ç±»çš„æµ®ç‚¹æ•°æ ‡é‡ç­‰ç±»å‹ä¹Ÿæ˜¯æœ‰ç”¨çš„ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(b ByteSize)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">switch</span> {
    <span class="hljs-keyword">case</span> b &gt;= YB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fYB"</span>, b/YB)
    <span class="hljs-keyword">case</span> b &gt;= ZB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fZB"</span>, b/ZB)
    <span class="hljs-keyword">case</span> b &gt;= EB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fEB"</span>, b/EB)
    <span class="hljs-keyword">case</span> b &gt;= PB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fPB"</span>, b/PB)
    <span class="hljs-keyword">case</span> b &gt;= TB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fTB"</span>, b/TB)
    <span class="hljs-keyword">case</span> b &gt;= GB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fGB"</span>, b/GB)
    <span class="hljs-keyword">case</span> b &gt;= MB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fMB"</span>, b/MB)
    <span class="hljs-keyword">case</span> b &gt;= KB:
        <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fKB"</span>, b/KB)
    }
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2fB"</span>, b)
}
</span></span></foreignObject></svg></code></pre>
<p>è¡¨è¾¾å¼ <code>YB</code> ä¼šæ‰“å°å‡º <code>1.00YB</code>ï¼Œè€Œ <code>ByteSize(1e13)</code> åˆ™ä¼šæ‰“å°å‡º <code>9.09</code>ã€‚</p>
<p>åœ¨è¿™é‡Œç”¨ <code>Sprintf</code> å®ç° <code>ByteSize</code> çš„ <code>String</code> æ–¹æ³•å¾ˆå®‰å…¨ï¼ˆä¸ä¼šæ— é™é€’å½’ï¼‰ï¼Œè¿™å€’ä¸æ˜¯å› ä¸ºç±»å‹è½¬æ¢ï¼Œè€Œæ˜¯å®ƒä»¥ <code>%f</code> è°ƒç”¨äº† <code>Sprintf</code>ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ç§å­—ç¬¦ä¸²æ ¼å¼ï¼š<code>Sprintf</code> åªä¼šåœ¨å®ƒéœ€è¦å­—ç¬¦ä¸²æ—¶æ‰è°ƒç”¨ <code>String</code> æ–¹æ³•ï¼Œè€Œ <code>%f</code> éœ€è¦ä¸€ä¸ªæµ®ç‚¹æ•°å€¼ã€‚</p>
<h3>å˜é‡</h3>
<p>å˜é‡èƒ½åƒå¸¸é‡ä¸€æ ·åˆå§‹åŒ–ï¼Œè€Œä¸”å¯ä»¥åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¯åœ¨è¿è¡Œæ—¶å¾—å‡ºç»“æœçš„æ™®é€šè¡¨è¾¾å¼ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> (
    home   = os.Getenv(<span class="hljs-string">"HOME"</span>)
    user   = os.Getenv(<span class="hljs-string">"USER"</span>)
    gopath = os.Getenv(<span class="hljs-string">"GOPATH"</span>)
)
</span></span></foreignObject></svg></code></pre>
<h3>init å‡½æ•°</h3>
<p>æœ€åï¼Œæ¯ä¸ªæºæ–‡ä»¶éƒ½å¯ä»¥é€šè¿‡å®šä¹‰è‡ªå·±çš„æ— å‚æ•° <code>init</code> å‡½æ•°æ¥è®¾ç½®ä¸€äº›å¿…è¦çš„çŠ¶æ€ã€‚ ï¼ˆå…¶å®æ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥æ‹¥æœ‰å¤šä¸ª <code>init</code> å‡½æ•°ã€‚ï¼‰è€Œå®ƒçš„ç»“æŸå°±æ„å‘³ç€åˆå§‹åŒ–ç»“æŸï¼š åªæœ‰è¯¥åŒ…ä¸­çš„æ‰€æœ‰å˜é‡å£°æ˜éƒ½é€šè¿‡å®ƒä»¬çš„åˆå§‹åŒ–å™¨æ±‚å€¼å <code>init</code> æ‰ä¼šè¢«è°ƒç”¨ï¼Œ è€Œé‚£äº› <code>init</code> åªæœ‰åœ¨æ‰€æœ‰å·²å¯¼å…¥çš„åŒ…éƒ½è¢«åˆå§‹åŒ–åæ‰ä¼šè¢«æ±‚å€¼ã€‚</p>
<p>é™¤äº†é‚£äº›ä¸èƒ½è¢«è¡¨ç¤ºæˆå£°æ˜çš„åˆå§‹åŒ–å¤–ï¼Œ<code>init</code> å‡½æ•°è¿˜å¸¸è¢«ç”¨åœ¨ç¨‹åºçœŸæ­£å¼€å§‹æ‰§è¡Œå‰ï¼Œæ£€éªŒæˆ–æ ¡æ­£ç¨‹åºçš„çŠ¶æ€ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">if</span> user == <span class="hljs-string">""</span> {
        log.Fatal(<span class="hljs-string">"$USER not set"</span>)
    }
    <span class="hljs-keyword">if</span> home == <span class="hljs-string">""</span> {
        home = <span class="hljs-string">"/home/"</span> + user
    }
    <span class="hljs-keyword">if</span> gopath == <span class="hljs-string">""</span> {
        gopath = home + <span class="hljs-string">"/go"</span>
    }
    <span class="hljs-comment">// gopath å¯é€šè¿‡å‘½ä»¤è¡Œä¸­çš„ --gopath æ ‡è®°è¦†ç›–æ‰ã€‚</span>
    flag.StringVar(&amp;gopath, <span class="hljs-string">"gopath"</span>, gopath, <span class="hljs-string">"override default GOPATH"</span>)
}
</span></span></foreignObject></svg></code></pre>
<h2>æ–¹æ³•</h2>
<h3>æŒ‡é’ˆ vs. å€¼</h3>
<p>æ­£å¦‚ <code>ByteSize</code> é‚£æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä»»ä½•å·²å‘½åçš„ç±»å‹ï¼ˆé™¤äº†æŒ‡é’ˆæˆ–æ¥å£ï¼‰å®šä¹‰æ–¹æ³•ï¼› æ¥æ”¶è€…å¯ä¸å¿…ä¸ºç»“æ„ä½“ã€‚</p>
<p>åœ¨ä¹‹å‰è®¨è®ºåˆ‡ç‰‡æ—¶ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ª <code>Append</code> å‡½æ•°ã€‚ æˆ‘ä»¬ä¹Ÿå¯å°†å…¶å®šä¹‰ä¸ºåˆ‡ç‰‡çš„æ–¹æ³•ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å£°æ˜ä¸€ä¸ªå·²å‘½åçš„ç±»å‹æ¥ç»‘å®šè¯¥æ–¹æ³•ï¼Œ ç„¶åä½¿è¯¥æ–¹æ³•çš„æ¥æ”¶è€…æˆä¸ºè¯¥ç±»å‹çš„å€¼ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> ByteSlice []<span class="hljs-keyword">byte</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(slice ByteSlice)</span> <span class="hljs-title">Append</span><span class="hljs-params">(data []<span class="hljs-keyword">byte</span>)</span> []<span class="hljs-title">byte</span></span> {
    <span class="hljs-comment">// ä¸»ä½“ä¸ä¸Šé¢å®šä¹‰çš„Appendå‡½æ•°å®Œå…¨ç›¸åŒã€‚</span>
}
</span></span></foreignObject></svg></code></pre>
<p>æˆ‘ä»¬ä»ç„¶éœ€è¦è¯¥æ–¹æ³•è¿”å›æ›´æ–°åçš„åˆ‡ç‰‡ã€‚ä¸ºäº†æ¶ˆé™¤è¿™ç§ä¸ä¾¿ï¼Œæˆ‘ä»¬å¯é€šè¿‡é‡æ–°å®šä¹‰è¯¥æ–¹æ³•ï¼Œ å°†ä¸€ä¸ªæŒ‡å‘ <code>ByteSlice</code> çš„<strong>æŒ‡é’ˆ</strong>ä½œä¸ºè¯¥æ–¹æ³•çš„æ¥æ”¶è€…ï¼Œ è¿™æ ·è¯¥æ–¹æ³•å°±èƒ½é‡å†™è°ƒç”¨è€…æä¾›çš„åˆ‡ç‰‡äº†ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p *ByteSlice)</span> <span class="hljs-title">Append</span><span class="hljs-params">(data []<span class="hljs-keyword">byte</span>)</span></span> {
    slice := *p
    <span class="hljs-comment">// ä¸»ä½“åŒä¸Šï¼Œåªæ˜¯æ²¡æœ‰è¿”å›å€¼</span>
    *p = slice
}
</span></span></foreignObject></svg></code></pre>
<p>å…¶å®æˆ‘ä»¬åšå¾—æ›´å¥½ã€‚è‹¥æˆ‘ä»¬å°†å‡½æ•°ä¿®æ”¹ä¸ºä¸æ ‡å‡† <code>Write</code> ç±»ä¼¼çš„æ–¹æ³•ï¼Œå°±åƒè¿™æ ·ï¼Œ</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p *ByteSlice)</span> <span class="hljs-title">Write</span><span class="hljs-params">(data []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-params">(n <span class="hljs-keyword">int</span>, err error)</span></span> {
    slice := *p
    <span class="hljs-comment">// åŒä¸Šã€‚</span>
    *p = slice
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(data), <span class="hljs-literal">nil</span>
}
</span></span></foreignObject></svg></code></pre>
<p>é‚£ä¹ˆç±»å‹ <code>*ByteSlice</code> å°±æ»¡è¶³äº†æ ‡å‡†çš„ <code>io.Writer</code> æ¥å£ï¼Œè¿™å°†éå¸¸å®ç”¨ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰“å°å°†å†…å®¹å†™å…¥ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>    <span class="hljs-keyword">var</span> b ByteSlice
    fmt.Fprintf(&amp;b, <span class="hljs-string">"This hour has %d days\n"</span>, <span class="hljs-number">7</span>)
</span></span></foreignObject></svg></code></pre>
<p>æˆ‘ä»¬å°† <code>ByteSlice</code> çš„åœ°å€ä¼ å…¥ï¼Œå› ä¸ºåªæœ‰ <code>*ByteSlice</code> æ‰æ»¡è¶³ <code>io.Writer</code>ã€‚ä»¥æŒ‡é’ˆæˆ–å€¼ä¸ºæ¥æ”¶è€…çš„åŒºåˆ«åœ¨äºï¼šå€¼æ–¹æ³•å¯é€šè¿‡æŒ‡é’ˆå’Œå€¼è°ƒç”¨ï¼Œ è€ŒæŒ‡é’ˆæ–¹æ³•åªèƒ½é€šè¿‡æŒ‡é’ˆæ¥è°ƒç”¨ã€‚</p>
<p>ä¹‹æ‰€ä»¥ä¼šæœ‰è¿™æ¡è§„åˆ™æ˜¯å› ä¸ºæŒ‡é’ˆæ–¹æ³•å¯ä»¥ä¿®æ”¹æ¥æ”¶è€…ï¼›é€šè¿‡å€¼è°ƒç”¨å®ƒä»¬ä¼šå¯¼è‡´æ–¹æ³•æ¥æ”¶åˆ°è¯¥å€¼çš„å‰¯æœ¬ï¼Œ å› æ­¤ä»»ä½•ä¿®æ”¹éƒ½å°†è¢«ä¸¢å¼ƒï¼Œå› æ­¤è¯¥è¯­è¨€ä¸å…è®¸è¿™ç§é”™è¯¯ã€‚ä¸è¿‡æœ‰ä¸ªæ–¹ä¾¿çš„ä¾‹å¤–ï¼šè‹¥è¯¥å€¼æ˜¯å¯å¯»å€çš„ï¼Œ é‚£ä¹ˆè¯¥è¯­è¨€å°±ä¼šè‡ªåŠ¨æ’å…¥å–å€æ“ä½œç¬¦æ¥å¯¹ä»˜ä¸€èˆ¬çš„é€šè¿‡å€¼è°ƒç”¨çš„æŒ‡é’ˆæ–¹æ³•ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå˜é‡ <code>b</code> æ˜¯å¯å¯»å€çš„ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€é€šè¿‡ <code>b.Write</code> æ¥è°ƒç”¨å®ƒçš„ <code>Write</code> æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šå°†å®ƒé‡å†™ä¸º <code>(&amp;b).Write</code>ã€‚</p>
<p>é¡ºä¾¿ä¸€æï¼Œåœ¨å­—èŠ‚åˆ‡ç‰‡ä¸Šä½¿ç”¨ <code>Write</code> çš„æƒ³æ³•å·²è¢« <code>bytes.Buffer</code> æ‰€å®ç°ã€‚</p>
<h2>æ¥å£ä¸å…¶å®ƒç±»å‹</h2>
<h3>æ¥å£</h3>
<p>Go ä¸­çš„æ¥å£ä¸ºæŒ‡å®šå¯¹è±¡çš„è¡Œä¸ºæä¾›äº†ä¸€ç§æ–¹æ³•ï¼šå¦‚æœæŸæ ·ä¸œè¥¿å¯ä»¥å®Œæˆ<strong>è¿™ä¸ª</strong>ï¼Œ é‚£ä¹ˆå®ƒå°±å¯ä»¥ç”¨åœ¨<strong>è¿™é‡Œ</strong>ã€‚æˆ‘ä»¬å·²ç»è§è¿‡è®¸å¤šç®€å•çš„ç¤ºä¾‹äº†ï¼›é€šè¿‡å®ç° <code>String</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ‰“å°å‡½æ•°ï¼Œè€Œé€šè¿‡ <code>Write</code> æ–¹æ³•ï¼Œ<code>Fprintf</code> åˆ™èƒ½å¯¹ä»»ä½•å¯¹è±¡äº§ç”Ÿè¾“å‡ºã€‚åœ¨ Go ä»£ç ä¸­ï¼Œ ä»…åŒ…å«ä¸€ä¸¤ç§æ–¹æ³•çš„æ¥å£å¾ˆå¸¸è§ï¼Œä¸”å…¶åç§°é€šå¸¸æ¥è‡ªäºå®ç°å®ƒçš„æ–¹æ³•ï¼Œ å¦‚ <code>io.Writer</code> å°±æ˜¯å®ç°äº† <code>Write</code> çš„ä¸€ç±»å¯¹è±¡ã€‚</p>
<p>æ¯ç§ç±»å‹éƒ½èƒ½å®ç°å¤šä¸ªæ¥å£ã€‚ä¾‹å¦‚ä¸€ä¸ªå®ç°äº† <code>sort.Interface</code> æ¥å£çš„é›†åˆå°±å¯é€šè¿‡ <code>sort</code> åŒ…ä¸­çš„ä¾‹ç¨‹è¿›è¡Œæ’åºã€‚è¯¥æ¥å£åŒ…æ‹¬ <code>Len()</code>ã€<code>Less(i, j int) bool</code> ä»¥åŠ <code>Swap(i, j int)</code>ï¼Œå¦å¤–ï¼Œè¯¥é›†åˆä»ç„¶å¯ä»¥æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„æ ¼å¼åŒ–å™¨ã€‚ ä»¥ä¸‹ç‰¹æ„æ„å»ºçš„ä¾‹å­ <code>Sequence</code> å°±åŒæ—¶æ»¡è¶³è¿™ä¸¤ç§æƒ…å†µã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Sequence []<span class="hljs-keyword">int</span>

<span class="hljs-comment">// sort.Interfaceæ‰€éœ€çš„æ–¹æ³•ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Sequence)</span> <span class="hljs-title">Len</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(s)
}
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Sequence)</span> <span class="hljs-title">Less</span><span class="hljs-params">(i, j <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> {
    <span class="hljs-keyword">return</span> s[i] &lt; s[j]
}
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Sequence)</span> <span class="hljs-title">Swap</span><span class="hljs-params">(i, j <span class="hljs-keyword">int</span>)</span></span> {
    s[i], s[j] = s[j], s[i]
}

<span class="hljs-comment">// Copyæ–¹æ³•è¿”å›Sequenceçš„å¤åˆ¶</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Sequence)</span> <span class="hljs-title">Copy</span><span class="hljs-params">()</span> <span class="hljs-title">Sequence</span></span> {
    <span class="hljs-built_in">copy</span> := <span class="hljs-built_in">make</span>(Sequence, <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(s))
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">append</span>(<span class="hljs-built_in">copy</span>, s...)
}

<span class="hljs-comment">// æ‰“å°æ–¹æ³•-åœ¨æ‰“å°å‰ç»™å…ƒç´ æ’åº</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Sequence)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    s = s.Copy() <span class="hljs-comment">// å¤åˆ¶sï¼Œä¸è¦è¦†ç›–å‚æ•°æœ¬èº«</span>
    sort.Sort(s)
    str := <span class="hljs-string">"["</span>
    <span class="hljs-keyword">for</span> i, elem := <span class="hljs-keyword">range</span> s { <span class="hljs-comment">// Loopç©ºé—´å¤æ‚åº¦æ˜¯O(NÂ²)ï¼›å°†åœ¨ä¸‹ä¸ªä¾‹å­ä¸­ä¿®å¤å®ƒ</span>
        <span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span> {
            str += <span class="hljs-string">" "</span>
        }
        str += fmt.Sprint(elem)
    }
    <span class="hljs-keyword">return</span> str + <span class="hljs-string">"]"</span>
}
</span></span></foreignObject></svg></code></pre>
<h3>ç±»å‹è½¬æ¢</h3>
<p><code>Sequence</code> çš„ <code>String</code> æ–¹æ³•é‡æ–°å®ç°äº† <code>Sprint</code> ä¸ºåˆ‡ç‰‡å®ç°çš„åŠŸèƒ½ã€‚è‹¥æˆ‘ä»¬åœ¨è°ƒç”¨ <code>Sprint</code> ä¹‹å‰å°† <code>Sequence</code> è½¬æ¢ä¸ºçº¯ç²¹çš„ <code>[]int</code>ï¼Œå°±èƒ½å…±äº«å·²å®ç°çš„åŠŸèƒ½ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Sequence)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    s = s.Copy()
    sort.Sort(s)
    <span class="hljs-keyword">return</span> fmt.Sprint([]<span class="hljs-keyword">int</span>(s))
}
</span></span></foreignObject></svg></code></pre>
<p>è¯¥æ–¹æ³•æ˜¯é€šè¿‡ç±»å‹è½¬æ¢æŠ€æœ¯ï¼Œåœ¨ <code>String</code> æ–¹æ³•ä¸­å®‰å…¨è°ƒç”¨ <code>Sprintf</code> çš„å¦ä¸ªä¸€ä¾‹å­ã€‚è‹¥æˆ‘ä»¬å¿½ç•¥ç±»å‹åçš„è¯ï¼Œè¿™ä¸¤ç§ç±»å‹ï¼ˆ<code>Sequence</code> å’Œ <code>[]int</code>ï¼‰å…¶å®æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤åœ¨äºŒè€…ä¹‹é—´è¿›è¡Œè½¬æ¢æ˜¯åˆæ³•çš„ã€‚ è½¬æ¢è¿‡ç¨‹å¹¶ä¸ä¼šåˆ›å»ºæ–°å€¼ï¼Œå®ƒåªæ˜¯å€¼æš‚è®©ç°æœ‰çš„æ—¶çœ‹èµ·æ¥æœ‰ä¸ªæ–°ç±»å‹è€Œå·²ã€‚ ï¼ˆè¿˜æœ‰äº›åˆæ³•è½¬æ¢åˆ™ä¼šåˆ›å»ºæ–°å€¼ï¼Œå¦‚ä»æ•´æ•°è½¬æ¢ä¸ºæµ®ç‚¹æ•°ç­‰ã€‚ï¼‰</p>
<p>åœ¨ Go ç¨‹åºä¸­ï¼Œä¸ºè®¿é—®ä¸åŒçš„æ–¹æ³•é›†è€Œè¿›è¡Œç±»å‹è½¬æ¢çš„æƒ…å†µéå¸¸å¸¸è§ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä½¿ç”¨ç°æœ‰çš„ <code>sort.IntSlice</code> ç±»å‹æ¥ç®€åŒ–æ•´ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Sequence []<span class="hljs-keyword">int</span>

<span class="hljs-comment">// æ‰“å°æ–¹æ³•-åœ¨æ‰“å°ä¹‹å‰å¯¹å…ƒç´ è¿›è¡Œæ’åº</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Sequence)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    s = s.Copy()
    sort.IntSlice(s).Sort()
    <span class="hljs-keyword">return</span> fmt.Sprint([]<span class="hljs-keyword">int</span>(s))
}
</span></span></foreignObject></svg></code></pre>
<p>ç°åœ¨ï¼Œä¸å¿…è®© <code>Sequence</code> å®ç°å¤šä¸ªæ¥å£ï¼ˆæ’åºå’Œæ‰“å°ï¼‰ï¼Œ æˆ‘ä»¬å¯é€šè¿‡å°†æ•°æ®æ¡ç›®è½¬æ¢ä¸ºå¤šç§ç±»å‹ï¼ˆ<code>Sequence</code>ã€<code>sort.IntSlice</code> å’Œ <code>[]int</code>ï¼‰æ¥ä½¿ç”¨ç›¸åº”çš„åŠŸèƒ½ï¼Œæ¯æ¬¡è½¬æ¢éƒ½å®Œæˆä¸€éƒ¨åˆ†å·¥ä½œã€‚ è¿™åœ¨å®è·µä¸­è™½ç„¶æœ‰äº›ä¸åŒå¯»å¸¸ï¼Œä½†å¾€å¾€å´å¾ˆæœ‰æ•ˆã€‚</p>
<h3>æ¥å£è½¬æ¢ä¸ç±»å‹æ–­è¨€</h3>
<p><a href="https://learnku.com/docs/effective-go/control-structure/6241#bca1f2">ç±»å‹é€‰æ‹©</a> æ˜¯ç±»å‹è½¬æ¢çš„ä¸€ç§å½¢å¼ï¼šå®ƒæ¥å—ä¸€ä¸ªæ¥å£ï¼Œåœ¨é€‰æ‹© ï¼ˆswitchï¼‰ä¸­æ ¹æ®å…¶åˆ¤æ–­é€‰æ‹©å¯¹åº”çš„æƒ…å†µï¼ˆcaseï¼‰ï¼Œ å¹¶åœ¨æŸç§æ„ä¹‰ä¸Šå°†å…¶è½¬æ¢ä¸ºè¯¥ç§ç±»å‹ã€‚ä»¥ä¸‹ä»£ç ä¸º <code>fmt.Printf</code> é€šè¿‡ç±»å‹é€‰æ‹©å°†å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„ç®€åŒ–ç‰ˆã€‚è‹¥å®ƒå·²ç»ä¸ºå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦è¯¥æ¥å£ä¸­å®é™…çš„å­—ç¬¦ä¸²å€¼ï¼› è‹¥å®ƒæœ‰ String æ–¹æ³•ï¼Œæˆ‘ä»¬åˆ™éœ€è¦è°ƒç”¨è¯¥æ–¹æ³•æ‰€å¾—çš„ç»“æœã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Stringer <span class="hljs-keyword">interface</span> {
    String() <span class="hljs-keyword">string</span>
}

<span class="hljs-keyword">var</span> value <span class="hljs-keyword">interface</span>{} <span class="hljs-comment">// Value ç”±è°ƒç”¨è€…æä¾›</span>
<span class="hljs-keyword">switch</span> str := value.(<span class="hljs-keyword">type</span>) {
<span class="hljs-keyword">case</span> <span class="hljs-keyword">string</span>:
    <span class="hljs-keyword">return</span> str
<span class="hljs-keyword">case</span> Stringer:
    <span class="hljs-keyword">return</span> str.String()
}
</span></span></foreignObject></svg></code></pre>
<p>ç¬¬ä¸€ç§æƒ…å†µè·å–å…·ä½“çš„å€¼ï¼Œç¬¬äºŒç§å°†è¯¥æ¥å£è½¬æ¢ä¸ºå¦ä¸€ä¸ªæ¥å£ã€‚è¿™ç§æ–¹å¼å¯¹äºæ··åˆç±»å‹æ¥è¯´éå¸¸å®Œç¾ã€‚</p>
<p>è‹¥æˆ‘ä»¬åªå…³å¿ƒä¸€ç§ç±»å‹å‘¢ï¼Ÿè‹¥æˆ‘ä»¬çŸ¥é“è¯¥å€¼æ‹¥æœ‰ä¸€ä¸ª <code>string</code> è€Œæƒ³è¦æå–å®ƒå‘¢ï¼Ÿ åªéœ€ä¸€ç§æƒ…å†µçš„ç±»å‹é€‰æ‹©å°±è¡Œï¼Œä½†å®ƒéœ€è¦<strong>ç±»å‹æ–­è¨€</strong>ã€‚ç±»å‹æ–­è¨€æ¥å—ä¸€ä¸ªæ¥å£å€¼ï¼Œ å¹¶ä»ä¸­æå–æŒ‡å®šçš„æ˜ç¡®ç±»å‹çš„å€¼ã€‚å…¶è¯­æ³•å€Ÿé‰´è‡ªç±»å‹é€‰æ‹©å¼€å¤´çš„å­å¥ï¼Œä½†å®ƒéœ€è¦ä¸€ä¸ªæ˜ç¡®çš„ç±»å‹ï¼Œ è€Œé <code>type</code> å…³é”®å­—ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>value.(typeName)
</span></span></foreignObject></svg></code></pre>
<p>è€Œå…¶ç»“æœåˆ™æ˜¯æ‹¥æœ‰é™æ€ç±»å‹ <code>typeName</code> çš„æ–°å€¼ã€‚è¯¥ç±»å‹å¿…é¡»ä¸ºè¯¥æ¥å£æ‰€æ‹¥æœ‰çš„å…·ä½“ç±»å‹ï¼Œ æˆ–è€…è¯¥å€¼å¯è½¬æ¢æˆçš„ç¬¬äºŒç§æ¥å£ç±»å‹ã€‚è¦æå–æˆ‘ä»¬çŸ¥é“åœ¨è¯¥å€¼ä¸­çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥è¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>str := value.(<span class="hljs-keyword">string</span>)
</span></span></foreignObject></svg></code></pre>
<p>ä½†è‹¥å®ƒæ‰€è½¬æ¢çš„å€¼ä¸­ä¸åŒ…å«å­—ç¬¦ä¸²ï¼Œè¯¥ç¨‹åºå°±ä¼šä»¥è¿è¡Œæ—¶é”™è¯¯å´©æºƒã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œ éœ€ä½¿ç”¨ â€œé€—å·ï¼Œokâ€ æƒ¯ç”¨æµ‹è¯•å®ƒèƒ½å®‰å…¨åœ°åˆ¤æ–­è¯¥å€¼æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>str, ok := value.(<span class="hljs-keyword">string</span>)
<span class="hljs-keyword">if</span> ok {
    fmt.Printf(<span class="hljs-string">"string value is: %q\n"</span>, str)
} <span class="hljs-keyword">else</span> {
    fmt.Printf(<span class="hljs-string">"value is not a string\n"</span>)
}
</span></span></foreignObject></svg></code></pre>
<p>è‹¥ç±»å‹æ–­è¨€å¤±è´¥ï¼Œstr å°†ç»§ç»­å­˜åœ¨ä¸”ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œä½†å®ƒå°†æ‹¥æœ‰é›¶å€¼ï¼Œå³ç©ºå­—ç¬¦ä¸²ã€‚</p>
<p>ä½œä¸ºå¯¹èƒ½é‡çš„è¯´æ˜ï¼Œè¿™é‡Œæœ‰ä¸ª if-else è¯­å¥ï¼Œå®ƒç­‰ä»·äºæœ¬èŠ‚å¼€å¤´çš„ç±»å‹é€‰æ‹©ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> str, ok := value.(<span class="hljs-keyword">string</span>); ok {
    <span class="hljs-keyword">return</span> str
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> str, ok := value.(Stringer); ok {
    <span class="hljs-keyword">return</span> str.String()
}
</span></span></foreignObject></svg></code></pre>
<h3>é€šç”¨æ€§</h3>
<p>è‹¥æŸç§ç°æœ‰çš„ç±»å‹ä»…å®ç°äº†ä¸€ä¸ªæ¥å£ï¼Œä¸”é™¤æ­¤ä¹‹å¤–å¹¶æ— å¯å¯¼å‡ºçš„æ–¹æ³•ï¼Œåˆ™è¯¥ç±»å‹æœ¬èº«å°±æ— éœ€å¯¼å‡ºã€‚ ä»…å¯¼å‡ºè¯¥æ¥å£èƒ½è®©æˆ‘ä»¬æ›´ä¸“æ³¨äºå…¶è¡Œä¸ºè€Œéå®ç°ï¼Œå…¶å®ƒå±æ€§ä¸åŒçš„å®ç°åˆ™èƒ½é•œåƒè¯¥åŸå§‹ç±»å‹çš„è¡Œä¸ºã€‚ è¿™ä¹Ÿèƒ½å¤Ÿé¿å…ä¸ºæ¯ä¸ªé€šç”¨æ¥å£çš„å®ä¾‹é‡å¤ç¼–å†™æ–‡æ¡£ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ„é€ å‡½æ•°åº”å½“è¿”å›ä¸€ä¸ªæ¥å£å€¼è€Œéå®ç°çš„ç±»å‹ã€‚ä¾‹å¦‚åœ¨ <code>hash</code> åº“ä¸­ï¼Œ<code>crc32.NewIEEE</code> å’Œ <code>adler32.New</code> éƒ½è¿”å›æ¥å£ç±»å‹ <code>hash.Hash32</code>ã€‚è¦åœ¨ Go ç¨‹åºä¸­ç”¨ Adler-32 ç®—æ³•æ›¿ä»£ CRC-32ï¼Œ åªéœ€ä¿®æ”¹æ„é€ å‡½æ•°è°ƒç”¨å³å¯ï¼Œå…¶ä½™ä»£ç åˆ™ä¸å—ç®—æ³•æ”¹å˜çš„å½±å“ã€‚</p>
<p>åŒæ ·çš„æ–¹å¼èƒ½å°† <code>crypto</code> åŒ…ä¸­å¤šç§è”ç³»åœ¨ä¸€èµ·çš„æµå¯†ç ç®—æ³•ä¸å—å¯†ç ç®—æ³•åˆ†å¼€ã€‚ <code>crypto/cipher</code> åŒ…ä¸­çš„ <code>Block</code> æ¥å£æŒ‡å®šäº†å—å¯†ç ç®—æ³•çš„è¡Œä¸ºï¼Œ å®ƒä¸ºå•ç‹¬çš„æ•°æ®å—æä¾›åŠ å¯†ã€‚æ¥ç€ï¼Œå’Œ <code>bufio</code> åŒ…ç±»ä¼¼ï¼Œä»»ä½•å®ç°äº†è¯¥æ¥å£çš„å¯†ç åŒ…éƒ½èƒ½è¢«ç”¨äºæ„é€ ä»¥ <code>Stream</code> ä¸ºæ¥å£è¡¨ç¤ºçš„æµå¯†ç ï¼Œè€Œæ— éœ€çŸ¥é“å—åŠ å¯†çš„ç»†èŠ‚ã€‚</p>
<p><code>crypto/cipher</code> æ¥å£çœ‹å…¶æ¥å°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Block <span class="hljs-keyword">interface</span> {
    BlockSize() <span class="hljs-keyword">int</span>
    Encrypt(dst, src []<span class="hljs-keyword">byte</span>)
    Decrypt(dst, src []<span class="hljs-keyword">byte</span>)
}

<span class="hljs-keyword">type</span> Stream <span class="hljs-keyword">interface</span> {
    XORKeyStream(dst, src []<span class="hljs-keyword">byte</span>)
}
</span></span></foreignObject></svg></code></pre>
<p>è¿™æ˜¯è®¡æ•°å™¨æ¨¡å¼ CTR æµçš„å®šä¹‰ï¼Œå®ƒå°†å—åŠ å¯†æ”¹ä¸ºæµåŠ å¯†ï¼Œæ³¨æ„å—åŠ å¯†çš„ç»†èŠ‚å·²è¢«æŠ½è±¡åŒ–äº†ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// NewCTR è¿”å›ä½¿ç”¨ä¸­ç»™å®šçš„å—åŠ å¯†/è§£å¯†çš„æµ</span>
<span class="hljs-comment">// è®¡æ•°å™¨æ¨¡å¼ã€‚iv çš„é•¿åº¦å¿…é¡»ä¸å—çš„å—å¤§å°ç›¸åŒ</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewCTR</span><span class="hljs-params">(block Block, iv []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-title">Stream</span></span>
</span></span></foreignObject></svg></code></pre>
<p><code>NewCTR</code> çš„åº”ç”¨å¹¶ä¸ä»…é™äºç‰¹å®šçš„åŠ å¯†ç®—æ³•å’Œæ•°æ®æºï¼Œå®ƒé€‚ç”¨äºä»»ä½•å¯¹ <code>Block</code> æ¥å£å’Œ <code>Stream</code> çš„å®ç°ã€‚å› ä¸ºå®ƒä»¬è¿”å›æ¥å£å€¼ï¼Œ æ‰€ä»¥ç”¨å…¶å®ƒåŠ å¯†æ¨¡å¼æ¥ä»£æ›¿ CTR åªéœ€åšå±€éƒ¨çš„æ›´æ”¹ã€‚æ„é€ å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹å¿…é¡»è¢«ä¿®æ”¹ï¼Œ ä½†ç”±äºå…¶å‘¨å›´çš„ä»£ç åªèƒ½å°†å®ƒçœ‹åš <code>Stream</code>ï¼Œå› æ­¤å®ƒä»¬ä¸ä¼šæ³¨æ„åˆ°å…¶ä¸­çš„åŒºåˆ«ã€‚</p>
<h3>æ¥å£å’Œæ–¹æ³•</h3>
<p>ç”±äºå‡ ä¹ä»»ä½•ç±»å‹éƒ½èƒ½æ·»åŠ æ–¹æ³•ï¼Œå› æ­¤å‡ ä¹ä»»ä½•ç±»å‹éƒ½èƒ½æ»¡è¶³ä¸€ä¸ªæ¥å£ã€‚ä¸€ä¸ªå¾ˆç›´è§‚çš„ä¾‹å­å°±æ˜¯ <code>http</code> åŒ…ä¸­å®šä¹‰çš„ <code>Handler</code> æ¥å£ã€‚ä»»ä½•å®ç°äº† <code>Handler</code> çš„å¯¹è±¡éƒ½èƒ½å¤Ÿå¤„ç† HTTP è¯·æ±‚ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Handler <span class="hljs-keyword">interface</span> {
    ServeHTTP(ResponseWriter, *Request)
}
</span></span></foreignObject></svg></code></pre>
<p><code>ResponseWriter</code> æ¥å£æä¾›äº†å¯¹æ–¹æ³•çš„è®¿é—®ï¼Œè¿™äº›æ–¹æ³•éœ€è¦å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ ç”±äºè¿™äº›æ–¹æ³•åŒ…å«äº†æ ‡å‡†çš„ <code>Write</code> æ–¹æ³•ï¼Œå› æ­¤ <code>http.ResponseWriter</code> å¯ç”¨äºä»»ä½• <code>io.Writer</code> é€‚ç”¨çš„åœºæ™¯ã€‚<code>Request</code> ç»“æ„ä½“åŒ…å«å·²è§£æçš„å®¢æˆ·ç«¯è¯·æ±‚ã€‚</p>
<p>ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„ HTTP è¯·æ±‚éƒ½æ˜¯ GET æ–¹æ³•ï¼Œè€Œå¿½ç•¥ POST æ–¹æ³•ï¼Œ è¿™ç§ç®€åŒ–ä¸ä¼šå½±å“å¤„ç†ç¨‹åºçš„å»ºç«‹æ–¹å¼ã€‚è¿™é‡Œæœ‰ä¸ªçŸ­å°å´å®Œæ•´çš„å¤„ç†ç¨‹åºå®ç°ï¼Œ å®ƒç”¨äºè®°å½•æŸä¸ªé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// ç®€å•çš„è®¡æ•°å™¨æœåŠ¡å™¨ã€‚</span>
<span class="hljs-keyword">type</span> Counter <span class="hljs-keyword">struct</span> {
    n <span class="hljs-keyword">int</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(ctr *Counter)</span> <span class="hljs-title">ServeHTTP</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
    ctr.n++
    fmt.Fprintf(w, <span class="hljs-string">"counter = %d\n"</span>, ctr.n)
}
</span></span></foreignObject></svg></code></pre>
<p>ï¼ˆç´§è·Ÿæˆ‘ä»¬çš„ä¸»é¢˜ï¼Œæ³¨æ„ Fprintf å¦‚ä½•èƒ½è¾“å‡ºåˆ° http.ResponseWriterã€‚ï¼‰ ä½œä¸ºå‚è€ƒï¼Œè¿™é‡Œæ¼”ç¤ºäº†å¦‚ä½•å°†è¿™æ ·ä¸€ä¸ªæœåŠ¡å™¨æ·»åŠ åˆ° URL æ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> <span class="hljs-string">"net/http"</span>
...
ctr := <span class="hljs-built_in">new</span>(Counter)
http.Handle(<span class="hljs-string">"/counter"</span>, ctr)
</span></span></foreignObject></svg></code></pre>
<p>ä½†ä¸ºä»€ä¹ˆ <code>Counter</code> è¦æ˜¯ç»“æ„ä½“å‘¢ï¼Ÿä¸€ä¸ªæ•´æ•°å°±å¤Ÿäº†ã€‚ï¼ˆæ¥æ”¶è€…å¿…é¡»ä¸ºæŒ‡é’ˆï¼Œå¢é‡æ“ä½œå¯¹äºè°ƒç”¨è€…æ‰å¯è§ã€‚ï¼‰</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// ç®€å•çš„è®¡æ•°å™¨æœåŠ¡ã€‚</span>
<span class="hljs-keyword">type</span> Counter <span class="hljs-keyword">int</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(ctr *Counter)</span> <span class="hljs-title">ServeHTTP</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
    *ctr++
    fmt.Fprintf(w, <span class="hljs-string">"counter = %d\n"</span>, *ctr)
}
</span></span></foreignObject></svg></code></pre>
<p>å½“é¡µé¢è¢«è®¿é—®æ—¶ï¼Œæ€æ ·é€šçŸ¥ä½ çš„ç¨‹åºå»æ›´æ–°ä¸€äº›å†…éƒ¨çŠ¶æ€å‘¢ï¼Ÿä¸º Web é¡µé¢ç»‘å®šä¸ªä¿¡é“å§ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// æ¯æ¬¡æµè§ˆè¯¥ä¿¡é“éƒ½ä¼šå‘é€ä¸€ä¸ªæé†’ã€‚</span>
<span class="hljs-comment">// ï¼ˆå¯èƒ½éœ€è¦å¸¦ç¼“å†²çš„ä¿¡é“ã€‚ï¼‰</span>
<span class="hljs-keyword">type</span> Chan <span class="hljs-keyword">chan</span> *http.Request

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(ch Chan)</span> <span class="hljs-title">ServeHTTP</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
    ch &lt;- req
    fmt.Fprint(w, <span class="hljs-string">"notification sent"</span>)
}
</span></span></foreignObject></svg></code></pre>
<p>æœ€åï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦è¾“å‡ºè°ƒç”¨æœåŠ¡å™¨äºŒè¿›åˆ¶ç¨‹åºæ—¶ä½¿ç”¨çš„å®å‚ <code>/args</code>ã€‚ å¾ˆç®€å•ï¼Œå†™ä¸ªæ‰“å°å®å‚çš„å‡½æ•°å°±è¡Œäº†ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ArgServer</span><span class="hljs-params">()</span></span> {
    fmt.Println(os.Args)
}
</span></span></foreignObject></svg></code></pre>
<p>æˆ‘ä»¬å¦‚ä½•å°†å®ƒè½¬æ¢ä¸º HTTP æœåŠ¡å™¨å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å°† <code>ArgServer</code> å®ç°ä¸ºæŸç§å¯å¿½ç•¥å€¼çš„æ–¹æ³•ï¼Œä¸è¿‡è¿˜æœ‰ç§æ›´ç®€å•çš„æ–¹æ³•ã€‚ æ—¢ç„¶æˆ‘ä»¬å¯ä»¥ä¸ºé™¤æŒ‡é’ˆå’Œæ¥å£ä»¥å¤–çš„ä»»ä½•ç±»å‹å®šä¹‰æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿèƒ½ä¸ºä¸€ä¸ªå‡½æ•°å†™ä¸€ä¸ªæ–¹æ³•ã€‚ <code>http</code> åŒ…åŒ…å«ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// HandlerFunc ç±»å‹æ˜¯ä¸€ä¸ªé€‚é…å™¨ï¼Œ</span>
<span class="hljs-comment">// å®ƒå…è®¸å°†æ™®é€šå‡½æ•°ç”¨åšHTTPå¤„ç†ç¨‹åºã€‚</span>
<span class="hljs-comment">// è‹¥ f æ˜¯ä¸ªå…·æœ‰é€‚å½“ç­¾åçš„å‡½æ•°ï¼Œ</span>
<span class="hljs-comment">// HandlerFunc(f) å°±æ˜¯ä¸ªè°ƒç”¨ f çš„å¤„ç†ç¨‹åºå¯¹è±¡ã€‚</span>
<span class="hljs-keyword">type</span> HandlerFunc <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ResponseWriter, *Request)</span></span>

<span class="hljs-comment">// ServeHTTP calls f(w, req).</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(f HandlerFunc)</span> <span class="hljs-title">ServeHTTP</span><span class="hljs-params">(w ResponseWriter, req *Request)</span></span> {
    f(w, req)
}
</span></span></foreignObject></svg></code></pre>
<p><code>HandlerFunc</code> æ˜¯ä¸ªå…·æœ‰ <code>ServeHTTP</code> æ–¹æ³•çš„ç±»å‹ï¼Œ å› æ­¤è¯¥ç±»å‹çš„å€¼å°±èƒ½å¤„ç† HTTP è¯·æ±‚ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹è¯¥æ–¹æ³•çš„å®ç°ï¼šæ¥æ”¶è€…æ˜¯ä¸€ä¸ªå‡½æ•° <code>f</code>ï¼Œè€Œè¯¥æ–¹æ³•è°ƒç”¨ <code>f</code>ã€‚è¿™çœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†ä¸å¿…å¤§æƒŠå°æ€ªï¼Œ åŒºåˆ«åœ¨äºæ¥æ”¶è€…å˜æˆäº†ä¸€ä¸ªä¿¡é“ï¼Œè€Œæ–¹æ³•é€šè¿‡è¯¥ä¿¡é“å‘é€æ¶ˆæ¯ã€‚</p>
<p>ä¸ºäº†å°† <code>ArgServer</code> å®ç°æˆ HTTP æœåŠ¡å™¨ï¼Œé¦–å…ˆæˆ‘ä»¬å¾—è®©å®ƒæ‹¥æœ‰åˆé€‚çš„ç­¾åã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// å®å‚æœåŠ¡å™¨ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ArgServer</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
    fmt.Fprintln(w, os.Args)
}
</span></span></foreignObject></svg></code></pre>
<p><code>ArgServer</code> å’Œ <code>HandlerFunc</code> ç°åœ¨æ‹¥æœ‰äº†ç›¸åŒçš„ç­¾åï¼Œ å› æ­¤æˆ‘ä»¬å¯å°†å…¶è½¬æ¢ä¸ºè¿™ç§ç±»å‹ä»¥è®¿é—®å®ƒçš„æ–¹æ³•ï¼Œå°±åƒæˆ‘ä»¬å°† <code>Sequence</code> è½¬æ¢ä¸º <code>IntSlice</code> ä»¥è®¿é—® <code>IntSlice.Sort</code> é‚£æ ·ã€‚ å»ºç«‹ä»£ç éå¸¸ç®€å•ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>http.Handle(<span class="hljs-string">"/args"</span>, http.HandlerFunc(ArgServer))
</span></span></foreignObject></svg></code></pre>
<p>å½“æœ‰äººè®¿é—® <code>/args</code> é¡µé¢æ—¶ï¼Œå®‰è£…åˆ°è¯¥é¡µé¢çš„å¤„ç†ç¨‹åºå°±æœ‰äº†å€¼ <code>ArgServer</code> å’Œç±»å‹ <code>HandlerFunc</code>ã€‚ HTTP æœåŠ¡å™¨ä¼šä»¥ <code>ArgServer</code> ä¸ºæ¥æ”¶è€…ï¼Œè°ƒç”¨è¯¥ç±»å‹çš„ <code>ServeHTTP</code> æ–¹æ³•ï¼Œå®ƒä¼šåè¿‡æ¥è°ƒç”¨ <code>ArgServer</code>ï¼ˆé€šè¿‡ <code>f(c, req)</code>ï¼‰ï¼Œæ¥ç€å®å‚å°±ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»“æ„ä½“ï¼Œä¸€ä¸ªæ•´æ•°ï¼Œä¸€ä¸ªä¿¡é“å’Œä¸€ä¸ªå‡½æ•°ï¼Œå»ºç«‹äº†ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œ è¿™ä¸€åˆ‡éƒ½æ˜¯å› ä¸ºæ¥å£åªæ˜¯æ–¹æ³•çš„é›†å’Œï¼Œè€Œå‡ ä¹ä»»ä½•ç±»å‹éƒ½èƒ½å®šä¹‰æ–¹æ³•ã€‚</p>
<h2>ç©ºç™½æ ‡è¯†ç¬¦</h2>
<p>æˆ‘ä»¬åœ¨ <a href="https://learnku.com/docs/effective-go/control-structure/6241#39e61d"><code>for-range</code> å¾ªç¯</a>å’Œ<a href="https://learnku.com/docs/effective-go/data/6243#9da188">æ˜ å°„</a>ä¸­æè¿‡å‡ æ¬¡ç©ºç™½æ ‡è¯†ç¬¦ã€‚ ç©ºç™½æ ‡è¯†ç¬¦å¯è¢«èµ‹äºˆæˆ–å£°æ˜ä¸ºä»»ä½•ç±»å‹çš„ä»»ä½•å€¼ï¼Œè€Œå…¶å€¼ä¼šè¢«æ— å®³åœ°ä¸¢å¼ƒã€‚å®ƒæœ‰ç‚¹åƒ Unix ä¸­çš„ <code>/dev/null</code> æ–‡ä»¶ï¼šå®ƒè¡¨ç¤ºåªå†™çš„å€¼ï¼Œåœ¨éœ€è¦å˜é‡ä½†ä¸éœ€è¦å®é™…å€¼çš„åœ°æ–¹ç”¨ä½œå ä½ç¬¦ã€‚ æˆ‘ä»¬åœ¨å‰é¢å·²ç»è§è¿‡å®ƒçš„ç”¨æ³•äº†ã€‚</p>
<h3>å¤šä¸ªå‚æ•°èµ‹å€¼ä¸­çš„ç©ºç™½æ ‡è¯†ç¬¦</h3>
<p><code>for range</code> å¾ªç¯ä¸­å¯¹ç©ºè¡¨æ ‡è¯†ç¬¦çš„ç”¨æ³•æ˜¯ä¸€ç§å…·ä½“æƒ…å†µï¼Œæ›´ä¸€èˆ¬çš„æƒ…å†µå³ä¸ºå¤šä¸ªå‚æ•°èµ‹å€¼ã€‚</p>
<p>è‹¥æŸæ¬¡èµ‹å€¼éœ€è¦åŒ¹é…å¤šä¸ªå·¦å€¼ï¼Œä½†å…¶ä¸­æŸä¸ªå˜é‡ä¸ä¼šè¢«ç¨‹åºä½¿ç”¨ï¼Œ é‚£ä¹ˆç”¨ç©ºç™½æ ‡è¯†ç¬¦æ¥ä»£æ›¿è¯¥å˜é‡å¯é¿å…åˆ›å»ºæ— ç”¨çš„å˜é‡ï¼Œå¹¶èƒ½æ¸…æ¥šåœ°è¡¨æ˜è¯¥å€¼å°†è¢«ä¸¢å¼ƒã€‚ ä¾‹å¦‚ï¼Œå½“è°ƒç”¨æŸä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå€¼å’Œä¸€ä¸ªé”™è¯¯ï¼Œä½†åªæœ‰é”™è¯¯å¾ˆé‡è¦ï¼Œ é‚£ä¹ˆå¯ä½¿ç”¨ç©ºç™½æ ‡è¯†ç¬¦æ¥ä¸¢å¼ƒæ— å…³çš„å€¼ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> _, err := os.Stat(path); os.IsNotExist(err) {
    fmt.Printf(<span class="hljs-string">"%s does not exist\n"</span>, path)
}
</span></span></foreignObject></svg></code></pre>
<p>ä½ å¶å°”ä¼šçœ‹è§ä¸ºå¿½ç•¥é”™è¯¯è€Œä¸¢å¼ƒé”™è¯¯å€¼çš„ä»£ç ï¼Œè¿™æ˜¯ç§ç³Ÿç³•çš„å®è·µã€‚è¯·åŠ¡å¿…æ£€æŸ¥é”™è¯¯è¿”å›ï¼Œ å®ƒä»¬ä¼šæä¾›é”™è¯¯çš„ç†ç”±ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// å¾ˆç³Ÿç³•çš„ä»£ç ï¼è‹¥è·¯å¾„ä¸å­˜åœ¨ï¼Œå®ƒå°±ä¼šå´©æºƒã€‚</span>
fi, _ := os.Stat(path)
<span class="hljs-keyword">if</span> fi.IsDir() {
    fmt.Printf(<span class="hljs-string">"%s is a directory\n"</span>, path)
}
</span></span></foreignObject></svg></code></pre>
<h3>æœªä½¿ç”¨çš„å¯¼å…¥å’Œå˜é‡</h3>
<p>è‹¥å¯¼å…¥æŸä¸ªåŒ…æˆ–å£°æ˜æŸä¸ªå˜é‡è€Œä¸ä½¿ç”¨å®ƒå°±ä¼šäº§ç”Ÿé”™è¯¯ã€‚æœªä½¿ç”¨çš„åŒ…ä¼šè®©ç¨‹åºè†¨èƒ€å¹¶æ‹–æ…¢ç¼–è¯‘é€Ÿåº¦ï¼Œ è€Œå·²åˆå§‹åŒ–ä½†æœªä½¿ç”¨çš„å˜é‡ä¸ä»…ä¼šæµªè´¹è®¡ç®—èƒ½åŠ›ï¼Œè¿˜æœ‰å¯èƒ½æš—è—ç€æ›´å¤§çš„ Bugã€‚ ç„¶è€Œåœ¨ç¨‹åºå¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šäº§ç”Ÿæœªä½¿ç”¨çš„å¯¼å…¥å’Œå˜é‡ã€‚è™½ç„¶ä»¥åä¼šç”¨åˆ°å®ƒä»¬ï¼Œ ä½†ä¸ºäº†å®Œæˆç¼–è¯‘åˆä¸å¾—ä¸åˆ é™¤å®ƒä»¬æ‰è¡Œï¼Œè¿™å¾ˆè®©äººçƒ¦æ¼ã€‚ç©ºç™½æ ‡è¯†ç¬¦å°±èƒ½æä¾›ä¸€ä¸ªå·¥ä½œç©ºé—´ã€‚</p>
<p>è¿™ä¸ªå†™äº†ä¸€åŠçš„ç¨‹åºæœ‰ä¸¤ä¸ªæœªä½¿ç”¨çš„å¯¼å…¥ï¼ˆ<code>fmt</code> å’Œ <code>io</code>ï¼‰ä»¥åŠä¸€ä¸ªæœªä½¿ç”¨çš„å˜é‡ï¼ˆ<code>fd</code>ï¼‰ï¼Œå› æ­¤å®ƒä¸èƒ½ç¼–è¯‘ï¼Œ ä½†è‹¥åˆ°ç›®å‰ä¸ºæ­¢ä»£ç è¿˜æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾ˆä¹æ„çœ‹åˆ°å®ƒä»¬çš„ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"io"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"os"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    fd, err := os.Open(<span class="hljs-string">"test.go"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err)
    }
    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> use fd.</span>
}
</span></span></foreignObject></svg></code></pre>
<p>è¦è®©ç¼–è¯‘å™¨åœæ­¢å…³äºæœªä½¿ç”¨å¯¼å…¥çš„åŒ…ï¼Œéœ€è¦ç©ºç™½æ ‡è¯†ç¬¦æ¥å¼•ç”¨å·²å¯¼å…¥åŒ…ä¸­çš„ç¬¦å·ã€‚ åŒæ ·ï¼Œå°†æœªä½¿ç”¨çš„å˜é‡ <code>fd</code> èµ‹äºˆç©ºç™½æ ‡è¯†ç¬¦ä¹Ÿèƒ½å…³é—­æœªä½¿ç”¨å˜é‡é”™è¯¯ã€‚ è¯¥ç¨‹åºçš„ä»¥ä¸‹ç‰ˆæœ¬å¯ä»¥ç¼–è¯‘ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"io"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"os"</span>
)

<span class="hljs-keyword">var</span> _ = fmt.Printf  <span class="hljs-comment">// ç”¨äºè°ƒè¯•ï¼Œç»“æŸæ—¶åˆ é™¤ã€‚</span>
<span class="hljs-keyword">var</span> _ io.Reader    <span class="hljs-comment">// ç”¨äºè°ƒè¯•ï¼Œç»“æŸæ—¶åˆ é™¤ã€‚</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    fd, err := os.Open(<span class="hljs-string">"test.go"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err)
    }
    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> use fd.</span>
    _ = fd
}
</span></span></foreignObject></svg></code></pre>
<p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬åº”åœ¨å¯¼å…¥å¹¶åŠ ä»¥æ³¨é‡Šåï¼Œå†ä½¿å…¨å±€å£°æ˜å¯¼å…¥é”™è¯¯é™é»˜ï¼Œè¿™æ ·å¯ä»¥è®©å®ƒä»¬æ›´æ˜“æ‰¾åˆ°ï¼Œ å¹¶ä½œä¸ºä»¥åæ¸…ç†å®ƒçš„æé†’ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="104" data-paginate="true" data-theme="default" data-marpit-pagination="104" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>ä¸ºè¾…åŠ©ä½œç”¨è€Œå¯¼å…¥</h3>
<p>åƒå‰ä¾‹ä¸­ <code>fmt</code> æˆ– <code>io</code> è¿™ç§æœªä½¿ç”¨çš„å¯¼å…¥æ€»åº”åœ¨æœ€åè¢«ä½¿ç”¨æˆ–ç§»é™¤ï¼š ç©ºç™½èµ‹å€¼ä¼šå°†ä»£ç æ ‡è¯†ä¸ºå·¥ä½œæ­£åœ¨è¿›è¡Œä¸­ã€‚ä½†æœ‰æ—¶å¯¼å…¥æŸä¸ªåŒ…åªæ˜¯ä¸ºäº†å…¶è¾…åŠ©ä½œç”¨ï¼Œ è€Œæ²¡æœ‰ä»»ä½•æ˜ç¡®çš„ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ <a href="https://golang.org/pkg/net/http/pprof/">net/http/pprof</a> åŒ…çš„ <code>init</code> å‡½æ•°ä¸­è®°å½•äº† HTTP å¤„ç†ç¨‹åºçš„è°ƒè¯•ä¿¡æ¯ã€‚å®ƒæœ‰ä¸ªå¯å¯¼å‡ºçš„ APIï¼Œ ä½†å¤§éƒ¨åˆ†å®¢æˆ·ç«¯åªéœ€è¦è¯¥å¤„ç†ç¨‹åºçš„è®°å½•å’Œé€šè¿‡ Web é¡µé¢è®¿é—®æ•°æ®ã€‚åªä¸ºäº†å…¶è¾…åŠ©ä½œç”¨æ¥å¯¼å…¥è¯¥åŒ…ï¼Œ åªéœ€å°†åŒ…é‡å‘½åä¸ºç©ºç™½æ ‡è¯†ç¬¦ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> _ <span class="hljs-string">"net/http/pprof"</span>
</span></span></foreignObject></svg></code></pre>
<p>è¿™ç§å¯¼å…¥æ ¼å¼èƒ½æ˜ç¡®è¡¨ç¤ºè¯¥åŒ…æ˜¯ä¸ºå…¶è¾…åŠ©ä½œç”¨è€Œå¯¼å…¥çš„ï¼Œå› ä¸ºæ²¡æœ‰å…¶å®ƒä½¿ç”¨è¯¥åŒ…çš„å¯èƒ½ï¼š åœ¨æ­¤æ–‡ä»¶ä¸­ï¼Œå®ƒæ²¡æœ‰åå­—ã€‚ï¼ˆè‹¥å®ƒæœ‰åå­—è€Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ï¼Œç¼–è¯‘å™¨å°±ä¼šæ‹’ç»è¯¥ç¨‹åºã€‚ï¼‰</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="105" data-paginate="true" data-theme="default" data-marpit-pagination="105" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>æ¥å£æ£€æŸ¥</h3>
<p>å°±åƒæˆ‘ä»¬åœ¨å‰é¢<a href="https://learnku.com/docs/effective-go/interface-and-other-types/6246">æ¥å£</a>ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œ ä¸€ä¸ªç±»å‹æ— éœ€æ˜¾å¼åœ°å£°æ˜å®ƒå®ç°äº†æŸä¸ªæ¥å£ã€‚å–è€Œä»£ä¹‹ï¼Œè¯¥ç±»å‹åªè¦å®ç°äº†æŸä¸ªæ¥å£çš„æ–¹æ³•ï¼Œ å…¶å®å°±å®ç°äº†è¯¥æ¥å£ã€‚åœ¨å®è·µä¸­ï¼Œå¤§éƒ¨åˆ†æ¥å£è½¬æ¢éƒ½æ˜¯é™æ€çš„ï¼Œå› æ­¤ä¼šåœ¨ç¼–è¯‘æ—¶æ£€æµ‹ã€‚ ä¾‹å¦‚ï¼Œå°†ä¸€ä¸ª <code>*os.File</code> ä¼ å…¥ä¸€ä¸ªé¢„æœŸçš„ <code>io.Reader</code> å‡½æ•°å°†ä¸ä¼šè¢«ç¼–è¯‘ï¼Œ é™¤é <code>*os.File</code> å®ç°äº† <code>io.Reader</code> æ¥å£ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="106" data-paginate="true" data-theme="default" data-marpit-pagination="106" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å°½ç®¡æœ‰äº›æ¥å£æ£€æŸ¥ä¼šåœ¨è¿è¡Œæ—¶è¿›è¡Œã€‚<a href="https://golang.org/pkg/encoding/json/">encoding/json</a> åŒ…ä¸­å°±æœ‰ä¸ªå®ä¾‹å®ƒå®šä¹‰äº†ä¸€ä¸ª <a href="https://golang.org/pkg/encoding/json/#Marshaler">Marshaler</a> æ¥å£ã€‚å½“ JSON ç¼–ç å™¨æ¥æ”¶åˆ°ä¸€ä¸ªå®ç°äº†è¯¥æ¥å£çš„å€¼ï¼Œé‚£ä¹ˆè¯¥ç¼–ç å™¨å°±ä¼šè°ƒç”¨è¯¥å€¼çš„ç¼–ç»„æ–¹æ³•ï¼Œ å°†å…¶è½¬æ¢ä¸º JSONï¼Œè€Œéè¿›è¡Œæ ‡å‡†çš„ç±»å‹è½¬æ¢ã€‚ ç¼–ç å™¨åœ¨è¿è¡Œæ—¶é€šè¿‡<a href="https://learnku.com/docs/effective-go/interface-and-other-types/6246#ea20df">ç±»å‹æ–­è¨€</a>æ£€æŸ¥å…¶å±æ€§ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>m, ok := val.(json.Marshaler)
</span></span></foreignObject></svg></code></pre>
<p>è‹¥åªéœ€è¦åˆ¤æ–­æŸä¸ªç±»å‹æ˜¯å¦æ˜¯å®ç°äº†æŸä¸ªæ¥å£ï¼Œè€Œä¸éœ€è¦å®é™…ä½¿ç”¨æ¥å£æœ¬èº« ï¼ˆå¯èƒ½æ˜¯é”™è¯¯æ£€æŸ¥éƒ¨åˆ†ï¼‰ï¼Œå°±ä½¿ç”¨ç©ºç™½æ ‡è¯†ç¬¦æ¥å¿½ç•¥ç±»å‹æ–­è¨€çš„å€¼ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> _, ok := val.(json.Marshaler); ok {
    fmt.Printf(<span class="hljs-string">"value %v of type %T implements json.Marshaler\n"</span>, val, val)
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="107" data-paginate="true" data-theme="default" data-marpit-pagination="107" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å½“éœ€è¦ç¡®ä¿æŸä¸ªåŒ…ä¸­å®ç°çš„ç±»å‹ä¸€å®šæ»¡è¶³è¯¥æ¥å£æ—¶ï¼Œå°±ä¼šé‡åˆ°è¿™ç§æƒ…å†µã€‚ è‹¥æŸä¸ªç±»å‹ï¼ˆä¾‹å¦‚ <a href="https://golang.org/pkg/encoding/json/#RawMessage">json.RawMessage</a>ï¼‰ éœ€è¦ä¸€ç§è‡ªå®šä¹‰çš„ JSON è¡¨ç°æ—¶ï¼Œå®ƒåº”å½“å®ç° <code>json.Marshaler</code>ï¼Œ ä¸è¿‡ç°åœ¨æ²¡æœ‰é™æ€è½¬æ¢å¯ä»¥è®©ç¼–è¯‘å™¨å»è‡ªåŠ¨éªŒè¯å®ƒã€‚è‹¥è¯¥ç±»å‹é€šè¿‡å¿½ç•¥è½¬æ¢å¤±è´¥æ¥æ»¡è¶³è¯¥æ¥å£ï¼Œ é‚£ä¹ˆ JSON ç¼–ç å™¨ä»å¯å·¥ä½œï¼Œä½†å®ƒå´ä¸ä¼šä½¿ç”¨è‡ªå®šä¹‰çš„å®ç°ã€‚ä¸ºç¡®ä¿å…¶å®ç°æ­£ç¡®ï¼Œ å¯åœ¨è¯¥åŒ…ä¸­ç”¨ç©ºç™½æ ‡è¯†ç¬¦å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> _ json.Marshaler = (*RawMessage)(<span class="hljs-literal">nil</span>)
</span></span></foreignObject></svg></code></pre>
<p>åœ¨æ­¤å£°æ˜ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ª <code>*RawMessage</code> è½¬æ¢å¹¶å°†å…¶èµ‹äºˆäº† <code>Marshaler</code>ï¼Œä»¥æ­¤æ¥è¦æ±‚ <code>*RawMessage</code> å®ç° <code>Marshaler</code>ï¼Œè¿™æ—¶å…¶å±æ€§å°±ä¼šåœ¨ç¼–è¯‘æ—¶è¢«æ£€æµ‹ã€‚ è‹¥ <code>json.Marshaler</code> æ¥å£è¢«æ›´æ”¹ï¼Œæ­¤åŒ…å°†æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œ è€Œæˆ‘ä»¬åˆ™ä¼šæ³¨æ„åˆ°å®ƒéœ€è¦æ›´æ–°ã€‚</p>
<p>åœ¨è¿™ç§ç»“æ„ä¸­å‡ºç°ç©ºç™½æ ‡è¯†ç¬¦ï¼Œå³è¡¨ç¤ºè¯¥å£°æ˜çš„å­˜åœ¨åªæ˜¯ä¸ºäº†ç±»å‹æ£€æŸ¥ã€‚ ä¸è¿‡è¯·ä¸è¦ä¸ºæ»¡è¶³æ¥å£å°±å°†å®ƒç”¨äºä»»ä½•ç±»å‹ã€‚ä½œä¸ºçº¦å®šï¼Œ åªæœ‰å½“ä»£ç ä¸­ä¸å­˜åœ¨é™æ€ç±»å‹è½¬æ¢æ—¶æ‰èƒ½ä½¿ç”¨è¿™ç§å£°æ˜ï¼Œæ¯•ç«Ÿè¿™æ˜¯ç§éå¸¸ç½•è§çš„æƒ…å†µã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="108" data-paginate="true" data-theme="default" data-marpit-pagination="108" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>å†…åµŒ</h2>
<p>Go å¹¶ä¸æä¾›å…¸å‹çš„ï¼Œç±»å‹é©±åŠ¨çš„å­ç±»åŒ–æ¦‚å¿µï¼Œä½†é€šè¿‡å°†ç±»å‹<strong>å†…åµŒ</strong>åˆ°ç»“æ„ä½“æˆ–æ¥å£ä¸­ï¼Œ å®ƒå°±èƒ½ â€œå€Ÿé‰´â€ éƒ¨åˆ†å®ç°ã€‚</p>
<p>æ¥å£å†…åµŒéå¸¸ç®€å•ã€‚æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡ <code>io.Reader</code> å’Œ <code>io.Writer</code> æ¥å£ï¼Œè¿™é‡Œæ˜¯å®ƒä»¬çš„å®šä¹‰ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Reader <span class="hljs-keyword">interface</span> {                       <span class="hljs-comment">//å®šä¹‰è¯»å–çš„æ¥å£ç±»å‹</span>
    Read(p []<span class="hljs-keyword">byte</span>) (n <span class="hljs-keyword">int</span>, err error)       <span class="hljs-comment">//å®šä¹‰å‡½æ•°   ä¼ å…¥[]byteç±»å‹  è¿”å›ä¸€ä¸ªæ•´å‹å’Œerr</span>
}

<span class="hljs-keyword">type</span> Writer <span class="hljs-keyword">interface</span> {                         <span class="hljs-comment">//å®šä¹‰å†™å…¥çš„æ¥å£ç±»å‹</span>
    Write(p []<span class="hljs-keyword">byte</span>) (n <span class="hljs-keyword">int</span>, err error)       <span class="hljs-comment">//å®šä¹‰å‡½æ•°   ä¼ å…¥[]byteç±»å‹  è¿”å›ä¸€ä¸ªæ•´å‹å’Œerr</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="109" data-paginate="true" data-theme="default" data-marpit-pagination="109" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><code>io</code> åŒ…ä¹Ÿå¯¼å‡ºäº†ä¸€äº›å…¶å®ƒæ¥å£ï¼Œä»¥æ­¤æ¥é˜æ˜å¯¹è±¡æ‰€éœ€å®ç°çš„æ–¹æ³•ã€‚ ä¾‹å¦‚ <code>io.ReadWriter</code> å°±æ˜¯ä¸ªåŒ…å« <code>Read</code> å’Œ <code>Write</code> çš„æ¥å£ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ˜¾ç¤ºåœ°åˆ—å‡ºè¿™ä¸¤ä¸ªæ–¹æ³•æ¥æŒ‡æ˜ <code>io.ReadWriter</code>ï¼Œ ä½†é€šè¿‡å°†è¿™ä¸¤ä¸ªæ¥å£å†…åµŒåˆ°æ–°çš„æ¥å£ä¸­æ˜¾ç„¶æ›´å®¹æ˜“ä¸”æ›´å…·å¯å‘æ€§ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// ReadWriter æ¥å£ç»“åˆäº† Reader æ¥å£ å’Œ Writer æ¥å£</span>
<span class="hljs-keyword">type</span> ReadWriter <span class="hljs-keyword">interface</span> {
    Reader
    Writer
}
</span></span></foreignObject></svg></code></pre>
<p>æ­£å¦‚å®ƒçœ‹èµ·æ¥é‚£æ ·ï¼š<code>ReadWriter</code> èƒ½å¤Ÿåšä»»ä½• <code>Reader</code> <strong>å’Œ</strong> <code>Writer</code> å¯ä»¥åšåˆ°çš„äº‹æƒ…ï¼Œå®ƒæ˜¯å†…åµŒæ¥å£çš„è”åˆä½“ ï¼ˆå®ƒä»¬å¿…é¡»æ˜¯ä¸ç›¸äº¤çš„æ–¹æ³•é›†ï¼‰ã€‚åªæœ‰æ¥å£èƒ½è¢«åµŒå…¥åˆ°æ¥å£ä¸­ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="110" data-paginate="true" data-theme="default" data-marpit-pagination="110" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åŒæ ·çš„åŸºæœ¬æƒ³æ³•å¯ä»¥åº”ç”¨åœ¨ç»“æ„ä½“ä¸­ï¼Œä½†å…¶æ„ä¹‰æ›´åŠ æ·±è¿œã€‚<code>bufio</code> åŒ…ä¸­æœ‰ <code>bufio.Reader</code> å’Œ <code>bufio.Writer</code> è¿™ä¸¤ä¸ªç»“æ„ä½“ç±»å‹ï¼Œ å®ƒä»¬æ¯ä¸€ä¸ªéƒ½å®ç°äº†ä¸ <code>io</code> åŒ…ä¸­ç›¸åŒæ„ä¹‰çš„æ¥å£ã€‚æ­¤å¤–ï¼Œ<code>bufio</code> è¿˜é€šè¿‡ç»“åˆ <code>reader/writer</code> å¹¶å°†å…¶å†…åµŒåˆ°ç»“æ„ä½“ä¸­ï¼Œå®ç°äº†å¸¦ç¼“å†²çš„ <code>reader/writer</code>ï¼šå®ƒåˆ—å‡ºäº†ç»“æ„ä½“ä¸­çš„ç±»å‹ï¼Œä½†å¹¶æœªç»™äºˆå®ƒä»¬å­—æ®µåã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// ReadWriter å­˜å‚¨äº†æŒ‡å‘ Reader å’Œ Writer çš„æŒ‡é’ˆã€‚</span>
<span class="hljs-comment">// å®ƒå®ç°äº† io.ReadWriterã€‚</span>
<span class="hljs-keyword">type</span> ReadWriter <span class="hljs-keyword">struct</span> {
    *Reader  <span class="hljs-comment">// *bufio.Reader</span>
    *Writer  <span class="hljs-comment">// *bufio.Writer</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="111" data-paginate="true" data-theme="default" data-marpit-pagination="111" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å†…åµŒçš„å…ƒç´ ä¸ºæŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå½“ç„¶å®ƒä»¬åœ¨ä½¿ç”¨å‰å¿…é¡»è¢«åˆå§‹åŒ–ä¸ºæŒ‡å‘æœ‰æ•ˆç»“æ„ä½“çš„æŒ‡é’ˆã€‚ <code>ReadWriter</code> ç»“æ„ä½“å’Œé€šè¿‡å¦‚ä¸‹æ–¹å¼å®šä¹‰ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> ReadWriter <span class="hljs-keyword">struct</span> {
    reader *Reader
    writer *Writer
}
</span></span></foreignObject></svg></code></pre>
<p>ä½†ä¸ºäº†æå‡è¯¥å­—æ®µçš„æ–¹æ³•å¹¶æ»¡è¶³ <code>io</code> æ¥å£ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦æä¾›è½¬å‘çš„æ–¹æ³•ï¼Œ å°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(rw *ReadWriter)</span> <span class="hljs-title">Read</span><span class="hljs-params">(p []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-params">(n <span class="hljs-keyword">int</span>, err error)</span></span> {
    <span class="hljs-keyword">return</span> rw.reader.Read(p)
}
</span></span></foreignObject></svg></code></pre>
<p>è€Œé€šè¿‡ç›´æ¥å†…åµŒç»“æ„ä½“ï¼Œæˆ‘ä»¬å°±èƒ½é¿å…å¦‚æ­¤ç¹çã€‚ å†…åµŒç±»å‹çš„æ–¹æ³•å¯ä»¥ç›´æ¥å¼•ç”¨ï¼Œè¿™æ„å‘³ç€ <code>bufio.ReadWriter</code> ä¸ä»…åŒ…æ‹¬ <code>bufio.Reader</code> å’Œ <code>bufio.Writer</code> çš„æ–¹æ³•ï¼Œå®ƒè¿˜åŒæ—¶æ»¡è¶³ä¸‹åˆ—ä¸‰ä¸ªæ¥å£ï¼š <code>io.Reader</code>ã€<code>io.Writer</code> ä»¥åŠ <code>io.ReadWriter</code>ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="112" data-paginate="true" data-theme="default" data-marpit-pagination="112" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¿˜æœ‰ç§åŒºåˆ†å†…åµŒä¸å­ç±»çš„é‡è¦æ‰‹æ®µã€‚å½“å†…åµŒä¸€ä¸ªç±»å‹æ—¶ï¼Œè¯¥ç±»å‹çš„æ–¹æ³•ä¼šæˆä¸ºå¤–éƒ¨ç±»å‹çš„æ–¹æ³•ï¼Œ ä½†å½“å®ƒä»¬è¢«è°ƒç”¨æ—¶ï¼Œè¯¥æ–¹æ³•çš„æ¥æ”¶è€…æ˜¯å†…éƒ¨ç±»å‹ï¼Œè€Œéå¤–éƒ¨çš„ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå½“ <code>bufio.ReadWriter</code> çš„ <code>Read</code> æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ å®ƒä¸ä¹‹å‰å†™çš„è½¬å‘æ–¹æ³•å…·æœ‰åŒæ ·çš„æ•ˆæœï¼›æ¥æ”¶è€…æ˜¯ <code>ReadWriter</code> çš„ <code>reader</code> å­—æ®µï¼Œè€Œé <code>ReadWriter</code> æœ¬èº«ã€‚</p>
<p>å†…åµŒåŒæ ·å¯ä»¥æä¾›ä¾¿åˆ©ã€‚è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªå†…åµŒå­—æ®µå’Œä¸€ä¸ªå¸¸è§„çš„å‘½åå­—æ®µã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Job <span class="hljs-keyword">struct</span> {
    Command <span class="hljs-keyword">string</span>
    *log.Logger
}
</span></span></foreignObject></svg></code></pre>
<p><code>Job</code> ç±»å‹ç°åœ¨æœ‰äº† <code>Log</code>ã€<code>Logf</code> å’Œ <code>*log.Logger</code> çš„å…¶å®ƒæ–¹æ³•ã€‚æˆ‘ä»¬å½“ç„¶å¯ä»¥ä¸º <code>Logger</code> æä¾›ä¸€ä¸ªå­—æ®µåï¼Œä½†å®Œå…¨ä¸å¿…è¿™ä¹ˆåšã€‚ç°åœ¨ï¼Œä¸€æ—¦åˆå§‹åŒ–åï¼Œæˆ‘ä»¬å°±èƒ½è®°å½• <code>Job</code> äº†ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>job.Println(<span class="hljs-string">"starting now..."</span>)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="113" data-paginate="true" data-theme="default" data-marpit-pagination="113" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><code>Logger</code> æ˜¯ <code>Job</code> ç»“æ„ä½“çš„å¸¸è§„å­—æ®µï¼Œ å› æ­¤æˆ‘ä»¬å¯åœ¨ <code>Job</code> çš„æ„é€ å‡½æ•°ä¸­ï¼Œé€šè¿‡ä¸€èˆ¬çš„æ–¹å¼æ¥åˆå§‹åŒ–å®ƒï¼Œå°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewJob</span><span class="hljs-params">(command <span class="hljs-keyword">string</span>, logger *log.Logger)</span> *<span class="hljs-title">Job</span></span> {
    <span class="hljs-keyword">return</span> &amp;Job{command, logger}
}
</span></span></foreignObject></svg></code></pre>
<p>æˆ–é€šè¿‡å¤åˆå­—é¢ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>job := &amp;Job{command, log.New(os.Stderr, <span class="hljs-string">"Job: "</span>, log.Ldate)}
</span></span></foreignObject></svg></code></pre>
<p>è‹¥æˆ‘ä»¬éœ€è¦ç›´æ¥å¼•ç”¨å†…åµŒå­—æ®µï¼Œå¯ä»¥å¿½ç•¥åŒ…é™å®šåï¼Œç›´æ¥å°†è¯¥å­—æ®µçš„ç±»å‹åä½œä¸ºå­—æ®µåï¼Œ å°±åƒæˆ‘ä»¬åœ¨ <code>ReaderWriter</code> ç»“æ„ä½“çš„ <code>Read</code> æ–¹æ³•ä¸­åšçš„é‚£æ ·ã€‚ è‹¥æˆ‘ä»¬éœ€è¦è®¿é—® <code>Job</code> ç±»å‹çš„å˜é‡ <code>job</code> çš„ <code>*log.Logger</code>ï¼Œ å¯ä»¥ç›´æ¥å†™ä½œ <code>job.Logger</code>ã€‚è‹¥æˆ‘ä»¬æƒ³ç²¾ç‚¼ <code>Logger</code> çš„æ–¹æ³•æ—¶ï¼Œ è¿™ä¼šéå¸¸æœ‰ç”¨ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(job *Job)</span> <span class="hljs-title">Printf</span><span class="hljs-params">(format <span class="hljs-keyword">string</span>, args ...<span class="hljs-keyword">interface</span>{})</span></span> {
    job.Logger.Printf(<span class="hljs-string">"%q: %s"</span>, job.Command, fmt.Sprintf(format, args...))
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="114" data-paginate="true" data-theme="default" data-marpit-pagination="114" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å†…åµŒç±»å‹ä¼šå¼•å…¥å‘½åå†²çªçš„é—®é¢˜ï¼Œä½†è§£å†³è§„åˆ™å´å¾ˆç®€å•ã€‚é¦–å…ˆï¼Œå­—æ®µæˆ–æ–¹æ³• <code>X</code> ä¼šéšè—è¯¥ç±»å‹ä¸­æ›´æ·±å±‚åµŒå¥—çš„å…¶å®ƒé¡¹ <code>X</code>ã€‚è‹¥ <code>log.Logger</code> åŒ…å«ä¸€ä¸ªåä¸º <code>Command</code> çš„å­—æ®µæˆ–æ–¹æ³•ï¼Œ<code>Job</code> çš„ <code>Command</code> å­—æ®µä¼šè¦†ç›–å®ƒã€‚</p>
<p>å…¶æ¬¡ï¼Œè‹¥ç›¸åŒçš„åµŒå¥—å±‚çº§ä¸Šå‡ºç°åŒåå†²çªï¼Œé€šå¸¸ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ã€‚è‹¥ <code>Job</code> ç»“æ„ä½“ä¸­åŒ…å«åä¸º <code>Logger</code> çš„å­—æ®µæˆ–æ–¹æ³•ï¼Œå†å°† <code>log.Logger</code> å†…åµŒåˆ°å…¶ä¸­çš„è¯å°±ä¼šäº§ç”Ÿé”™è¯¯ã€‚ç„¶è€Œï¼Œè‹¥é‡åæ°¸è¿œä¸ä¼šåœ¨è¯¥ç±»å‹å®šä¹‰ä¹‹å¤–çš„ç¨‹åºä¸­ä½¿ç”¨ï¼Œé‚£å°±ä¸ä¼šå‡ºé”™ã€‚ è¿™ç§é™å®šèƒ½å¤Ÿåœ¨å¤–éƒ¨åµŒå¥—ç±»å‹å‘ç”Ÿä¿®æ”¹æ—¶æä¾›æŸç§ä¿æŠ¤ã€‚ å› æ­¤ï¼Œå°±ç®—æ·»åŠ çš„å­—æ®µä¸å¦ä¸€ä¸ªå­ç±»å‹ä¸­çš„å­—æ®µç›¸å†²çªï¼Œåªè¦è¿™ä¸¤ä¸ªç›¸åŒçš„å­—æ®µæ°¸è¿œä¸ä¼šè¢«ä½¿ç”¨å°±æ²¡é—®é¢˜ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="115" data-paginate="true" data-theme="default" data-marpit-pagination="115" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>å¹¶å‘</h2>
<h3>é€šè¿‡é€šä¿¡å…±äº«å†…å­˜</h3>
<p>å¹¶å‘ç¼–ç¨‹æ˜¯ä¸ªå¾ˆå¤§çš„è®ºé¢˜ã€‚ä½†é™äºç¯‡å¹…ï¼Œè¿™é‡Œä»…è®¨è®ºä¸€äº› Go ç‰¹æœ‰çš„ä¸œè¥¿ã€‚</p>
<p>åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œä¸ºå®ç°å¯¹å…±äº«å˜é‡çš„æ­£ç¡®è®¿é—®éœ€è¦ç²¾ç¡®çš„æ§åˆ¶ï¼Œè¿™åœ¨å¤šæ•°ç¯å¢ƒä¸‹éƒ½å¾ˆå›°éš¾ã€‚ Go è¯­è¨€å¦è¾Ÿè¹Šå¾„ï¼Œå®ƒå°†å…±äº«çš„å€¼é€šè¿‡ä¿¡é“ä¼ é€’ï¼Œå®é™…ä¸Šï¼Œå¤šä¸ªç‹¬ç«‹æ‰§è¡Œçš„çº¿ç¨‹ä»ä¸ä¼šä¸»åŠ¨å…±äº«ã€‚ åœ¨ä»»æ„ç»™å®šçš„æ—¶é—´ç‚¹ï¼Œåªæœ‰ä¸€ä¸ª Go åç¨‹èƒ½å¤Ÿè®¿é—®è¯¥å€¼ã€‚æ•°æ®ç«äº‰ä»è®¾è®¡ä¸Šå°±è¢«æœç»äº†ã€‚ ä¸ºäº†æå€¡è¿™ç§æ€è€ƒæ–¹å¼ï¼Œæˆ‘ä»¬å°†å®ƒç®€åŒ–ä¸ºä¸€å¥å£å·ï¼š</p>
<blockquote>
<p>ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œåº”é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚</p>
</blockquote>
<p>è¿™ç§æ–¹æ³•æ„ä¹‰æ·±è¿œã€‚ä¾‹å¦‚ï¼Œå¼•ç”¨è®¡æ•°é€šè¿‡ä¸ºæ•´æ•°å˜é‡æ·»åŠ äº’æ–¥é”æ¥å¾ˆå¥½åœ°å®ç°ã€‚ ä½†ä½œä¸ºä¸€ç§é«˜çº§æ–¹æ³•ï¼Œé€šè¿‡ä¿¡é“æ¥æ§åˆ¶è®¿é—®èƒ½å¤Ÿè®©ä½ å†™å‡ºæ›´ç®€æ´ï¼Œæ­£ç¡®çš„ç¨‹åºã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä»å…¸å‹çš„å•çº¿ç¨‹è¿è¡Œåœ¨å• CPU ä¹‹ä¸Šçš„æƒ…å½¢æ¥å®¡è§†è¿™ç§æ¨¡å‹ã€‚å®ƒæ— éœ€æä¾›åŒæ­¥åŸè¯­ã€‚ ç°åœ¨è€ƒè™‘å¦ä¸€ç§æƒ…å†µï¼Œå®ƒä¹Ÿæ— éœ€åŒæ­¥ã€‚ç°åœ¨è®©å®ƒä»¬ä¿©è¿›è¡Œé€šä¿¡ã€‚è‹¥å°†é€šä¿¡è¿‡ç¨‹çœ‹åšåŒæ­¥ç€ï¼Œ é‚£å°±å®Œå…¨ä¸éœ€è¦å…¶å®ƒåŒæ­¥äº†ã€‚ä¾‹å¦‚ï¼ŒUnix ç®¡é“å°±ä¸è¿™ç§æ¨¡å‹å®Œç¾å¥‘åˆã€‚ å°½ç®¡ Go çš„å¹¶å‘å¤„ç†æ–¹å¼æ¥æºäº Hoare çš„é€šä¿¡é¡ºåºå¤„ç†ï¼ˆCSPï¼‰ï¼Œ å®ƒä¾ç„¶å¯ä»¥çœ‹åšæ˜¯ç±»å‹å®‰å…¨çš„ Unix ç®¡é“çš„å®ç°ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="116" data-paginate="true" data-theme="default" data-marpit-pagination="116" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>åç¨‹ï¼ˆgoroutineï¼‰</h3>
<p>æˆ‘ä»¬ç§°ä¹‹ä¸º <strong>Go åç¨‹</strong>æ˜¯å› ä¸ºç°æœ‰çš„æœ¯è¯­ â€” çº¿ç¨‹ã€åç¨‹ã€è¿›ç¨‹ç­‰ç­‰ â€” æ— æ³•å‡†ç¡®ä¼ è¾¾å®ƒçš„å«ä¹‰ã€‚ Go åç¨‹å…·æœ‰ç®€å•çš„æ¨¡å‹ï¼šå®ƒæ˜¯ä¸å…¶å®ƒ Go åç¨‹å¹¶å‘è¿è¡Œåœ¨åŒä¸€åœ°å€ç©ºé—´çš„å‡½æ•°ã€‚å®ƒæ˜¯è½»é‡çº§çš„ï¼Œ æ‰€æœ‰æ¶ˆè€—å‡ ä¹å°±åªæœ‰æ ˆç©ºé—´çš„åˆ†é…ã€‚è€Œä¸”æ ˆæœ€å¼€å§‹æ˜¯éå¸¸å°çš„ï¼Œæ‰€ä»¥å®ƒä»¬å¾ˆå»‰ä»·ï¼Œ ä»…åœ¨éœ€è¦æ—¶æ‰ä¼šéšç€å †ç©ºé—´çš„åˆ†é…ï¼ˆå’Œé‡Šæ”¾ï¼‰è€Œå˜åŒ–ã€‚</p>
<p>Go åç¨‹åœ¨å¤šçº¿ç¨‹æ“ä½œç³»ç»Ÿä¸Šå¯å®ç°å¤šè·¯å¤ç”¨ï¼Œå› æ­¤è‹¥ä¸€ä¸ªçº¿ç¨‹é˜»å¡ï¼Œæ¯”å¦‚è¯´ç­‰å¾… I/Oï¼Œ é‚£ä¹ˆå…¶å®ƒçš„çº¿ç¨‹å°±ä¼šè¿è¡Œã€‚Go åç¨‹çš„è®¾è®¡éšè—äº†çº¿ç¨‹åˆ›å»ºå’Œç®¡ç†çš„è¯¸å¤šå¤æ‚æ€§ã€‚</p>
<p>åœ¨å‡½æ•°æˆ–æ–¹æ³•å‰æ·»åŠ  <code>go</code> å…³é”®å­—èƒ½å¤Ÿåœ¨æ–°çš„ Go åç¨‹ä¸­è°ƒç”¨å®ƒã€‚å½“è°ƒç”¨å®Œæˆåï¼Œ è¯¥ Go åç¨‹ä¹Ÿä¼šå®‰é™åœ°é€€å‡ºã€‚ï¼ˆæ•ˆæœæœ‰ç‚¹åƒ Unix Shell ä¸­çš„ <code>&amp;</code> ç¬¦å·ï¼Œå®ƒèƒ½è®©å‘½ä»¤åœ¨åå°è¿è¡Œã€‚ï¼‰</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">go</span> list.Sort()  <span class="hljs-comment">// åŒæ—¶è¿è¡Œ list.Sort ; ä¸éœ€è¦ç­‰å¾…</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="117" data-paginate="true" data-theme="default" data-marpit-pagination="117" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å­—é¢å‡½æ•°åœ¨åç¨‹ä¸­è°ƒç”¨éå¸¸æ–¹ä¾¿ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Announce</span><span class="hljs-params">(message <span class="hljs-keyword">string</span>, delay time.Duration)</span></span> {
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        time.Sleep(delay)
        fmt.Println(message)
    }()  <span class="hljs-comment">// æ³¨æ„æ‹¬å· - å¿…é¡»è°ƒç”¨å‡½æ•°</span>
}
</span></span></foreignObject></svg></code></pre>
<p>åœ¨ Go ä¸­ï¼Œå­—é¢å‡½æ•°éƒ½æ˜¯é—­åŒ…ï¼šå…¶å®ç°åœ¨ä¿è¯äº†å‡½æ•°å†…å¼•ç”¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸä¸å‡½æ•°çš„æ´»åŠ¨æ—¶é—´ç›¸åŒã€‚</p>
<p>è¿™äº›å‡½æ•°æ²¡ä»€ä¹ˆå®ç”¨æ€§ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰å®ç°å®Œæˆæ—¶çš„ä¿¡å·å¤„ç†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¿¡é“ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="118" data-paginate="true" data-theme="default" data-marpit-pagination="118" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>ä¿¡é“</h3>
<p>ä¿¡é“ä¸æ˜ å°„ä¸€æ ·ï¼Œä¹Ÿéœ€è¦é€šè¿‡ <code>make</code> æ¥åˆ†é…å†…å­˜ã€‚å…¶ç»“æœå€¼å……å½“äº†å¯¹åº•å±‚æ•°æ®ç»“æ„çš„å¼•ç”¨ã€‚ è‹¥æä¾›äº†ä¸€ä¸ªå¯é€‰çš„æ•´æ•°å½¢å‚ï¼Œå®ƒå°±ä¼šä¸ºè¯¥ä¿¡é“è®¾ç½®ç¼“å†²åŒºå¤§å°ã€‚é»˜è®¤å€¼æ˜¯é›¶ï¼Œè¡¨ç¤ºä¸å¸¦ç¼“å†²çš„æˆ–åŒæ­¥çš„ä¿¡é“ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>ci := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)            <span class="hljs-comment">// æ•´æ•°æ— ç¼“å†²ä¿¡é“</span>
cj := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>, <span class="hljs-number">0</span>)         <span class="hljs-comment">// æ•´æ•°æ— ç¼“å†²ä¿¡é“</span>
cs := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> *os.File, <span class="hljs-number">100</span>)  <span class="hljs-comment">// æŒ‡å‘æ–‡ä»¶çš„æŒ‡é’ˆçš„ç¼“å†²ä¿¡é“</span>
</span></span></foreignObject></svg></code></pre>
<p>æ— ç¼“å†²ä¿¡é“åœ¨é€šä¿¡æ—¶ä¼šåŒæ­¥äº¤æ¢æ•°æ®ï¼Œå®ƒèƒ½ç¡®ä¿ï¼ˆä¸¤ä¸ª Go åç¨‹çš„ï¼‰è®¡ç®—å¤„äºç¡®å®šçŠ¶æ€ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="119" data-paginate="true" data-theme="default" data-marpit-pagination="119" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ä¿¡é“æœ‰å¾ˆå¤šæƒ¯ç”¨æ³•ï¼Œæˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹äº†è§£ã€‚åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åœ¨åå°å¯åŠ¨äº†æ’åºæ“ä½œã€‚ ä¿¡é“ä½¿å¾—å¯åŠ¨çš„ Go åç¨‹ç­‰å¾…æ’åºå®Œæˆã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ— ç¼“å†²çš„ç±»å‹ä¸ºæ•´å‹çš„ channel ã€‚</span>
<span class="hljs-comment">//ç”¨ goroutine å¼€å§‹æ’åºï¼›å½“å®ƒå®Œæˆæ—¶ï¼Œä¼šåœ¨ä¿¡é“ä¸Šå‘ä¿¡å·ã€‚</span>
<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
    list.Sort()
    c &lt;- <span class="hljs-number">1</span>  <span class="hljs-comment">// å‘é€ä¸€ä¸ªä¿¡å·ï¼Œè¿™ä¸ªå€¼å¹¶æ²¡æœ‰å…·ä½“æ„ä¹‰</span>
}()
doSomethingForAWhile()
&lt;-c   <span class="hljs-comment">// ç­‰å¾… sort æ‰§è¡Œå®Œæˆï¼Œç„¶åä» channel å–å€¼</span>
</span></span></foreignObject></svg></code></pre>
<p>æ¥æ”¶è€…åœ¨æ”¶åˆ°æ•°æ®å‰ä¼šä¸€ç›´é˜»å¡ã€‚è‹¥ä¿¡é“æ˜¯ä¸å¸¦ç¼“å†²çš„ï¼Œé‚£ä¹ˆåœ¨æ¥æ”¶è€…æ”¶åˆ°å€¼å‰ï¼Œ å‘é€è€…ä¼šä¸€ç›´é˜»å¡ï¼›è‹¥ä¿¡é“æ˜¯å¸¦ç¼“å†²çš„ï¼Œåˆ™å‘é€è€…ä»…åœ¨å€¼è¢«å¤åˆ¶åˆ°ç¼“å†²åŒºå‰é˜»å¡ï¼› è‹¥ç¼“å†²åŒºå·²æ»¡ï¼Œå‘é€è€…ä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°æŸä¸ªæ¥æ”¶è€…å–å‡ºä¸€ä¸ªå€¼ä¸ºæ­¢ã€‚</p>
<p>å¸¦ç¼“å†²çš„ä¿¡é“å¯è¢«ç”¨ä½œä¿¡å·é‡ï¼Œä¾‹å¦‚é™åˆ¶ååé‡ã€‚åœ¨æ­¤ä¾‹ä¸­ï¼Œè¿›å…¥çš„è¯·æ±‚ä¼šè¢«ä¼ é€’ç»™ <code>handle</code>ï¼Œå®ƒä»ä¿¡é“ä¸­æ¥æ”¶å€¼ï¼Œå¤„ç†è¯·æ±‚åå°†å€¼å‘å›è¯¥ä¿¡é“ä¸­ï¼Œä»¥ä¾¿è®©è¯¥ â€œä¿¡å·é‡â€ å‡†å¤‡è¿æ¥ä¸‹ä¸€æ¬¡è¯·æ±‚ã€‚ä¿¡é“ç¼“å†²åŒºçš„å®¹é‡å†³å®šäº†åŒæ—¶è°ƒç”¨ <code>process</code> çš„æ•°é‡ä¸Šé™ï¼Œå› æ­¤æˆ‘ä»¬åœ¨åˆå§‹åŒ–æ—¶é¦–å…ˆè¦å¡«å……è‡³å®ƒçš„å®¹é‡ä¸Šé™ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="120" data-paginate="true" data-theme="default" data-marpit-pagination="120" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> sem = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>, MaxOutstanding)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handle</span><span class="hljs-params">(r *Request)</span></span> {
    sem &lt;- <span class="hljs-number">1</span>    <span class="hljs-comment">// ç­‰å¾…æ´»åŠ¨é˜Ÿåˆ—æ¸…ç©ºã€‚</span>
    process(r)  <span class="hljs-comment">// å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚</span>
    &lt;-sem       <span class="hljs-comment">// å®Œæˆï¼›ä½¿ä¸‹ä¸€ä¸ªè¯·æ±‚å¯ä»¥è¿è¡Œã€‚</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Serve</span><span class="hljs-params">(queue <span class="hljs-keyword">chan</span> *Request)</span></span> {
    <span class="hljs-keyword">for</span> {
        req := &lt;-queue
        <span class="hljs-keyword">go</span> handle(req)  <span class="hljs-comment">// æ— éœ€ç­‰å¾… handle ç»“æŸã€‚</span>
    }
}
</span></span></foreignObject></svg></code></pre>
<p>ä¸€æ—¦ <code>MaxOutstanding</code> å¤„ç†ç¨‹åºæ‰§è¡Œäº† <code>process</code>ï¼Œä»»ä½•å°è¯•å‘é€åˆ°å·²å ç”¨çš„ä¿¡é“ç¼“å†²åŒºçš„æ“ä½œéƒ½ä¼šè¢«å±è”½ï¼Œç›´åˆ°è‡³å°‘ä¸€ä¸ªç¨‹åºå®Œæˆå¹¶ä»ç¼“å†²åŒºæ¥æ”¶ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="121" data-paginate="true" data-theme="default" data-marpit-pagination="121" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ç„¶è€Œï¼Œå®ƒå´æœ‰ä¸ªè®¾è®¡é—®é¢˜ï¼šå°½ç®¡åªæœ‰ <code>MaxOutstanding</code> ä¸ª Go åç¨‹èƒ½åŒæ—¶è¿è¡Œï¼Œä½† <code>Serve</code> è¿˜æ˜¯ä¸ºæ¯ä¸ªè¿›å…¥çš„è¯·æ±‚éƒ½åˆ›å»ºäº†æ–°çš„ Go åç¨‹ã€‚å…¶ç»“æœå°±æ˜¯ï¼Œè‹¥è¯·æ±‚æ¥å¾—å¾ˆå¿«ï¼Œ è¯¥ç¨‹åºå°±ä¼šæ— é™åœ°æ¶ˆè€—èµ„æºã€‚ä¸ºäº†å¼¥è¡¥è¿™ç§ä¸è¶³ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>Serve</code> æ¥é™åˆ¶åˆ›å»º Go åç¨‹ï¼Œè¿™æ˜¯ä¸ªæ˜æ˜¾çš„è§£å†³æ–¹æ¡ˆï¼Œä½†è¦å½“å¿ƒæˆ‘ä»¬ä¿®å¤åå‡ºç°çš„ Bugã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Serve</span><span class="hljs-params">(queue <span class="hljs-keyword">chan</span> *Request)</span></span> {
    <span class="hljs-keyword">for</span> req := <span class="hljs-keyword">range</span> queue {
        sem &lt;- <span class="hljs-number">1</span>
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
            process(req) <span class="hljs-comment">// Buggy; see explanation below.</span>
            &lt;-sem
        }()
    }
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="122" data-paginate="true" data-theme="default" data-marpit-pagination="122" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>Bug å‡ºç°åœ¨ Go çš„ <code>for</code> å¾ªç¯ä¸­ï¼Œè¯¥å¾ªç¯å˜é‡åœ¨æ¯æ¬¡è¿­ä»£æ—¶ä¼šè¢«é‡ç”¨ï¼Œå› æ­¤ <code>req</code> å˜é‡ä¼šåœ¨æ‰€æœ‰çš„ Go åç¨‹é—´å…±äº«ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬éœ€è¦ç¡®ä¿ <code>req</code> å¯¹äºæ¯ä¸ª Go åç¨‹æ¥è¯´éƒ½æ˜¯å”¯ä¸€çš„ã€‚æœ‰ä¸€ç§æ–¹æ³•èƒ½å¤Ÿåšåˆ°ï¼Œå°±æ˜¯å°† <code>req</code> çš„å€¼ä½œä¸ºå®å‚ä¼ å…¥åˆ°è¯¥ Go åç¨‹çš„é—­åŒ…ä¸­ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Serve</span><span class="hljs-params">(queue <span class="hljs-keyword">chan</span> *Request)</span></span> {
    <span class="hljs-keyword">for</span> req := <span class="hljs-keyword">range</span> queue {
        sem &lt;- <span class="hljs-number">1</span>
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(req *Request)</span></span> {
            process(req)
            &lt;-sem
        }(req)
    }
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="123" data-paginate="true" data-theme="default" data-marpit-pagination="123" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ¯”è¾ƒå‰åä¸¤ä¸ªç‰ˆæœ¬ï¼Œè§‚å¯Ÿè¯¥é—­åŒ…å£°æ˜å’Œè¿è¡Œä¸­çš„å·®åˆ«ã€‚ å¦ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯ä»¥ç›¸åŒçš„åå­—åˆ›å»ºæ–°çš„å˜é‡ï¼Œå¦‚ä¾‹ä¸­æ‰€ç¤ºï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Serve</span><span class="hljs-params">(queue <span class="hljs-keyword">chan</span> *Request)</span></span> {
    <span class="hljs-keyword">for</span> req := <span class="hljs-keyword">range</span> queue {
        req := req <span class="hljs-comment">// ä¸ºè¯¥Goåç¨‹åˆ›å»º req çš„æ–°å®ä¾‹ã€‚</span>
        sem &lt;- <span class="hljs-number">1</span>
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
            process(req)
            &lt;-sem
        }()
    }
}
</span></span></foreignObject></svg></code></pre>
<p>å®ƒçš„å†™æ³•çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ª</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>req := req
</span></span></foreignObject></svg></code></pre>
<p>ä½†åœ¨ Go ä¸­è¿™æ ·åšæ˜¯åˆæ³•ä¸”å¸¸è§çš„ã€‚ä½ ç”¨ç›¸åŒçš„åå­—è·å¾—äº†è¯¥å˜é‡çš„ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œ ä»¥æ­¤æ¥å±€éƒ¨åœ°åˆ»æ„å±è”½å¾ªç¯å˜é‡ï¼Œä½¿å®ƒå¯¹æ¯ä¸ª Go åç¨‹ä¿æŒå”¯ä¸€ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="124" data-paginate="true" data-theme="default" data-marpit-pagination="124" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å›åˆ°ç¼–å†™æœåŠ¡å™¨çš„ä¸€èˆ¬é—®é¢˜ä¸Šæ¥ã€‚å¦ä¸€ç§ç®¡ç†èµ„æºçš„å¥½æ–¹æ³•å°±æ˜¯å¯åŠ¨å›ºå®šæ•°é‡çš„ <code>handle</code> Go åç¨‹ï¼Œä¸€èµ·ä»è¯·æ±‚ä¿¡é“ä¸­è¯»å–æ•°æ®ã€‚Go åç¨‹çš„æ•°é‡é™åˆ¶äº†åŒæ—¶è°ƒç”¨ <code>process</code> çš„æ•°é‡ã€‚<code>Serve</code> åŒæ ·ä¼šæ¥æ”¶ä¸€ä¸ªé€šçŸ¥é€€å‡ºçš„ä¿¡é“ï¼Œ åœ¨å¯åŠ¨æ‰€æœ‰ Go åç¨‹åï¼Œå®ƒå°†é˜»å¡å¹¶æš‚åœä»ä¿¡é“ä¸­æ¥æ”¶æ¶ˆæ¯ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handle</span><span class="hljs-params">(queue <span class="hljs-keyword">chan</span> *Request)</span></span> {
    <span class="hljs-keyword">for</span> r := <span class="hljs-keyword">range</span> queue {
        process(r)
    }
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Serve</span><span class="hljs-params">(clientRequests <span class="hljs-keyword">chan</span> *Request, quit <span class="hljs-keyword">chan</span> <span class="hljs-keyword">bool</span>)</span></span> {
    <span class="hljs-comment">// å¯åŠ¨å¤„ç†ç¨‹åº</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; MaxOutstanding; i++ {
        <span class="hljs-keyword">go</span> handle(clientRequests)
    }
    &lt;-quit  <span class="hljs-comment">// ç­‰å¾…é€šçŸ¥é€€å‡ºã€‚</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="125" data-paginate="true" data-theme="default" data-marpit-pagination="125" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>ä¿¡é“ä¸­çš„ä¿¡é“</h3>
<p>Go æœ€é‡è¦çš„ç‰¹æ€§å°±æ˜¯ä¿¡é“æ˜¯ä¸€ç­‰å€¼ï¼Œå®ƒå¯ä»¥è¢«åˆ†é…å¹¶åƒå…¶å®ƒå€¼åˆ°å¤„ä¼ é€’ã€‚ è¿™ç§ç‰¹æ€§é€šå¸¸è¢«ç”¨æ¥å®ç°å®‰å…¨ã€å¹¶è¡Œçš„å¤šè·¯åˆ†è§£ã€‚</p>
<p>åœ¨ä¸Šä¸€èŠ‚çš„ä¾‹å­ä¸­ï¼Œ<code>handle</code> æ˜¯ä¸ªéå¸¸ç†æƒ³åŒ–çš„è¯·æ±‚å¤„ç†ç¨‹åºï¼Œ ä½†æˆ‘ä»¬å¹¶æœªå®šä¹‰å®ƒæ‰€å¤„ç†çš„è¯·æ±‚ç±»å‹ã€‚è‹¥è¯¥ç±»å‹åŒ…å«ä¸€ä¸ªå¯ç”¨äºå›å¤çš„ä¿¡é“ï¼Œ é‚£ä¹ˆæ¯ä¸€ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½ä¸ºå…¶å›åº”æä¾›è‡ªå·±çš„è·¯å¾„ã€‚ä»¥ä¸‹ä¸º <code>Request</code> ç±»å‹çš„å¤§æ¦‚å®šä¹‰ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Request <span class="hljs-keyword">struct</span> {
    args        []<span class="hljs-keyword">int</span>
    f           <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">([]<span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span>
    resultChan  <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="126" data-paginate="true" data-theme="default" data-marpit-pagination="126" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªå‡½æ•°åŠå…¶å®å‚ï¼Œæ­¤å¤–åœ¨è¯·æ±‚å¯¹è±¡ä¸­è¿˜æœ‰ä¸ªæ¥æ”¶åº”ç­”çš„ä¿¡é“ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sum</span><span class="hljs-params">(a []<span class="hljs-keyword">int</span>)</span> <span class="hljs-params">(s <span class="hljs-keyword">int</span>)</span></span> {
    <span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> a {
        s += v
    }
    <span class="hljs-keyword">return</span>
}

request := &amp;Request{[]<span class="hljs-keyword">int</span>{<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>}, sum, <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)}
<span class="hljs-comment">// å‘é€è¯·æ±‚</span>
clientRequests &lt;- request
<span class="hljs-comment">// ç­‰å¾…å›åº”</span>
fmt.Printf(<span class="hljs-string">"answer: %d\n"</span>, &lt;-request.resultChan)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="127" data-paginate="true" data-theme="default" data-marpit-pagination="127" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æœåŠ¡ç«¯æˆ‘ä»¬åªä¿®æ”¹ <code>handler</code> å‡½æ•°ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handle</span><span class="hljs-params">(queue <span class="hljs-keyword">chan</span> *Request)</span></span> {
    <span class="hljs-keyword">for</span> req := <span class="hljs-keyword">range</span> queue {
        req.resultChan &lt;- req.f(req.args)
    }
}
</span></span></foreignObject></svg></code></pre>
<p>è¦ä½¿å…¶å®é™…å¯ç”¨è¿˜æœ‰å¾ˆå¤šå·¥ä½œè¦åšï¼Œè¿™äº›ä»£ç ä»…èƒ½å®ç°ä¸€ä¸ªé€Ÿç‡æœ‰é™ã€å¹¶è¡Œã€éé˜»å¡ RPC ç³»ç»Ÿçš„ æ¡†æ¶ï¼Œè€Œä¸”å®ƒå¹¶ä¸åŒ…å«äº’æ–¥é”ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="128" data-paginate="true" data-theme="default" data-marpit-pagination="128" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>å¹¶è¡ŒåŒ–</h3>
<p>è¿™äº›è®¾è®¡çš„å¦ä¸€ä¸ªåº”ç”¨æ˜¯åœ¨å¤š CPU æ ¸å¿ƒä¸Šå®ç°å¹¶è¡Œè®¡ç®—ã€‚å¦‚æœè®¡ç®—è¿‡ç¨‹èƒ½å¤Ÿè¢«åˆ†ä¸ºå‡ å— å¯ç‹¬ç«‹æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œå®ƒå°±å¯ä»¥åœ¨æ¯å—è®¡ç®—ç»“æŸæ—¶å‘ä¿¡é“å‘é€ä¿¡å·ï¼Œä»è€Œå®ç°å¹¶è¡Œå¤„ç†ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªç†æƒ³åŒ–çš„ä¾‹å­ã€‚æˆ‘ä»¬åœ¨å¯¹ä¸€ç³»åˆ—å‘é‡é¡¹è¿›è¡Œæè€—èµ„æºçš„æ“ä½œï¼Œ è€Œæ¯ä¸ªé¡¹çš„å€¼è®¡ç®—æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> Vector []<span class="hljs-keyword">float64</span>

<span class="hljs-comment">// å°†æ­¤æ“åº”ç”¨è‡³ v[i], v[i+1] ... ç›´åˆ° v[n-1]</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(v Vector)</span> <span class="hljs-title">DoSome</span><span class="hljs-params">(i, n <span class="hljs-keyword">int</span>, u Vector, c <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)</span></span> {
    <span class="hljs-keyword">for</span> ; i &lt; n; i++ {
        v[i] += u.Op(v[i])
    }
    c &lt;- <span class="hljs-number">1</span>    <span class="hljs-comment">// signal that this piece is done</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="129" data-paginate="true" data-theme="default" data-marpit-pagination="129" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æˆ‘ä»¬åœ¨å¾ªç¯ä¸­å¯åŠ¨äº†ç‹¬ç«‹çš„å¤„ç†å—ï¼Œæ¯ä¸ª CPU å°†æ‰§è¡Œä¸€ä¸ªå¤„ç†ã€‚ å®ƒä»¬æœ‰å¯èƒ½ä»¥ä¹±åºçš„å½¢å¼å®Œæˆå¹¶ç»“æŸï¼Œä½†è¿™æ²¡æœ‰å…³ç³»ï¼› æˆ‘ä»¬åªéœ€åœ¨æ‰€æœ‰ Go åç¨‹å¼€å§‹åæ¥æ”¶ï¼Œå¹¶ç»Ÿè®¡ä¿¡é“ä¸­çš„å®Œæˆä¿¡å·å³å¯ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">const</span> numCPU = <span class="hljs-number">4</span> <span class="hljs-comment">// CPU æ ¸å¿ƒæ•°</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(v Vector)</span> <span class="hljs-title">DoAll</span><span class="hljs-params">(u Vector)</span></span> {
    c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>, numCPU)  <span class="hljs-comment">// ç¼“å†²åŒºæ˜¯å¯é€‰çš„ï¼Œä½†æ˜æ˜¾ç”¨ä¸Šæ›´å¥½</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; numCPU; i++ {
        <span class="hljs-keyword">go</span> v.DoSome(i*<span class="hljs-built_in">len</span>(v)/numCPU, (i+<span class="hljs-number">1</span>)*<span class="hljs-built_in">len</span>(v)/numCPU, u, c)
    }
    <span class="hljs-comment">// æ’ç©ºä¿¡é“ã€‚</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; numCPU; i++ {
        &lt;-c    <span class="hljs-comment">// ç­‰å¾…ä»»åŠ¡å®Œæˆ</span>
    }
    <span class="hljs-comment">// ä¸€åˆ‡å®Œæˆ</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="130" data-paginate="true" data-theme="default" data-marpit-pagination="130" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>é™¤äº†ç›´æ¥è®¾ç½® <code>numCPU</code> å¸¸é‡å€¼ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å‘ runtime è¯¢é—®ä¸€ä¸ªåˆç†çš„å€¼ã€‚å‡½æ•°  <code>[runtime.NumCPU](https://golang.org/pkg/runtime#NumCPU)</code> å¯ä»¥è¿”å›ç¡¬ä»¶ CPU ä¸Šçš„æ ¸å¿ƒæ•°é‡ï¼Œå¦‚æ­¤ä½¿ç”¨ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> numCPU = runtime.NumCPU()
</span></span></foreignObject></svg></code></pre>
<p>å¦å¤–ä¸€ä¸ªéœ€è¦çŸ¥é“çš„å‡½æ•°æ˜¯ <a href="https://golang.org/pkg/runtime#GOMAXPROCS"><code>runtime.GOMAXPROCS</code></a>ï¼Œä¼šè¿”å›ç”¨æˆ·è®¾ç½®å¯ç”¨ CPU æ•°é‡ã€‚é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨  <code>runtime.NumCPU</code> çš„å€¼ï¼Œä½†æ˜¯å¯ä»¥è¢«å‘½ä»¤è¡Œç¯å¢ƒå˜é‡ï¼Œæˆ–è€…è°ƒç”¨æ­¤å‡½æ•°å¹¶ä¼ å‚æ­£æ•´æ•°ã€‚ä¼ å‚ 0 çš„è¯ä¼šè¿”å›å€¼ï¼Œå‡å¦‚è¯´æˆ‘ä»¬å°Šé‡ç”¨æˆ·å¯¹èµ„æºçš„åˆ†é…ï¼Œå°±åº”è¯¥è¿™ä¹ˆå†™ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> numCPU = runtime.GOMAXPROCS(<span class="hljs-number">0</span>)
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="131" data-paginate="true" data-theme="default" data-marpit-pagination="131" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æ³¨æ„ä¸è¦æ··æ·†å¹¶å‘ï¼ˆconcurrencyï¼‰å’Œå¹¶è¡Œï¼ˆparallelismï¼‰çš„æ¦‚å¿µï¼šå¹¶å‘æ˜¯ç”¨å¯ç‹¬ç«‹æ‰§è¡Œç»„ä»¶æ„é€ ç¨‹åºçš„æ–¹æ³•ï¼Œ è€Œå¹¶è¡Œåˆ™æ˜¯ä¸ºäº†æ•ˆç‡åœ¨å¤š CPU ä¸Šå¹³è¡Œåœ°è¿›è¡Œè®¡ç®—ã€‚<br />
å°½ç®¡ Go çš„å¹¶å‘ç‰¹æ€§èƒ½å¤Ÿè®©æŸäº›é—®é¢˜æ›´æ˜“æ„é€ æˆå¹¶è¡Œè®¡ç®—ï¼Œ ä½† Go ä»ç„¶æ˜¯ç§å¹¶å‘è€Œéå¹¶è¡Œçš„è¯­è¨€ï¼Œä¸” Go çš„æ¨¡å‹å¹¶ä¸é€‚åˆæ‰€æœ‰çš„å¹¶è¡Œé—®é¢˜ã€‚<br />
å…³äºå…¶ä¸­åŒºåˆ«çš„è®¨è®ºï¼Œè§ <a href="http://blog.golang.org/2013/01/concurrency-is-not-parallelism.html">æ­¤åšæ–‡</a>ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="132" data-paginate="true" data-theme="default" data-marpit-pagination="132" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>å¯èƒ½æ³„éœ²çš„ç¼“å†²åŒº</h3>
<p>å¹¶å‘ç¼–ç¨‹çš„å·¥å…·ç”šè‡³èƒ½å¾ˆå®¹æ˜“åœ°è¡¨è¾¾éå¹¶å‘çš„æ€æƒ³ã€‚è¿™é‡Œæœ‰ä¸ªæå–è‡ª RPC åŒ…çš„ä¾‹å­ã€‚ å®¢æˆ·ç«¯ Go åç¨‹ä»æŸäº›æ¥æºï¼Œå¯èƒ½æ˜¯ç½‘ç»œä¸­å¾ªç¯æ¥æ”¶æ•°æ®ã€‚ä¸ºé¿å…åˆ†é…å’Œé‡Šæ”¾ç¼“å†²åŒºï¼Œ å®ƒä¿å­˜äº†ä¸€ä¸ªç©ºé—²é“¾è¡¨ï¼Œä½¿ç”¨ä¸€ä¸ªå¸¦ç¼“å†²ä¿¡é“è¡¨ç¤ºã€‚è‹¥ä¿¡é“ä¸ºç©ºï¼Œå°±ä¼šåˆ†é…æ–°çš„ç¼“å†²åŒºã€‚ ä¸€æ—¦æ¶ˆæ¯ç¼“å†²åŒºå°±ç»ªï¼Œå®ƒå°†é€šè¿‡ <code>serverChan</code> è¢«å‘é€åˆ°æœåŠ¡å™¨ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> freeList = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> *Buffer, <span class="hljs-number">100</span>)
<span class="hljs-keyword">var</span> serverChan = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> *Buffer)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">client</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">for</span> {
        <span class="hljs-keyword">var</span> b *Buffer
        <span class="hljs-comment">// è‹¥ç¼“å†²åŒºå¯ç”¨å°±ç”¨å®ƒï¼Œä¸å¯ç”¨å°±åˆ†é…ä¸ªæ–°çš„ã€‚</span>
        <span class="hljs-keyword">select</span> {
        <span class="hljs-keyword">case</span> b = &lt;-freeList:
            <span class="hljs-comment">// è·å–ä¸€ä¸ªï¼Œä¸åšåˆ«çš„ã€‚</span>
        <span class="hljs-keyword">default</span>:
            <span class="hljs-comment">// éç©ºé—²ï¼Œå› æ­¤åˆ†é…ä¸€ä¸ªæ–°çš„ã€‚</span>
            b = <span class="hljs-built_in">new</span>(Buffer)
        }
        load(b)              <span class="hljs-comment">// ä»ç½‘ç»œä¸­è¯»å–ä¸‹ä¸€æ¡æ¶ˆæ¯ã€‚</span>
        serverChan &lt;- b      <span class="hljs-comment">// å‘é€è‡³æœåŠ¡å™¨ã€‚</span>
    }
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="133" data-paginate="true" data-theme="default" data-marpit-pagination="133" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>æœåŠ¡å™¨ä»å®¢æˆ·ç«¯å¾ªç¯æ¥æ”¶æ¯ä¸ªæ¶ˆæ¯ï¼Œå¤„ç†å®ƒä»¬ï¼Œå¹¶å°†ç¼“å†²åŒºè¿”å›ç»™ç©ºé—²åˆ—è¡¨ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">server</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">for</span> {
        b := &lt;-serverChan    <span class="hljs-comment">// ç­‰å¾…å·¥ä½œã€‚</span>
        process(b)
        <span class="hljs-comment">// è‹¥ç¼“å†²åŒºæœ‰ç©ºé—´å°±é‡ç”¨å®ƒã€‚</span>
        <span class="hljs-keyword">select</span> {
        <span class="hljs-keyword">case</span> freeList &lt;- b:
            <span class="hljs-comment">// å°†ç¼“å†²åŒºæ”¾å¤§ç©ºé—²åˆ—è¡¨ä¸­ï¼Œä¸åšåˆ«çš„ã€‚</span>
        <span class="hljs-keyword">default</span>:
            <span class="hljs-comment">// ç©ºé—²åˆ—è¡¨å·²æ»¡ï¼Œä¿æŒå°±å¥½ã€‚</span>
        }
    }
}
</span></span></foreignObject></svg></code></pre>
<p>å®¢æˆ·ç«¯è¯•å›¾ä» <code>freeList</code> ä¸­è·å–ç¼“å†²åŒºï¼›è‹¥æ²¡æœ‰ç¼“å†²åŒºå¯ç”¨ï¼Œ å®ƒå°±å°†åˆ†é…ä¸€ä¸ªæ–°çš„ã€‚æœåŠ¡å™¨å°† <code>b</code> æ”¾å›ç©ºé—²åˆ—è¡¨ <code>freeList</code> ä¸­ç›´åˆ°åˆ—è¡¨å·²æ»¡ï¼Œæ­¤æ—¶ç¼“å†²åŒºå°†è¢«ä¸¢å¼ƒï¼Œå¹¶è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚ï¼ˆ<code>select</code> è¯­å¥ä¸­çš„ <code>default</code> å­å¥åœ¨æ²¡æœ‰æ¡ä»¶ç¬¦åˆæ—¶æ‰§è¡Œï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ <code>selects</code> æ°¸è¿œä¸ä¼šè¢«é˜»å¡ã€‚ï¼‰ä¾é å¸¦ç¼“å†²çš„ä¿¡é“å’Œåƒåœ¾å›æ”¶å™¨çš„è®°å½•ï¼Œ æˆ‘ä»¬ä»…ç”¨çŸ­çŸ­å‡ è¡Œä»£ç å°±æ„å»ºäº†ä¸€ä¸ªå¯èƒ½å¯¼è‡´ç¼“å†²åŒºæ§½ä½æ³„éœ²çš„ç©ºé—²åˆ—è¡¨ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="134" data-paginate="true" data-theme="default" data-marpit-pagination="134" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>é”™è¯¯</h2>
<p>åº“å‡½æ•°å¾ˆå¤šæ—¶å€™å¿…é¡»å°†é”™è¯¯ä¿¡æ¯è¿”å›ç»™å‡½æ•°çš„è°ƒç”¨è€…ã€‚å¦‚å‰æ‰€è¿°ï¼ŒGo å…è®¸å‡½æ•°å¯ä»¥æœ‰å¤šä¸ªè¿”å›å€¼çš„ç‰¹æ€§ï¼Œä½¿å¾—å‡½æ•°çš„è°ƒç”¨è€…åœ¨å¾—åˆ°æ­£å¸¸è¿”å›å€¼çš„åŒæ—¶ï¼Œå¯ä»¥è·å–åˆ°æ›´ä¸ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ã€‚å¯¹åº“å‡½æ•°çš„è®¾è®¡è€…æ¥è¯´ï¼Œä¸€ç§æ¨èçš„åšæ³•æ˜¯ä½¿ç”¨ç‰¹æ€§æ¥æä¾›è¯¦ç»†çš„å¼‚å¸¸ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œ <code>os.Open</code> åœ¨å¼‚å¸¸æ—¶å¹¶ä¸ä»…ä»…è¿”å›ä¸€ä¸ª <code>nil</code> æŒ‡é’ˆï¼Œå®ƒåŒæ—¶ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯å€¼ï¼Œç”¨äºæè¿°æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´äº†å¼‚å¸¸çš„å‘ç”Ÿã€‚</p>
<p>æŒ‰ç…§çº¦å®šï¼Œé”™è¯¯çš„ç±»å‹é€šå¸¸ä¸º <code>error</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªå†…ç½®çš„ç®€å•æ¥å£ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">type</span> error <span class="hljs-keyword">interface</span> {
    Error() <span class="hljs-keyword">string</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="135" data-paginate="true" data-theme="default" data-marpit-pagination="135" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>åº“çš„å¼€å‘è€…å¯ä»¥è‡ªç”±åœ°ç”¨æ›´ä¸°å¯Œçš„æ¨¡å‹å®ç°è¿™ä¸ªæ¥å£ï¼Œè¿™æ ·ä¸ä»…å¯ä»¥çœ‹åˆ°é”™è¯¯ï¼Œè¿˜å¯ä»¥æä¾›ä¸€äº›ä¸Šä¸‹æ–‡ã€‚å¦‚å‰æ‰€è¿°ï¼Œé™¤äº†é€šå¸¸çš„ <code>*os.File</code> è¿”å›å€¼å¤–ï¼Œ<code>os.Open</code> è¿˜è¿”å›ä¸€ä¸ªé”™è¯¯å€¼ã€‚å¦‚æœæ–‡ä»¶è¢«æˆåŠŸæ‰“å¼€ï¼Œé”™è¯¯å°†ä¸º <code>nil</code>ï¼Œä½†æ˜¯å½“å‡ºç°é—®é¢˜æ—¶ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ª <code>os.PathError</code> çš„é”™è¯¯ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// PathError è®°å½•é”™è¯¯ã€æ‰§è¡Œçš„æ“ä½œå’Œæ–‡ä»¶è·¯å¾„</span>
<span class="hljs-keyword">type</span> PathError <span class="hljs-keyword">struct</span> {
    Op <span class="hljs-keyword">string</span>    <span class="hljs-comment">// "open", "unlink" ç­‰ç­‰å¯¹æ–‡ä»¶çš„æ“ä½œ</span>
    Path <span class="hljs-keyword">string</span>  <span class="hljs-comment">// ç›¸å…³æ–‡ä»¶çš„è·¯å¾„</span>
    Err error    <span class="hljs-comment">// ç”±ç³»ç»Ÿè°ƒç”¨è¿”å›</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *PathError)</span> <span class="hljs-title">Error</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> e.Op + <span class="hljs-string">" "</span> + e.Path + <span class="hljs-string">": "</span> + e.Err.Error()
}
</span></span></foreignObject></svg></code></pre>
<p><code>PathError</code> çš„ <code>Error</code> ä¼šç”Ÿæˆå¦‚ä¸‹é”™è¯¯ä¿¡æ¯ï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>open /etc/passwx: no such file or directory
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="136" data-paginate="true" data-theme="default" data-marpit-pagination="136" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¿™ç§é”™è¯¯åŒ…å«äº†å‡ºé”™çš„æ–‡ä»¶åã€æ“ä½œå’Œè§¦å‘çš„æ“ä½œç³»ç»Ÿé”™è¯¯ã€‚å¯è§å³ä¾¿è¾“å‡ºé”™è¯¯ä¿¡æ¯æ—¶å·²ç»è¿œç¦»å¯¼è‡´é”™è¯¯çš„è°ƒç”¨ï¼Œå®ƒä¹Ÿä¼šéå¸¸æœ‰ç”¨ï¼Œè¿™æ¯”ç®€å•çš„ â€œä¸å­˜åœ¨è¯¥æ–‡ä»¶æˆ–ç›®å½•â€ åŒ…å«çš„ä¿¡æ¯ä¸°å¯Œå¾—å¤šã€‚</p>
<p>é”™è¯¯å­—ç¬¦ä¸²åº”å°½å¯èƒ½åœ°æŒ‡æ˜å®ƒä»¬çš„æ¥æºï¼Œä¾‹å¦‚äº§ç”Ÿè¯¥é”™è¯¯çš„åŒ…åå‰ç¼€ã€‚ä¾‹å¦‚åœ¨ <code>image</code> åŒ…ä¸­ï¼Œç”±äºæœªçŸ¥æ ¼å¼å¯¼è‡´è§£ç é”™è¯¯çš„å­—ç¬¦ä¸²ä¸º <code>image: unknown format</code>ï¼ˆæœªçŸ¥çš„æ ¼å¼ï¼‰ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="137" data-paginate="true" data-theme="default" data-marpit-pagination="137" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥è°ƒç”¨è€…å…³å¿ƒé”™è¯¯çš„å®Œæ•´ç»†èŠ‚ï¼Œå¯ä½¿ç”¨ç±»å‹é€‰æ‹©æˆ–è€…ç±»å‹æ–­è¨€æ¥æŸ¥çœ‹ç‰¹å®šé”™è¯¯ï¼Œå¹¶æŠ½å–å…¶ç»†èŠ‚ã€‚æ¯”å¦‚ <code>PathErrors</code>ï¼Œå®ƒä½ å¯èƒ½ä¼šæƒ³æ£€æŸ¥å†…éƒ¨çš„ <code>Err</code> å­—æ®µæ¥åˆ¤æ–­è¿™æ˜¯å¦æ˜¯ä¸€ä¸ªå¯ä»¥è¢«æ¢å¤çš„é”™è¯¯ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">for</span> try := <span class="hljs-number">0</span>; try &lt; <span class="hljs-number">2</span>; try++ {
    file, err = os.Create(filename)
    <span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> e, ok := err.(*os.PathError); ok &amp;&amp; e.Err == syscall.ENOSPC {
        deleteTempFiles()  <span class="hljs-comment">// æ¢å¤ä¸€äº›ç©ºé—´ã€‚</span>
        <span class="hljs-keyword">continue</span>
    }
    <span class="hljs-keyword">return</span>
}
</span></span></foreignObject></svg></code></pre>
<p>è¿™é‡Œçš„ç¬¬äºŒæ¡ <code>if</code> æ˜¯å¦ä¸€ç§æ–¹å¼ï¼Œç§°ä¸º <a href="https://learnku.com/docs/effective-go/interface-and-other-types/6246#2617cf">ç±»å‹æ–­è¨€</a>ã€‚è‹¥å®ƒå¤±è´¥ï¼Œ <code>ok</code> å°†ä¸º <code>false</code>ï¼Œè€Œ <code>e</code> åˆ™ä¸º <code>nil</code>. è‹¥å®ƒæˆåŠŸï¼Œ<code>ok</code> å°†ä¸º <code>true</code>ã€‚ç±»å‹æ–­è¨€è‹¥æˆåŠŸï¼Œåˆ™è¯¥é”™è¯¯å¿…ç„¶å±äº <code>*os.PathError</code> ç±»å‹ï¼Œè€Œ <code>e</code> èƒ½å¤Ÿæ£€æµ‹å…³äºè¯¥é”™è¯¯çš„æ›´å¤šä¿¡æ¯ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="138" data-paginate="true" data-theme="default" data-marpit-pagination="138" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>Panic</h3>
<p>å‘è°ƒç”¨è€…æŠ¥å‘Šé”™è¯¯çš„ä¸€èˆ¬æ–¹å¼å°±æ˜¯å°† <code>error</code> ä½œä¸ºé¢å¤–çš„å€¼è¿”å›ã€‚ æ ‡å‡†çš„ <code>Read</code> æ–¹æ³•å°±æ˜¯ä¸ªä¼—æ‰€å‘¨çŸ¥çš„å®ä¾‹ï¼Œå®ƒè¿”å›ä¸€ä¸ªå­—èŠ‚è®¡æ•°å’Œä¸€ä¸ª <code>error</code>ã€‚ä½†å¦‚æœé”™è¯¯æ—¶ä¸å¯æ¢å¤çš„å‘¢ï¼Ÿæœ‰æ—¶ç¨‹åºå°±æ˜¯ä¸èƒ½ç»§ç»­è¿è¡Œã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬æä¾›äº†å†…å»ºçš„ <code>panic</code> å‡½æ•°ï¼Œå®ƒä¼šäº§ç”Ÿä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯å¹¶ç»ˆæ­¢ç¨‹åº ï¼ˆä½†è¯·ç»§ç»­çœ‹ä¸‹ä¸€èŠ‚ï¼‰ã€‚è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªä»»æ„ç±»å‹çš„å®å‚ï¼ˆä¸€èˆ¬ä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œå¹¶åœ¨ç¨‹åºç»ˆæ­¢æ—¶æ‰“å°ã€‚ å®ƒè¿˜èƒ½è¡¨æ˜å‘ç”Ÿäº†æ„æ–™ä¹‹å¤–çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä»æ— é™å¾ªç¯ä¸­é€€å‡ºäº†ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="139" data-paginate="true" data-theme="default" data-marpit-pagination="139" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// ç”¨ç‰›é¡¿æ³•è®¡ç®—ç«‹æ–¹æ ¹çš„ä¸€ä¸ªç©å…·å®ç°ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">CubeRoot</span><span class="hljs-params">(x <span class="hljs-keyword">float64</span>)</span> <span class="hljs-title">float64</span></span> {
    z := x/<span class="hljs-number">3</span>   <span class="hljs-comment">// Arbitrary initial value</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1e6</span>; i++ {
        prevz := z
        z -= (z*z*z-x) / (<span class="hljs-number">3</span>*z*z)
        <span class="hljs-keyword">if</span> veryClose(z, prevz) {
            <span class="hljs-keyword">return</span> z
        }
    }
    <span class="hljs-comment">// ä¸€ç™¾ä¸‡æ¬¡è¿­ä»£å¹¶æœªæ”¶æ•›ï¼Œäº‹æƒ…å‡ºé”™äº†ã€‚</span>
    <span class="hljs-built_in">panic</span>(fmt.Sprintf(<span class="hljs-string">"CubeRoot(%g) did not converge"</span>, x))
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="140" data-paginate="true" data-theme="default" data-marpit-pagination="140" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è¿™ä»…ä»…æ˜¯ä¸ªç¤ºä¾‹ï¼ŒçœŸæ­£çš„åº“å‡½æ•°åº”é¿å… <code>panic</code>ã€‚è‹¥é—®é¢˜å¯ä»¥è¢«å±è”½æˆ–è§£å†³ï¼Œ æœ€å¥½å°±æ˜¯è®©ç¨‹åºç»§ç»­è¿è¡Œè€Œä¸æ˜¯ç»ˆæ­¢æ•´ä¸ªç¨‹åºã€‚ä¸€ä¸ªå¯èƒ½çš„åä¾‹å°±æ˜¯åˆå§‹åŒ–ï¼šè‹¥æŸä¸ªåº“çœŸçš„ä¸èƒ½è®©è‡ªå·±å·¥ä½œï¼Œä¸”æœ‰è¶³å¤Ÿç†ç”±äº§ç”Ÿ Panicï¼Œé‚£å°±ç”±å®ƒå»å§ã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">var</span> user = os.Getenv(<span class="hljs-string">"USER"</span>)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">if</span> user == <span class="hljs-string">""</span> {
        <span class="hljs-built_in">panic</span>(<span class="hljs-string">"no value for $USER"</span>)
    }
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="141" data-paginate="true" data-theme="default" data-marpit-pagination="141" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h3>recover</h3>
<p>å½“ <code>panic</code> è¢«è°ƒç”¨åï¼ˆåŒ…æ‹¬ä¸æ˜ç¡®çš„è¿è¡Œæ—¶é”™è¯¯ï¼Œä¾‹å¦‚åˆ‡ç‰‡è¶Šç•Œè®¿é—®æˆ–ç±»å‹æ–­è¨€å¤±è´¥ï¼‰ï¼Œ ç¨‹åºå°†ç«‹åˆ»ç»ˆæ­¢å½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œå¹¶å¼€å§‹å›æº¯ Go åç¨‹çš„æ ˆï¼Œè¿è¡Œä»»ä½•è¢«æ¨è¿Ÿçš„å‡½æ•°ã€‚ è‹¥å›æº¯åˆ°è¾¾ Go åç¨‹æ ˆçš„é¡¶ç«¯ï¼Œç¨‹åºå°±ä¼šç»ˆæ­¢ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥ç”¨å†…å»ºçš„ <code>recover</code> å‡½æ•°æ¥é‡æ–°æˆ–æ¥å–å› Go åç¨‹çš„æ§åˆ¶æƒé™å¹¶ä½¿å…¶æ¢å¤æ­£å¸¸æ‰§è¡Œã€‚</p>
<p>è°ƒç”¨ <code>recover</code> å°†åœæ­¢å›æº¯è¿‡ç¨‹ï¼Œå¹¶è¿”å›ä¼ å…¥ <code>panic</code> çš„å®å‚ã€‚ ç”±äºåœ¨å›æº¯æ—¶åªæœ‰è¢«æ¨è¿Ÿå‡½æ•°ä¸­çš„ä»£ç åœ¨è¿è¡Œï¼Œå› æ­¤ <code>recover</code> åªèƒ½åœ¨è¢«æ¨è¿Ÿçš„å‡½æ•°ä¸­æ‰æœ‰æ•ˆã€‚</p>
<p><code>recover</code> çš„ä¸€ä¸ªåº”ç”¨å°±æ˜¯åœ¨æœåŠ¡å™¨ä¸­ç»ˆæ­¢å¤±è´¥çš„ Go åç¨‹è€Œæ— éœ€æ€æ­»å…¶å®ƒæ­£åœ¨æ‰§è¡Œçš„ Go åç¨‹ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="142" data-paginate="true" data-theme="default" data-marpit-pagination="142" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">server</span><span class="hljs-params">(workChan &lt;-<span class="hljs-keyword">chan</span> *Work)</span></span> {
    <span class="hljs-keyword">for</span> work := <span class="hljs-keyword">range</span> workChan {
        <span class="hljs-keyword">go</span> safelyDo(work)
    }
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">safelyDo</span><span class="hljs-params">(work *Work)</span></span> {
    <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> err := <span class="hljs-built_in">recover</span>(); err != <span class="hljs-literal">nil</span> {
            log.Println(<span class="hljs-string">"work failed:"</span>, err)
        }
    }()
    do(work)
}
</span></span></foreignObject></svg></code></pre>
<p>åœ¨æ­¤ä¾‹ä¸­ï¼Œè‹¥ <code>do(work)</code> è§¦å‘äº† Panicï¼Œå…¶ç»“æœå°±ä¼šè¢«è®°å½•ï¼Œ è€Œè¯¥ Go åç¨‹ä¼šè¢«å¹²å‡€åˆ©è½åœ°ç»“æŸï¼Œä¸ä¼šå¹²æ‰°åˆ°å…¶å®ƒ Go åç¨‹ã€‚æˆ‘ä»¬æ— éœ€åœ¨æ¨è¿Ÿçš„é—­åŒ…ä¸­åšä»»ä½•äº‹æƒ…ï¼Œ <code>recover</code> ä¼šå¤„ç†å¥½è¿™ä¸€åˆ‡ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="143" data-paginate="true" data-theme="default" data-marpit-pagination="143" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ç”±äºç›´æ¥ä»è¢«æ¨è¿Ÿå‡½æ•°ä¸­è°ƒç”¨ <code>recover</code> æ—¶ä¸ä¼šè¿”å› <code>nil</code>ï¼Œ å› æ­¤è¢«æ¨è¿Ÿçš„ä»£ç èƒ½å¤Ÿè°ƒç”¨æœ¬èº«ä½¿ç”¨äº† <code>panic</code> å’Œ <code>recover</code> çš„åº“å‡½æ•°è€Œä¸ä¼šå¤±è´¥ã€‚ä¾‹å¦‚åœ¨ <code>safelyDo</code> ä¸­ï¼Œè¢«æ¨è¿Ÿçš„å‡½æ•°å¯èƒ½åœ¨è°ƒç”¨ <code>recover</code> å‰å…ˆè°ƒç”¨è®°å½•å‡½æ•°ï¼Œè€Œè¯¥è®°å½•å‡½æ•°åº”å½“ä¸å— Panic çŠ¶æ€çš„ä»£ç çš„å½±å“ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="144" data-paginate="true" data-theme="default" data-marpit-pagination="144" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>é€šè¿‡æ°å½“åœ°ä½¿ç”¨æ¢å¤æ¨¡å¼ï¼Œ<code>do</code> å‡½æ•°ï¼ˆåŠå…¶è°ƒç”¨çš„ä»»ä½•ä»£ç ï¼‰å¯é€šè¿‡è°ƒç”¨ <code>panic</code> æ¥é¿å…æ›´åçš„ç»“æœã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§æ€æƒ³æ¥ç®€åŒ–å¤æ‚è½¯ä»¶ä¸­çš„é”™è¯¯å¤„ç†ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ <code>regexp</code> åŒ…çš„ç†æƒ³åŒ–ç‰ˆæœ¬ï¼Œå®ƒä¼šä»¥å±€éƒ¨çš„é”™è¯¯ç±»å‹è°ƒç”¨ <code>panic</code> æ¥æŠ¥å‘Šè§£æé”™è¯¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª <code>error</code> ç±»å‹çš„ <code>Error</code> æ–¹æ³•å’Œä¸€ä¸ª <code>Compile</code> å‡½æ•°çš„å®šä¹‰ï¼š</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="145" data-paginate="true" data-theme="default" data-marpit-pagination="145" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment">// Error æ˜¯è§£æé”™è¯¯çš„ç±»å‹ï¼Œå®ƒæ»¡è¶³ error æ¥å£ã€‚</span>
<span class="hljs-keyword">type</span> Error <span class="hljs-keyword">string</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e Error)</span> <span class="hljs-title">Error</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>(e)
}

<span class="hljs-comment">// error æ˜¯ *Regexp çš„æ–¹æ³•ï¼Œå®ƒé€šè¿‡ç”¨ä¸€ä¸ª Error </span>
<span class="hljs-comment">// è§¦å‘Panicæ¥æŠ¥å‘Šè§£æé”™è¯¯ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(regexp *Regexp)</span> <span class="hljs-title">error</span><span class="hljs-params">(err <span class="hljs-keyword">string</span>)</span></span> {
    <span class="hljs-built_in">panic</span>(Error(err))
}

<span class="hljs-comment">// Compile è¿”å›è¯¥æ­£åˆ™è¡¨è¾¾å¼è§£æåçš„è¡¨ç¤ºã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Compile</span><span class="hljs-params">(str <span class="hljs-keyword">string</span>)</span> <span class="hljs-params">(regexp *Regexp, err error)</span></span> {
    regexp = <span class="hljs-built_in">new</span>(Regexp)
    <span class="hljs-comment">// å½“å‘ç”Ÿè§£æé”™è¯¯æ—¶ï¼ŒdoParse ä¼šè§¦å‘ panic</span>
    <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> e := <span class="hljs-built_in">recover</span>(); e != <span class="hljs-literal">nil</span> {
            regexp = <span class="hljs-literal">nil</span>    <span class="hljs-comment">// æ¸…ç†è¿”å›å€¼ã€‚</span>
            err = e.(Error) <span class="hljs-comment">// è‹¥å®ƒä¸æ˜¯è§£æé”™è¯¯ï¼Œå°†é‡æ–°è§¦å‘Panicã€‚</span>
        }
    }()
    <span class="hljs-keyword">return</span> regexp.doParse(str), <span class="hljs-literal">nil</span>
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="146" data-paginate="true" data-theme="default" data-marpit-pagination="146" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>è‹¥ <code>doParse</code> è§¦å‘äº† Panicï¼Œæ¢å¤å—ä¼šå°†è¿”å›å€¼è®¾ä¸º <code>nil</code> â€” è¢«æ¨è¿Ÿçš„å‡½æ•°èƒ½å¤Ÿä¿®æ”¹å·²å‘½åçš„è¿”å›å€¼ã€‚åœ¨ <code>err</code> çš„èµ‹å€¼è¿‡ç¨‹ä¸­ï¼Œ æˆ‘ä»¬å°†é€šè¿‡æ–­è¨€å®ƒæ˜¯å¦æ‹¥æœ‰å±€éƒ¨ç±»å‹ <code>Error</code> æ¥æ£€æŸ¥å®ƒã€‚è‹¥å®ƒæ²¡æœ‰ï¼Œ ç±»å‹æ–­è¨€å°†ä¼šå¤±è´¥ï¼Œæ­¤æ—¶ä¼šäº§ç”Ÿè¿è¡Œæ—¶é”™è¯¯ï¼Œå¹¶ç»§ç»­æ ˆçš„å›æº¯ï¼Œä»¿ä½›ä¸€åˆ‡ä»æœªä¸­æ–­è¿‡ä¸€æ ·ã€‚ è¯¥æ£€æŸ¥æ„å‘³ç€è‹¥å‘ç”Ÿäº†ä¸€äº›åƒç´¢å¼•è¶Šç•Œä¹‹ç±»çš„æ„å¤–ï¼Œé‚£ä¹ˆå³ä¾¿æˆ‘ä»¬ä½¿ç”¨äº† <code>panic</code> å’Œ <code>recover</code> æ¥å¤„ç†è§£æé”™è¯¯ï¼Œä»£ç ä»ç„¶ä¼šå¤±è´¥ã€‚</p>
<p>é€šè¿‡é€‚å½“çš„é”™è¯¯å¤„ç†ï¼Œ<code>error</code> æ–¹æ³•ï¼ˆç”±äºå®ƒæ˜¯ä¸ªç»‘å®šåˆ°å…·ä½“ç±»å‹çš„æ–¹æ³•ï¼Œ å› æ­¤å³ä¾¿å®ƒä¸å†…å»ºçš„ <code>error</code> ç±»å‹åå­—ç›¸åŒä¹Ÿæ²¡æœ‰å…³ç³»ï¼‰ èƒ½è®©æŠ¥å‘Šè§£æé”™è¯¯å˜å¾—æ›´å®¹æ˜“ï¼Œè€Œæ— éœ€æ‰‹åŠ¨å¤„ç†å›æº¯çš„è§£ææ ˆï¼š</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">if</span> pos == <span class="hljs-number">0</span> {
    re.error(<span class="hljs-string">"'*' illegal at start of expression"</span>)
}
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="147" data-paginate="true" data-theme="default" data-marpit-pagination="147" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å°½ç®¡è¿™ç§æ¨¡å¼å¾ˆæœ‰ç”¨ï¼Œä½†å®ƒåº”å½“ä»…åœ¨åŒ…å†…ä½¿ç”¨ã€‚<code>Parse</code> ä¼šå°†å…¶å†…éƒ¨çš„ <code>panic</code> è°ƒç”¨è½¬ä¸º <code>error</code> å€¼ï¼Œå®ƒå¹¶ä¸ä¼šå‘è°ƒç”¨è€…æš´éœ²å‡º <code>panic</code>ã€‚è¿™æ˜¯ä¸ªå€¼å¾—éµå®ˆçš„è‰¯å¥½è§„åˆ™ã€‚</p>
<p>é¡ºä¾¿ä¸€æï¼Œè¿™ç§é‡æ–°è§¦å‘ Panic çš„æƒ¯ç”¨æ³•ä¼šåœ¨äº§ç”Ÿå®é™…é”™è¯¯æ—¶æ”¹å˜ Panic çš„å€¼ã€‚ ç„¶è€Œï¼Œä¸ç®¡æ˜¯åŸå§‹çš„è¿˜æ˜¯æ–°çš„é”™è¯¯éƒ½ä¼šåœ¨å´©æºƒæŠ¥å‘Šä¸­æ˜¾ç¤ºï¼Œå› æ­¤é—®é¢˜çš„æ ¹æºä»ç„¶æ˜¯å¯è§çš„ã€‚ è¿™ç§ç®€å•çš„é‡æ–°è§¦å‘ Panic çš„æ¨¡å‹å·²ç»å¤Ÿç”¨äº†ï¼Œæ¯•ç«Ÿä»–åªæ˜¯ä¸€æ¬¡å´©æºƒã€‚ ä½†è‹¥ä½ åªæƒ³æ˜¾ç¤ºåŸå§‹çš„å€¼ï¼Œä¹Ÿå¯ä»¥å¤šå†™ä¸€ç‚¹ä»£ç æ¥è¿‡æ»¤æ‰ä¸éœ€è¦çš„é—®é¢˜ï¼Œç„¶åç”¨åŸå§‹å€¼å†æ¬¡è§¦å‘ Panicã€‚ è¿™é‡Œå°±å°†è¿™ä¸ªç»ƒä¹ ç•™ç»™è¯»è€…äº†ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="148" data-paginate="true" data-theme="default" data-marpit-pagination="148" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<h2>ç¤ºä¾‹ï¼šWeb æœåŠ¡å™¨</h2>
<p>è®©æˆ‘ä»¬ä»¥ä¸€ä¸ªå®Œæ•´çš„ Go ç¨‹åºä½œä¸ºç»“æŸå§ï¼Œä¸€ä¸ª Web æœåŠ¡å™¨ã€‚è¯¥ç¨‹åºå…¶å®åªæ˜¯ä¸ª Web æœåŠ¡å™¨çš„é‡ç”¨ã€‚ Google åœ¨ <a href="http://chart.apis.google.com/">chart.apis.google.com</a> ä¸Šæä¾›äº†ä¸€ä¸ªå°†è¡¨å•æ•°æ®è‡ªåŠ¨è½¬æ¢ä¸ºå›¾è¡¨çš„æœåŠ¡ã€‚ä¸è¿‡ï¼Œè¯¥æœåŠ¡å¾ˆéš¾äº¤äº’ï¼Œ å› ä¸ºä½ éœ€è¦å°†æ•°æ®ä½œä¸ºæŸ¥è¯¢æ”¾åˆ° URL ä¸­ã€‚æ­¤ç¨‹åºä¸ºä¸€ç§æ•°æ®æ ¼å¼æä¾›äº†æ›´å¥½çš„çš„æ¥å£ï¼š ç»™å®šä¸€å°æ®µæ–‡æœ¬ï¼Œå®ƒå°†è°ƒç”¨å›¾è¡¨æœåŠ¡å™¨æ¥ç”ŸæˆäºŒç»´ç ï¼ˆQR ç ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ç¼–ç æ–‡æœ¬çš„ç‚¹æ ¼çŸ©é˜µã€‚ è¯¥å›¾åƒå¯è¢«ä½ çš„æ‰‹æœºæ‘„åƒå¤´æ•è·ï¼Œå¹¶è§£é‡Šä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ URLï¼Œ è¿™æ ·å°±å…å»äº†ä½ åœ¨ç‹­å°çš„æ‰‹æœºé”®ç›˜ä¸Šé”®å…¥ URL çš„éº»çƒ¦ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="149" data-paginate="true" data-theme="default" data-marpit-pagination="149" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>ä»¥ä¸‹ä¸ºå®Œæ•´çš„ç¨‹åºï¼Œéšåæœ‰ä¸€æ®µè§£é‡Šã€‚</p>
<pre><code class="language-go"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"flag"</span>
    <span class="hljs-string">"html/template"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"net/http"</span>
)

<span class="hljs-keyword">var</span> addr = flag.String(<span class="hljs-string">"addr"</span>, <span class="hljs-string">":1718"</span>, <span class="hljs-string">"http service address"</span>) <span class="hljs-comment">// Q=17, R=18</span>

<span class="hljs-keyword">var</span> templ = template.Must(template.New(<span class="hljs-string">"qr"</span>).Parse(templateStr))

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    flag.Parse()
    http.Handle(<span class="hljs-string">"/"</span>, http.HandlerFunc(QR))
    err := http.ListenAndServe(*addr, <span class="hljs-literal">nil</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(<span class="hljs-string">"ListenAndServe:"</span>, err)
    }
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">QR</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
    templ.Execute(w, req.FormValue(<span class="hljs-string">"s"</span>))
}

<span class="hljs-keyword">const</span> templateStr = <span class="hljs-string">`
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;QR Link Generator&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{{if .}}
&lt;img src="http://chart.apis.google.com/chart?chs=300x300&amp;cht=qr&amp;choe=UTF-8&amp;chl={{.}}" /&gt;
&lt;br&gt;
{{.}}
&lt;br&gt;
&lt;br&gt;
{{end}}
&lt;form action="/" name=f method="GET"&gt;&lt;input maxLength=1024 size=70
name=s value="" title="Text to QR Encode"&gt;&lt;input type=submit
value="Show QR" name=qr&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
`</span>
</span></span></foreignObject></svg></code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="150" data-paginate="true" data-theme="default" data-marpit-pagination="150" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p><code>main</code> ä¹‹å‰çš„ä»£ç åº”è¯¥æ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ ‡å¿—ä¸ºæœåŠ¡å™¨è®¾ç½®äº†é»˜è®¤ç«¯å£ã€‚ æ¨¡æ¿å˜é‡ <code>templ</code> æ­£å¼æœ‰è¶£çš„åœ°æ–¹ã€‚å®ƒæ„å»ºçš„ HTML æ¨¡ç‰ˆå°†ä¼šè¢«æœåŠ¡å™¨æ‰§è¡Œå¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸­ã€‚ ç¨åæˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºã€‚</p>
<p><code>main</code> å‡½æ•°è§£æäº†å‚æ•°æ ‡å¿—å¹¶ä½¿ç”¨æˆ‘ä»¬è®¨è®ºè¿‡çš„æœºåˆ¶å°† <code>QR</code> å‡½æ•°ç»‘å®šåˆ°æœåŠ¡å™¨çš„æ ¹è·¯å¾„ã€‚ç„¶åè°ƒç”¨ <code>http.ListenAndServe</code> å¯åŠ¨æœåŠ¡å™¨ï¼›å®ƒå°†åœ¨æœåŠ¡å™¨è¿è¡Œæ—¶å¤„äºé˜»å¡çŠ¶æ€ã€‚</p>
<p><code>QR</code> ä»…æ¥å—åŒ…å«è¡¨å•æ•°æ®çš„è¯·æ±‚ï¼Œå¹¶ä¸ºè¡¨å•å€¼ <code>s</code> ä¸­çš„æ•°æ®æ‰§è¡Œæ¨¡æ¿ã€‚</p>
<p>æ¨¡æ¿åŒ… <code>html/template</code> éå¸¸å¼ºå¤§ï¼›è¯¥ç¨‹åºåªæ˜¯æµ…å°è¾„æ­¢ã€‚ æœ¬è´¨ä¸Šï¼Œå®ƒé€šè¿‡åœ¨è¿è¡Œæ—¶å°†æ•°æ®é¡¹ä¸­æå–çš„å…ƒç´ ï¼ˆåœ¨è¿™é‡Œæ˜¯è¡¨å•å€¼ï¼‰ä¼ ç»™ <code>templ.Execute</code> æ‰§è¡Œå› è€Œé‡å†™äº† HTML æ–‡æœ¬ã€‚ åœ¨æ¨¡æ¿æ–‡æœ¬ï¼ˆ<code>templateStr</code>ï¼‰ä¸­ï¼ŒåŒå¤§æ‹¬å·ç•Œå®šçš„æ–‡æœ¬è¡¨ç¤ºæ¨¡æ¿çš„åŠ¨ä½œã€‚ ä» <code>{{if .}}</code> åˆ° <code>{{end}}</code> çš„ä»£ç æ®µä»…åœ¨å½“å‰æ•°æ®é¡¹ï¼ˆè¿™é‡Œæ˜¯ç‚¹ <code>.</code>ï¼‰çš„å€¼éç©ºæ—¶æ‰ä¼šæ‰§è¡Œã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å­—ç¬¦ä¸²ä¸ºç©ºæ—¶ï¼Œæ­¤éƒ¨åˆ†æ¨¡æ¿æ®µä¼šè¢«å¿½ç•¥ã€‚</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="151" data-paginate="true" data-theme="default" data-marpit-pagination="151" data-marpit-pagination-total="151" style="--paginate:true;--theme:default;">
<p>å…¶ä¸­ä¸¤æ®µ <code>{{.}}</code> è¡¨ç¤ºè¦å°†æ•°æ®æ˜¾ç¤ºåœ¨æ¨¡æ¿ä¸­ ï¼ˆå³å°†æŸ¥è¯¢å­—ç¬¦ä¸²æ˜¾ç¤ºåœ¨ Web é¡µé¢ä¸Šï¼‰ã€‚HTML æ¨¡æ¿åŒ…å°†è‡ªåŠ¨å¯¹æ–‡æœ¬è¿›è¡Œè½¬ä¹‰ï¼Œ å› æ­¤æ–‡æœ¬çš„æ˜¾ç¤ºæ˜¯å®‰å…¨çš„ã€‚</p>
<p>ä½™ä¸‹çš„æ¨¡æ¿å­—ç¬¦ä¸²åªæ˜¯é¡µé¢åŠ è½½æ—¶å°†è¦æ˜¾ç¤ºçš„ HTMLã€‚å¦‚æœè¿™æ®µè§£é‡Šä½ æ— æ³•ç†è§£ï¼Œè¯·å‚è€ƒ <a href="https://go-zh.org/pkg/html/template/">æ–‡æ¡£</a> è·å¾—æ›´å¤šæœ‰å…³æ¨¡æ¿åŒ…çš„è§£é‡Šã€‚</p>
<p>ä½ ç»ˆäºå¦‚æ„¿ä»¥å¿äº†ï¼šä»¥å‡ è¡Œä»£ç å®ç°çš„ï¼ŒåŒ…å«ä¸€äº›æ•°æ®é©±åŠ¨çš„ HTML æ–‡æœ¬çš„ Web æœåŠ¡å™¨ã€‚ Go è¯­è¨€å¼ºå¤§åˆ°èƒ½è®©å¾ˆå¤šäº‹æƒ…ä»¥çŸ­å°ç²¾æ‚çš„æ–¹å¼è§£å†³ã€‚</p>
</section>
<script>!function(){"use strict";function t(t){Array.from(document.getElementsByTagName("svg"),e=>{if(e.hasAttribute("data-marpit-svg")){const{clientHeight:r,clientWidth:a}=e;e.style.transform||(e.style.transform="translateZ(0)");const o=t||e.currentScale||1,i=e.viewBox.baseVal.width/o,n=e.viewBox.baseVal.height/o,s=Math.min(r/n,a/i);Array.from(e.querySelectorAll(":scope > foreignObject"),t=>{const e=t.x.baseVal.value,o=t.y.baseVal.value;Array.from(t.querySelectorAll(":scope > section"),t=>{t.style.transformOrigin||(t.style.transformOrigin="0 0");const l=(a-s*i)/2-e,c=(r-s*n)/2-o;t.style.transform=`translate3d(${l}px,${c}px,0) scale(${s}) translate(${e}px,${o}px)`})})}})}const e=(t,e,r)=>{if(t.getAttribute(e)!==r)return t.setAttribute(e,r),!0};function r(a=!0){for(const e of"Apple Computer, Inc."===navigator.vendor?[t]:[])e();Array.from(document.querySelectorAll('svg[data-marp-fitting="svg"]'),t=>{const r=t.firstChild,a=r.firstChild,{scrollWidth:o,scrollHeight:i}=a;let n,s=1;if(t.hasAttribute("data-marp-fitting-code")&&(n=t.parentElement.parentElement),t.hasAttribute("data-marp-fitting-math")&&(n=t.parentElement),n){const t=getComputedStyle(n),e=Math.ceil(n.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight));e&&(s=e)}const l=Math.max(o,s),c=Math.max(i,1),p=`0 0 ${l} ${c}`;e(r,"width",""+l),e(r,"height",""+c),e(t,"preserveAspectRatio",getComputedStyle(t).getPropertyValue("--preserve-aspect-ratio")||"xMinYMin meet"),e(t,"viewBox",p)&&t.classList.toggle("__reflow__")}),a&&window.requestAnimationFrame(()=>r(a))}!function(){if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");window.marpCoreBrowserScript?console.warn("Marp Core's browser script has already executed."):(Object.defineProperty(window,"marpCoreBrowserScript",{value:!0}),r())}()}();
</script></foreignObject></svg></div><script>!function(){"use strict";var e=function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),s=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),a={},o=function(e,t){return(t=t||{}).index=s.indexOf(e),t.slide=e,t},i=function(e,t){a[e]=(a[e]||[]).filter((function(e){return e!==t}))},l=function(e,t){return(a[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},c=function(e,t){s[e]&&(n&&l("deactivate",o(n,t)),n=s[e],l("activate",o(n,t)))},d=function(e,t){var r=s.indexOf(n)+e;l(e>0?"next":"prev",o(n,t))&&c(r,t)},u={off:i,on:function(e,t){return(a[e]||(a[e]=[])).push(t),i.bind(null,e,t)},fire:l,slide:function(e,t){if(!arguments.length)return s.indexOf(n);l("slide",o(s[e],t))&&c(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:s,destroy:function(e){l("destroy",o(n,e)),a={}}};return(t||[]).forEach((function(e){e(u)})),n||c(0),u};function t(e){e.parent.classList.add("bespoke-marp-parent"),e.slides.map(e=>e.classList.add("bespoke-marp-slide")),e.on("activate",t=>{e.slides.map(e=>e.classList.remove("bespoke-marp-active")),t.slide.classList.add("bespoke-marp-active")})}function n(e=2e3){return t=>{let n;function r(){n&&clearTimeout(n),n=setTimeout(()=>{t.parent.classList.add("bespoke-marp-inactive")},e),t.parent.classList.remove("bespoke-marp-inactive")}document.addEventListener("mousedown",r),document.addEventListener("mousemove",r),document.addEventListener("touchend",r),setTimeout(r,0)}}const r=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"];function s(e){e.parent.addEventListener("keydown",e=>{if(!e.target)return;const t=e.target;(r.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()})}function a(e){window.addEventListener("load",()=>{for(const t of e.slides){const e=t.querySelector("[data-marp-fitting]")?"":"hideable";t.setAttribute("data-bespoke-marp-load",e)}})}function o(e){let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map(e=>[null,...e.querySelectorAll("[data-marpit-fragment]")])});const r=r=>void 0!==e.fragments[t][n+r],s=(r,s)=>{t=r,n=s,e.fragments.forEach((e,t)=>{e.forEach((e,n)=>{if(null==e)return;const a=t<r||t===r&&n<=s;e.setAttribute("data-bespoke-marp-fragment",a?"active":"inactive"),t===r&&n===s?e.setAttribute("data-bespoke-marp-current-fragment","current"):e.removeAttribute("data-bespoke-marp-current-fragment")})}),e.fragmentIndex=s;const a={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:s};e.fire("fragment",a)};e.on("next",()=>{if(r(1))return s(t,n+1),!1;const a=t+1;e.fragments[a]&&s(a,0)}),e.on("prev",()=>{if(r(-1))return s(t,n-1),!1;const a=t-1;e.fragments[a]&&s(a,e.fragments[a].length-1)}),e.on("slide",({index:t,fragment:n})=>{let r=0;if(void 0!==n){const s=e.fragments[t];if(s){const{length:e}=s;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}s(t,r)}),s(0,0)}var i,l=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){
/*!
  * screenfull
  * v5.0.2 - 2020-02-13
  * (c) Sindre Sorhus; MIT License
  */
!function(){var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,s=n.length,a={};r<s;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)a[n[0][r]]=e[r];return a}return!1}(),s={change:r.fullscreenchange,error:r.fullscreenerror},a={request:function(e){return new Promise(function(n,s){var a=function(){this.off("change",a),n()}.bind(this);this.on("change",a);var o=(e=e||t.documentElement)[r.requestFullscreen]();o instanceof Promise&&o.then(a).catch(s)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var s=function(){this.off("change",s),e()}.bind(this);this.on("change",s);var a=t[r.exitFullscreen]();a instanceof Promise&&a.then(s).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=s[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=s[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=a:window.screenfull=a):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}));l.isEnabled;function c(e){e.fullscreen=()=>{l.isEnabled&&l.toggle(document.body)},document.addEventListener("keydown",t=>{70!==t.which&&122!==t.which||t.altKey||t.ctrlKey||t.metaKey||!l.isEnabled||(e.fullscreen(),t.preventDefault())})}function d(e={}){const t=Object.assign({interval:200},e);return e=>{document.addEventListener("keydown",t=>{(32===t.which&&t.shiftKey||33===t.which||37===t.which||38===t.which)&&e.prev(),(32===t.which&&!t.shiftKey||34===t.which||39===t.which||40===t.which)&&e.next(),35===t.which&&e.slide(e.slides.length-1,{fragment:-1}),36===t.which&&e.slide(0)});let n,r,s=0;e.parent.addEventListener("wheel",a=>{let o=!1;const l=(e,t)=>{e&&(o=o||function(e,t){return function(e,t){const n=t===i.X?"Width":"Height";return e["client"+n]<e["scroll"+n]}(e,t)&&function(e,t){const{overflow:n}=e,r=e["overflow"+t];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r}(getComputedStyle(e),t)}(e,t)),(null==e?void 0:e.parentElement)&&l(e.parentElement,t)};if(0!==a.deltaX&&l(a.target,i.X),0!==a.deltaY&&l(a.target,i.Y),o)return;a.preventDefault(),r&&clearTimeout(r),r=setTimeout(()=>{n=0},t.interval);const c=Date.now()-s<t.interval,d=Math.sqrt(Math.pow(a.deltaX,2)+Math.pow(a.deltaY,2)),u=d<=n;if(n=d,c||u)return;let f;(a.deltaX>0||a.deltaY>0)&&(f="next"),(a.deltaX<0||a.deltaY<0)&&(f="prev"),f&&(e[f](),s=Date.now())})}}!function(e){e.X="X",e.Y="Y"}(i||(i={}));const u=(...e)=>history.replaceState(...e);var f;!function(e){e.Normal="",e.Presenter="presenter",e.Next="next"}(f||(f={}));const p=(e,{protocol:t,host:n,pathname:r,hash:s}=location)=>{const a=e.toString();return`${t}//${n}${r}${a?"?":""}${a}${s}`},m=()=>{switch(document.body.getAttribute("data-bespoke-view")){case f.Normal:return f.Normal;case f.Presenter:return f.Presenter;case f.Next:return f.Next;default:throw new Error("View mode is not assigned.")}},h=e=>new URLSearchParams(location.search).get(e),g=(e,t={})=>{const n=Object.assign({location:location,setter:u},t),r=new URLSearchParams(n.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?r.set(t,n):r.delete(t)}try{n.setter(null,document.title,p(r,n.location))}catch(e){console.error(e)}},b={available:(()=>{try{return localStorage.setItem("bespoke-marp","bespoke-marp"),localStorage.removeItem("bespoke-marp"),!0}catch(e){return console.warn("Warning: Using localStorage is restricted in the current host so some features may not work."),!1}})(),get:e=>{try{return localStorage.getItem(e)}catch(e){return null}},set:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},remove:e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}}};function v(e=".bespoke-marp-osc"){const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[data-bespoke-marp-osc=${JSON.stringify(e)}]`).forEach(n)};return l.isEnabled||n("fullscreen",e=>e.style.display="none"),b.available||n("presenter",e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."}),e=>{t.addEventListener("click",t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;switch(n&&t.target.blur(),n){case"next":e.next();break;case"prev":e.prev();break;case"fullscreen":"function"==typeof e.fullscreen&&l.isEnabled&&e.fullscreen();break;case"presenter":e.openPresenterView()}}}),e.parent.appendChild(t),e.on("activate",({index:t})=>{n("page",n=>n.textContent=`Page ${t+1} of ${e.slides.length}`)}),e.on("fragment",({index:t,fragments:r,fragmentIndex:s})=>{n("prev",e=>e.disabled=0===t&&0===s),n("next",n=>n.disabled=t===e.slides.length-1&&s===r.length-1)}),l.isEnabled&&l.onchange(()=>n("fullscreen",e=>e.classList.toggle("exit",l.isEnabled&&l.isFullscreen)))}}function w(){const e=Math.max(Math.floor(.85*window.innerWidth),640),t=Math.max(Math.floor(.85*window.innerHeight),360);return window.open(this.presenterUrl,"bespoke-marp-presenter-"+this.syncKey,`width=${e},height=${t},menubar=no,toolbar=no`)}function y(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),p(e)}var x=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let E=e=>String(e).replace(/[&<>"']/g,e=>`&${k[e]};`),k={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},S="dangerouslySetInnerHTML",L={className:"class",htmlFor:"for"},I={};function P(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==S&&(r+=` ${L[e]?L[e]:E(e)}="${E(t[e])}"`);r+=">"}if(-1===x.indexOf(e)){if(t[S])r+=t[S].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===I[e]?e:E(e)}r+=e?`</${e}>`:""}return I[r]=!0,r}const M=({children:e})=>P(null,null,...e),N="bespoke-marp-presenter-container",F="bespoke-marp-presenter-next",O="bespoke-marp-presenter-next-container",T="bespoke-marp-presenter-note-container",q="bespoke-marp-presenter-info-container",C="bespoke-marp-presenter-info-page",$="bespoke-marp-presenter-info-page-text",j="bespoke-marp-presenter-info-page-prev",A="bespoke-marp-presenter-info-page-next",K="bespoke-marp-presenter-info-time",R="bespoke-marp-presenter-info-timer";function U(e){const{title:t}=document;document.title="[Presenter view]"+(t?" - "+t:"");const n={},r=e=>(n[e]=n[e]||document.querySelector("."+e),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=N,t.appendChild(e),t.insertAdjacentHTML("beforeend",P(M,null,P("div",{class:O},P("iframe",{class:F,src:"?view=next"})),P("div",{class:T}),P("div",{class:q},P("div",{class:C},P("button",{class:j,tabindex:"-1",title:"Previous"},"Previous"),P("span",{class:$}),P("button",{class:A,tabindex:"-1",title:"Next"},"Next")),P("time",{class:K,title:"Current time"}),P("div",{class:R})))),t})(e.parent)),(e=>{r(O).addEventListener("click",()=>e.next());const t=r(F),n=(s=t,(e,t)=>s.contentWindow.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin));var s;t.addEventListener("load",()=>{r(O).classList.add("active"),n(e.slide(),e.fragmentIndex),e.on("fragment",({index:e,fragmentIndex:t})=>n(e,t))});const a=document.querySelectorAll(".bespoke-marp-note");a.forEach(e=>{e.addEventListener("keydown",e=>e.stopPropagation()),r(T).appendChild(e)}),e.on("activate",()=>a.forEach(t=>t.classList.toggle("active",t.dataset.index==e.slide()))),e.on("activate",({index:t})=>{r($).textContent=`${t+1} / ${e.slides.length}`});const o=r(j),i=r(A);o.addEventListener("click",()=>{o.blur(),e.prev()}),i.addEventListener("click",()=>{i.blur(),e.next()}),e.on("fragment",({index:t,fragments:n,fragmentIndex:r})=>{o.disabled=0===t&&0===r,i.disabled=t===e.slides.length-1&&r===n.length-1});const l=()=>r(K).textContent=(new Date).toLocaleTimeString();l(),setInterval(l,250)})(e)}function V(e){const t=m();return t===f.Next&&e.appendChild(document.createElement("span")),e=>{t===f.Normal&&function(e){if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:w},presenterUrl:{enumerable:!0,get:y}}),b.available&&document.addEventListener("keydown",t=>{80!==t.which||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())})}(e),t===f.Presenter&&U(e),t===f.Next&&function(e){const t=t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");e.slide(Number.parseInt(t,10),{fragment:Number.parseInt(n,10)}),e.next()}};window.addEventListener("message",t),e.on("destroy",()=>window.removeEventListener("message",t))}(e)}}function X(e){e.on("activate",t=>{document.querySelectorAll(".bespoke-progress-bar").forEach(n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"})})}const D=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t};function Y(e={}){const t=Object.assign({history:!0},e);return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},s=(t={fragment:!0})=>{((t,n)=>{const{fragments:r,slides:s}=e,a=Math.max(0,Math.min(t,s.length-1)),o=Math.max(0,Math.min(n||0,r[a].length-1));a===e.slide()&&o===e.fragmentIndex||e.slide(a,{fragment:o})})((D(location.hash.slice(1))||1)-1,t.fragment?D(h("f")||""):null)};e.on("fragment",({index:e,fragmentIndex:r})=>{n||g({f:0===r||r.toString()},{location:Object.assign(Object.assign({},location),{hash:"#"+(e+1)}),setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})}),setTimeout(()=>{s(),window.addEventListener("hashchange",()=>r(()=>{s({fragment:!1}),g({f:void 0})})),window.addEventListener("popstate",()=>{n||r(()=>s())}),n=!1},0)}}function B(e={}){const t=e.key||((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t})(),n="bespoke-marp-sync-"+t,r=()=>{const e=b.get(n);return e?JSON.parse(e):Object.create(null)},s=e=>{const t=r(),s=Object.assign(Object.assign({},t),e(t));return b.set(n,JSON.stringify(s)),s};return s(e=>({reference:(e.reference||0)+1})),e=>{Object.defineProperty(e,"syncKey",{value:t,enumerable:!0});let a=!0;setTimeout(()=>{e.on("fragment",e=>{a&&s(()=>({index:e.index,fragmentIndex:e.fragmentIndex}))})},0),window.addEventListener("storage",t=>{if(t.key===n&&t.oldValue&&t.newValue){const n=JSON.parse(t.oldValue),r=JSON.parse(t.newValue);if(n.index!==r.index||n.fragmentIndex!==r.fragmentIndex)try{a=!1,e.slide(r.index,{fragment:r.fragmentIndex})}finally{a=!0}}}),e.on("destroy",()=>{const{reference:e}=r();void 0===e||e<=1?b.remove(n):s(()=>({reference:e-1}))})}}function z(e={}){const t=Object.assign({slope:Math.tan(-35*Math.PI/180),swipeThreshold:30},e);return e=>{let n;const r=e.parent,s=e=>{const t=r.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};r.addEventListener("touchstart",e=>{n=1===e.touches.length?s(e.touches[0]):void 0},{passive:!0}),r.addEventListener("touchmove",e=>{if(n)if(1===e.touches.length){e.preventDefault();const t=s(e.touches[0]),r=t.x-n.x,a=t.y-n.y;n.delta=Math.sqrt(Math.pow(Math.abs(r),2)+Math.pow(Math.abs(a),2)),n.radian=Math.atan2(r,a)}else n=void 0}),r.addEventListener("touchend",r=>{if(n){if(n.delta&&n.delta>=t.swipeThreshold){let s=n.radian-t.slope;s=(s+Math.PI)%(2*Math.PI)-Math.PI,e[s<0?"next":"prev"](),r.stopPropagation()}n=void 0}},{passive:!0})}}const H=[f.Normal,f.Presenter,f.Next];!function(r=document.getElementById("p")){document.body.setAttribute("data-bespoke-view",(()=>{switch(h("view")){case"next":return f.Next;case"presenter":return f.Presenter;default:return f.Normal}})());const i=(e=>{const t=h(e);return g({[e]:void 0}),t})("sync")||void 0,l=!1,u=!0,p=e(r,((...e)=>{const t=H.findIndex(e=>m()===e);if(t<0)throw new Error("Invalid view");return e.map(([e,n])=>e[t]&&n).filter(e=>e)})([[u,u,l],B({key:i})],[[u,u,u],V(r)],[[u,u,l],s],[[u,u,u],t],[[u,l,l],n()],[[u,u,u],a],[[u,u,u],Y({history:!1})],[[u,u,l],d()],[[u,u,l],c],[[u,l,l],X],[[u,u,l],z()],[[u,l,l],v()],[[u,u,u],o]));window.addEventListener("beforeunload",()=>g({sync:p.syncKey})),window.addEventListener("unload",()=>p.destroy())}()}();
</script></body></html>